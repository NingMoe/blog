{"version":3,"sources":["../../routers/main.js"],"names":["express","require","ctr_token","router","Router","get","req","res","next","render","platform","cookies","uid","session","page_type","title","redirect_uri","protocol","originalUrl","redirect","quid","query","coll_id","id","module","exports"],"mappings":"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","file":"main.js","sourcesContent":["const express = require('express');\nconst ctr_token = require('../libs/ctr_token');\nconst router = express.Router();\nrouter.get('/', (req, res, next) => {\n    res.render('../views/index',{\n        platform:req.platform ? req.platform : (req.cookies.get('platform') ?req.cookies.get('platform'):''),\n        uid:req.session.uid || req.cookies.uid,\n        page_type: 'index',\n        title:'博客'\n    });\n});\n\nrouter.get('/editor',(req,res,next)=>{\n    let redirect_uri = req.protocol + '://' + req.get('host') + req.originalUrl;\n    if(req.session.uid && req.cookies.uid){\n        res.render('../views/article_editor',{\n            platform:req.platform ? req.platform : (req.cookies.get('platform') ?req.cookies.get('platform'):''),\n            uid:req.session.uid || req.cookies.uid,\n            page_type: 'editor',\n        });\n    }else{\n        res.redirect(302,'/login?redirect_uri='+redirect_uri);\n    }\n});\n\nrouter.get('/upfile',(req,res,next)=>{\n    let redirect_uri = req.protocol + '://' + req.get('host') + req.originalUrl;\n    if(req.session.uid && req.cookies.uid){\n        res.render('../views/upfile',{\n            platform:req.platform ? req.platform : (req.cookies.get('platform') ?req.cookies.get('platform'):''),\n            uid:req.session.uid || req.cookies.uid,\n            page_type: 'upfile',\n        });\n    }else{\n        res.redirect(302,'/login?redirect_uri='+redirect_uri);\n    }\n})\n\nrouter.get('/account',(req,res,next)=>{\n    res.render('../views/account/account',{\n        platform:req.platform ? req.platform : (req.cookies.get('platform') ?req.cookies.get('platform'):''),\n        uid:req.session.uid || req.cookies.uid,\n        quid:req.query.uid ? req.query.uid : (req.session.uid || req.cookies.uid),\n        page_type: 'account',\n        title:'我的主页'\n    });\n})\n\nrouter.get('/account/collections/lists',(req,res,next)=>{\n    res.render('../views/account/collections/lists',{\n        platform:req.platform ? req.platform : (req.cookies.get('platform') ?req.cookies.get('platform'):''),\n        page_type: 'collections_list',\n        uid:req.session.uid && req.cookies.uid,\n        title:'专题列表'\n    });\n});\n\nrouter.get('/account/collections/new',(req,res,next)=>{\n    let redirect_uri = req.protocol + '://' + req.get('host') + req.originalUrl;\n    if(req.session.uid && req.cookies.uid){\n        res.render('../views/account/collections/new',{\n            page_type: 'collections_new',\n            platform:req.platform ? req.platform : (req.cookies.get('platform') ?req.cookies.get('platform'):''),\n            uid:req.session.uid || req.cookies.uid,\n            title:'新增专题'\n        });\n    }else{\n        res.redirect(302,'/login?redirect_uri='+redirect_uri);\n    }\n});\n\nrouter.get('/account/collections/edit',(req,res,next)=>{\n    let redirect_uri = req.protocol + '://' + req.get('host') + req.originalUrl;\n    let coll_id = req.query.id ? req.query.id: '';\n    if(req.session.uid && req.cookies.uid){\n        res.render('../views/account/collections/new',{\n            page_type: 'collections_edit',\n            platform:req.platform ? req.platform : (req.cookies.get('platform') ?req.cookies.get('platform'):''),\n            uid:req.session.uid || req.cookies.uid,\n            title:'修改专题',\n            coll_id:coll_id\n        });\n    }else{\n        res.redirect(302,'/login?redirect_uri='+redirect_uri);\n    }\n});\n\nrouter.get('/account/collections/detailes',(req,res,next)=>{\n    res.render('../views/account/collections/detailes',{\n        platform:req.platform ? req.platform : (req.cookies.get('platform') ?req.cookies.get('platform'):''),\n        page_type: 'collections_detailes',\n        uid:req.session.uid || req.cookies.uid,\n        coll_id:req.query.id,\n        title:'专题详情'\n    });\n});\n\nrouter.get('/account/dcs',(req,res,next)=>{\n    res.render('../views/account/document/detailes',{\n        page_type: 'document_detailes',\n        platform:req.platform ? req.platform : (req.cookies.get('platform') ?req.cookies.get('platform'):''),\n        uid:req.session.uid || req.cookies.uid,\n        coll_id:req.query.id,\n        title:'文集详情'\n    });\n});\n\nrouter.get('/register',(req,res,next)=>{\n    res.render('../views/register',{\n        page_type:'register',\n        title:'注册帐号'\n    });\n});\n\nrouter.get('/login', (req, res, next) => {\n    res.render('../views/login',{\n        page_type:'login',\n        title:'用户登录'\n    });\n});\n\nmodule.exports = router;"]}