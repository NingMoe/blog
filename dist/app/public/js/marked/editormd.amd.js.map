{"version":3,"sources":["../../../../../app/public/js/marked/editormd.amd.js"],"names":["factory","require","exports","module","define","amd","cmModePath","cmAddonPath","codeMirrorModules","window","editormd","$","arguments","marked","prettify","katex","Raphael","_","flowchart","CodeMirror","jQuery","Zepto","id","options","fn","init","title","$name","version","homePage","classPrefix","toolbarModes","full","simple","mini","defaults","mode","name","value","theme","editorTheme","previewTheme","markdown","appendMarkdown","width","height","path","pluginPath","delay","autoLoadModules","watch","placeholder","gotoLine","codeFold","autoHeight","autoFocus","autoCloseTags","searchReplace","syncScrolling","readOnly","tabSize","indentUnit","lineNumbers","lineWrapping","autoCloseBrackets","showTrailingSpace","matchBrackets","indentWithTabs","styleSelectedText","matchWordHighlight","styleActiveLine","dialogLockScreen","dialogShowMask","dialogDraggable","dialogMaskBgColor","dialogMaskOpacity","fontSize","saveHTMLToTextarea","disabledKeyMaps","onload","onresize","onchange","onwatch","onunwatch","onpreviewing","onpreviewed","onfullscreen","onfullscreenExit","onscroll","onpreviewscroll","imageUpload","imageFormats","imageUploadURL","crossDomainUpload","uploadCallbackURL","toc","tocm","tocTitle","tocDropdown","tocContainer","tocStartLevel","htmlDecode","pageBreak","atLink","emailLink","taskList","emoji","tex","flowChart","sequenceDiagram","previewCodeHighlight","toolbar","toolbarAutoFixed","toolbarIcons","toolbarTitles","toolbarHandlers","ucwords","lowercase","toolbarCustomIcons","toolbarIconsClass","undo","redo","bold","del","italic","quote","uppercase","h1","h2","h3","h4","h5","h6","hr","link","image","code","table","datetime","pagebreak","unwatch","preview","search","fullscreen","clear","help","info","toolbarIconTexts","lang","description","buttons","enter","cancel","close","dialog","url","urlTitle","urlEmpty","referenceLink","urlId","nameEmpty","idEmpty","alt","uploadButton","imageURLEmpty","uploadFileEmpty","formatNotAllowed","preformattedText","emptyAlert","codeBlock","selectLabel","selectDefaultText","otherLanguage","unselectedLanguageAlert","codeEmptyAlert","htmlEntities","classNames","dialogZindex","$katex","$marked","$CodeMirror","$prettyPrint","timer","flowchartTimer","prototype","state","watching","loaded","_this","settings","extend","editor","textarea","html","hasClass","addClass","css","markdownTextarea","children","length","append","attr","appendElements","join","mask","containerMask","val","htmlTextarea","previewContainer","loadCSS","setCodeMirror","setToolbar","loadedDisplay","loadQueues","loadPath","loadFlowChartOrSequenceDiagram","isIE8","loadScript","setTheme","oldTheme","themePrefix","removeClass","setEditorTheme","cm","setOption","setCodeMirrorTheme","setPreviewTheme","codeMirrorConfig","dragDrop","autofocus","extraKeys","foldCode","getCursor","foldGutter","gutters","highlightSelectionMatches","showToken","codeEditor","fromTextArea","codeMirror","cmElement","setValue","Infinity","find","getCodeMirrorOption","key","getOption","setCodeMirrorOption","addKeyMap","map","bottom","removeKeyMap","line","count","lineCount","alert","parseInt","setCursor","ch","scrollInfo","getScrollInfo","clientHeight","coords","charCoords","scrollTo","top","cmScroll","scrollTop","percent","scrollHeight","focus","proxy","set","config","recreate","on","eventType","callback","off","showToolbar","show","resize","hideToolbar","hide","setToolbarAutoFixed","fixed","autoFixedHandle","$window","offset","position","left","bind","toolbarHTML","icons","toolbarMenu","menu","pullRight","i","len","isHeader","test","index","iconTexts","iconClass","menuItem","toUpperCase","setToolbarHandler","getToolbarHandles","toolbarIconHandlers","mouseOrTouch","event","icon","cursor","selection","getSelection","activeIcon","createDialog","createInfoDialog","infoDialogHTML","infoDialog","hideInfoDialog","infoDialogPosition","_infoDialogPosition","showInfoDialog","lockScreen","opacity","backgroundColor","lock","remove","prettyPrint","katexRender","each","render","text","flowChartAndSequenceDiagramRender","$this","codeView","tocHeight","tocMenuHeight","registerKeyMaps","keyMap","inArray","k","keyMaps","_keyMap","handle","_map","keydown","keymaps","keyCode","bindScrollEvent","cmBindScroll","cmUnbindScroll","unbind","previewBindScroll","previewUnbindScroll","mouseover","mouseout","touchstart","touchend","bindChangeEvent","_cm","changeObj","setTimeout","clearTimeout","save","data","previewHeight","cmValue","getValue","markdownToC","rendererOptions","markedRendererOptions","markedOptions","renderer","markedRenderer","gfm","tables","breaks","pedantic","sanitize","smartLists","smartypants","setOptions","newMarkdownDoc","filterHTMLTags","tocMenu","markdownToCRenderer","tocDropdownMenu","kaTeXLoaded","loadKaTeX","setSelection","from","to","setSelections","ranges","getSelections","replaceSelection","insertValue","md","setMarkdown","getMarkdown","getHTML","getTextareaSavedHTML","getPreviewedHTML","watchIcon","unWatchIcon","parent","previewing","toggle","toggleClass","escHandle","shiftKey","previewed","previewCloseBtn","background","fullscreenClass","fullscreenExit","executePlugin","loadFiles","plugin","loadPlugin","loadPlugins","command","execCommand","searchReplaceAll","ucfirst","selections","listSelections","firstUpperCase","wordsFirstUpperCase","toLowerCase","selectionText","split","date","Date","langName","datefmt","dateFormat","trim","str","String","replace","$1","urls","atLinkBase","regexs","email","emojiDatetime","twemoji","fontAwesome","editormdLogo","ext","Renderer","atLinkReg","emojiReg","emailReg","emailLinkReg","twemojiReg","faIconReg","editormdLogoReg","pageBreakReg","matchs","match","RegExp","$2","faMatchs","fa","len1","faName","emdlogoMathcs","twemojiMatchs","x","len2","logoName","t","len3","twe","src","$3","$4","$5","href","prot","decodeURIComponent","unescape","e","indexOf","out","heading","level","raw","linkText","hasLinkReg","getLinkTextReg","tempText","push","escapedText","slug","isChinese","escape","headingHTML","headerPrefix","paragraph","isTeXInline","isTeXLine","isTeXAddClass","isToC","isToCMenu","tocHTML","escaped","apply","tablecell","content","flags","type","header","tag","align","listitem","container","startLevel","lastLevel","Array","wrap","zindex","tocMenus","btn","list","first","before","li","ul","firstA","float","paddingTop","mouseleave","filters","expression","filterTags","attrs","htmlTagRegex","el","_attrs","attributes","$attrs","nodeName","nodeValue","outerHTML","filterAttrs","markdownToHTML","markdownSourceCode","autoLoadKaTeX","div","saveTo","markdownDoc","markdownParsed","katexHandle","themes","previewThemes","editorThemes","js","fileName","into","document","createElement","rel","onreadystatechange","getElementsByTagName","appendChild","body","isIE","navigator","appName","appVersion","script","readyState","katexURL","drag","closed","maskStyle","footer","guid","getTime","dialogName","showMask","hideMask","loading","zIndex","border","dialogPosition","btnClassName","posX","posY","dialogHeader","mousedown","clientX","style","clientY","onmousemove","moveAction","userCanSelect","obj","userUnselect","nowLeft","nowTop","onselectstart","onmouseup","touchDraggable","start","orig","originalEvent","pos","changedTouches","pageX","y","pageY","move","preventDefault","mouseEventType","touchEventType","createEvent","format","addZero","d","year","getFullYear","year2","toString","slice","month","getMonth","day","getDate","weekDay","getDay","hour","getHours","min","getMinutes","second","getSeconds","ms","getMilliseconds","ymd","fymd","hms","toUTCString","cnWeekDays","weekDays"],"mappings":"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","file":"editormd.amd.js","sourcesContent":["/*\r\n * Editor.md\r\n *\r\n * @file        editormd.amd.js \r\n * @version     v1.5.0 \r\n * @description Open source online markdown editor.\r\n * @license     MIT License\r\n * @author      Pandao\r\n * {@link       https://github.com/pandao/editor.md}\r\n * @updateTime  2015-06-09\r\n */\r\n\r\n;(function(factory) {\r\n    \"use strict\";\r\n    \r\n\t// CommonJS/Node.js\r\n\tif (typeof require === \"function\" && typeof exports === \"object\" && typeof module === \"object\")\r\n    { \r\n        module.exports = factory;\r\n    }\r\n\telse if (typeof define === \"function\")  // AMD/CMD/Sea.js\r\n\t{\r\n        if (define.amd) // for Require.js\r\n        {\r\n            var cmModePath  = \"./lib/codemirror/mode/\";\r\n            var cmAddonPath = \"./lib/codemirror/addon/\";\r\n\r\n            var codeMirrorModules = [\r\n                \"jquery\", \"marked\", \"prettify\",\r\n                \"katex\", \"raphael\", \"underscore\", \"flowchart\",  \"jqueryflowchart\",  \"sequenceDiagram\",\r\n\r\n                \"./lib/codemirror/lib/codemirror\",\r\n                cmModePath + \"css/css\",\r\n                cmModePath + \"sass/sass\",\r\n                cmModePath + \"shell/shell\",\r\n                cmModePath + \"sql/sql\",\r\n                cmModePath + \"clike/clike\",\r\n                cmModePath + \"php/php\",\r\n                cmModePath + \"xml/xml\",\r\n                cmModePath + \"markdown/markdown\",\r\n                cmModePath + \"javascript/javascript\",\r\n                cmModePath + \"htmlmixed/htmlmixed\",\r\n                cmModePath + \"gfm/gfm\",\r\n                cmModePath + \"http/http\",\r\n                cmModePath + \"go/go\",\r\n                cmModePath + \"dart/dart\",\r\n                cmModePath + \"coffeescript/coffeescript\",\r\n                cmModePath + \"nginx/nginx\",\r\n                cmModePath + \"python/python\",\r\n                cmModePath + \"perl/perl\",\r\n                cmModePath + \"lua/lua\",\r\n                cmModePath + \"r/r\", \r\n                cmModePath + \"ruby/ruby\", \r\n                cmModePath + \"rst/rst\",\r\n                cmModePath + \"smartymixed/smartymixed\",\r\n                cmModePath + \"vb/vb\",\r\n                cmModePath + \"vbscript/vbscript\",\r\n                cmModePath + \"velocity/velocity\",\r\n                cmModePath + \"xquery/xquery\",\r\n                cmModePath + \"yaml/yaml\",\r\n                cmModePath + \"erlang/erlang\",\r\n                cmModePath + \"jade/jade\",\r\n\r\n                cmAddonPath + \"edit/trailingspace\", \r\n                cmAddonPath + \"dialog/dialog\", \r\n                cmAddonPath + \"search/searchcursor\", \r\n                cmAddonPath + \"search/search\", \r\n                cmAddonPath + \"scroll/annotatescrollbar\", \r\n                cmAddonPath + \"search/matchesonscrollbar\", \r\n                cmAddonPath + \"display/placeholder\", \r\n                cmAddonPath + \"edit/closetag\", \r\n                cmAddonPath + \"fold/foldcode\",\r\n                cmAddonPath + \"fold/foldgutter\",\r\n                cmAddonPath + \"fold/indent-fold\",\r\n                cmAddonPath + \"fold/brace-fold\",\r\n                cmAddonPath + \"fold/xml-fold\", \r\n                cmAddonPath + \"fold/markdown-fold\",\r\n                cmAddonPath + \"fold/comment-fold\", \r\n                cmAddonPath + \"mode/overlay\", \r\n                cmAddonPath + \"selection/active-line\", \r\n                cmAddonPath + \"edit/closebrackets\", \r\n                cmAddonPath + \"display/fullscreen\",\r\n                cmAddonPath + \"search/match-highlighter\"\r\n            ];\r\n\r\n            define(codeMirrorModules, factory);\r\n        } \r\n        else \r\n        {\r\n\t\t    define([\"jquery\"], factory);  // for Sea.js\r\n        }\r\n\t} \r\n\telse\r\n\t{ \r\n        window.editormd = factory();\r\n\t}\r\n    \r\n}(function() {    \r\n\r\n    if (typeof define == \"function\" && define.amd) {\r\n       $          = arguments[0];\r\n       marked     = arguments[1];\r\n       prettify   = arguments[2];\r\n       katex      = arguments[3];\r\n       Raphael    = arguments[4];\r\n       _          = arguments[5];\r\n       flowchart  = arguments[6];\r\n       CodeMirror = arguments[9];\r\n   }\r\n    \r\n    \"use strict\";\r\n    \r\n    var $ = (typeof (jQuery) !== \"undefined\") ? jQuery : Zepto;\r\n\r\n\tif (typeof ($) === \"undefined\") {\r\n\t\treturn ;\r\n\t}\r\n    \r\n    /**\r\n     * editormd\r\n     * \r\n     * @param   {String} id           编辑器的ID\r\n     * @param   {Object} options      配置选项 Key/Value\r\n     * @returns {Object} editormd     返回editormd对象\r\n     */\r\n    \r\n    var editormd         = function (id, options) {\r\n        return new editormd.fn.init(id, options);\r\n    };\r\n    \r\n    editormd.title        = editormd.$name = \"Editor.md\";\r\n    editormd.version      = \"1.5.0\";\r\n    editormd.homePage     = \"https://pandao.github.io/editor.md/\";\r\n    editormd.classPrefix  = \"editormd-\";\r\n    \r\n    editormd.toolbarModes = {\r\n        full : [\r\n            \"undo\", \"redo\", \"|\", \r\n            \"bold\", \"del\", \"italic\", \"quote\", \"ucwords\", \"uppercase\", \"lowercase\", \"|\", \r\n            \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\", \"|\", \r\n            \"list-ul\", \"list-ol\", \"hr\", \"|\",\r\n            \"link\", \"reference-link\", \"image\", \"code\", \"preformatted-text\", \"code-block\", \"table\", \"datetime\", \"emoji\", \"html-entities\", \"pagebreak\", \"|\",\r\n            \"goto-line\", \"watch\", \"preview\", \"fullscreen\", \"clear\", \"search\", \"|\",\r\n            \"help\", \"info\"\r\n        ],\r\n        simple : [\r\n            \"undo\", \"redo\", \"|\", \r\n            \"bold\", \"del\", \"italic\", \"quote\", \"uppercase\", \"lowercase\", \"|\", \r\n            \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\", \"|\", \r\n            \"list-ul\", \"list-ol\", \"hr\", \"|\",\r\n            \"watch\", \"preview\", \"fullscreen\", \"|\",\r\n            \"help\", \"info\"\r\n        ],\r\n        mini : [\r\n            \"undo\", \"redo\", \"|\",\r\n            \"watch\", \"preview\", \"|\",\r\n            \"help\", \"info\"\r\n        ]\r\n    };\r\n    \r\n    editormd.defaults     = {\r\n        mode                 : \"gfm\",          //gfm or markdown\r\n        name                 : \"\",             // Form element name\r\n        value                : \"\",             // value for CodeMirror, if mode not gfm/markdown\r\n        theme                : \"\",             // Editor.md self themes, before v1.5.0 is CodeMirror theme, default empty\r\n        editorTheme          : \"default\",      // Editor area, this is CodeMirror theme at v1.5.0\r\n        previewTheme         : \"\",             // Preview area theme, default empty\r\n        markdown             : \"\",             // Markdown source code\r\n        appendMarkdown       : \"\",             // if in init textarea value not empty, append markdown to textarea\r\n        width                : \"100%\",\r\n        height               : \"100%\",\r\n        path                 : \"./lib/\",       // Dependents module file directory\r\n        pluginPath           : \"\",             // If this empty, default use settings.path + \"../plugins/\"\r\n        delay                : 300,            // Delay parse markdown to html, Uint : ms\r\n        autoLoadModules      : true,           // Automatic load dependent module files\r\n        watch                : true,\r\n        placeholder          : \"Enjoy Markdown! coding now...\",\r\n        gotoLine             : true,\r\n        codeFold             : false,\r\n        autoHeight           : false,\r\n\t\tautoFocus            : true,\r\n        autoCloseTags        : true,\r\n        searchReplace        : true,\r\n        syncScrolling        : true,           // true | false | \"single\", default true\r\n        readOnly             : false,\r\n        tabSize              : 4,\r\n\t\tindentUnit           : 4,\r\n        lineNumbers          : true,\r\n\t\tlineWrapping         : true,\r\n\t\tautoCloseBrackets    : true,\r\n\t\tshowTrailingSpace    : true,\r\n\t\tmatchBrackets        : true,\r\n\t\tindentWithTabs       : true,\r\n\t\tstyleSelectedText    : true,\r\n        matchWordHighlight   : true,           // options: true, false, \"onselected\"\r\n        styleActiveLine      : true,           // Highlight the current line\r\n        dialogLockScreen     : true,\r\n        dialogShowMask       : true,\r\n        dialogDraggable      : true,\r\n        dialogMaskBgColor    : \"#fff\",\r\n        dialogMaskOpacity    : 0.1,\r\n        fontSize             : \"13px\",\r\n        saveHTMLToTextarea   : false,\r\n        disabledKeyMaps      : [],\r\n        \r\n        onload               : function() {},\r\n        onresize             : function() {},\r\n        onchange             : function() {},\r\n        onwatch              : null,\r\n        onunwatch            : null,\r\n        onpreviewing         : function() {},\r\n        onpreviewed          : function() {},\r\n        onfullscreen         : function() {},\r\n        onfullscreenExit     : function() {},\r\n        onscroll             : function() {},\r\n        onpreviewscroll      : function() {},\r\n        \r\n        imageUpload          : false,\r\n        imageFormats         : [\"jpg\", \"jpeg\", \"gif\", \"png\", \"bmp\", \"webp\"],\r\n        imageUploadURL       : \"\",\r\n        crossDomainUpload    : false,\r\n        uploadCallbackURL    : \"\",\r\n        \r\n        toc                  : true,           // Table of contents\r\n        tocm                 : false,           // Using [TOCM], auto create ToC dropdown menu\r\n        tocTitle             : \"\",             // for ToC dropdown menu btn\r\n        tocDropdown          : false,\r\n        tocContainer         : \"\",\r\n        tocStartLevel        : 1,              // Said from H1 to create ToC\r\n        htmlDecode           : false,          // Open the HTML tag identification \r\n        pageBreak            : true,           // Enable parse page break [========]\r\n        atLink               : true,           // for @link\r\n        emailLink            : true,           // for email address auto link\r\n        taskList             : false,          // Enable Github Flavored Markdown task lists\r\n        emoji                : false,          // :emoji: , Support Github emoji, Twitter Emoji (Twemoji);\r\n                                               // Support FontAwesome icon emoji :fa-xxx: > Using fontAwesome icon web fonts;\r\n                                               // Support Editor.md logo icon emoji :editormd-logo: :editormd-logo-1x: > 1~8x;\r\n        tex                  : false,          // TeX(LaTeX), based on KaTeX\r\n        flowChart            : false,          // flowChart.js only support IE9+\r\n        sequenceDiagram      : false,          // sequenceDiagram.js only support IE9+\r\n        previewCodeHighlight : true,\r\n                \r\n        toolbar              : true,           // show/hide toolbar\r\n        toolbarAutoFixed     : true,           // on window scroll auto fixed position\r\n        toolbarIcons         : \"full\",\r\n        toolbarTitles        : {},\r\n        toolbarHandlers      : {\r\n            ucwords : function() {\r\n                return editormd.toolbarHandlers.ucwords;\r\n            },\r\n            lowercase : function() {\r\n                return editormd.toolbarHandlers.lowercase;\r\n            }\r\n        },\r\n        toolbarCustomIcons   : {               // using html tag create toolbar icon, unused default <a> tag.\r\n            lowercase        : \"<a href=\\\"javascript:;\\\" title=\\\"Lowercase\\\" unselectable=\\\"on\\\"><i class=\\\"fa\\\" name=\\\"lowercase\\\" style=\\\"font-size:24px;margin-top: -10px;\\\">a</i></a>\",\r\n            \"ucwords\"        : \"<a href=\\\"javascript:;\\\" title=\\\"ucwords\\\" unselectable=\\\"on\\\"><i class=\\\"fa\\\" name=\\\"ucwords\\\" style=\\\"font-size:20px;margin-top: -3px;\\\">Aa</i></a>\"\r\n        }, \r\n        toolbarIconsClass    : {\r\n            undo             : \"fa-undo\",\r\n            redo             : \"fa-repeat\",\r\n            bold             : \"fa-bold\",\r\n            del              : \"fa-strikethrough\",\r\n            italic           : \"fa-italic\",\r\n            quote            : \"fa-quote-left\",\r\n            uppercase        : \"fa-font\",\r\n            h1               : editormd.classPrefix + \"bold\",\r\n            h2               : editormd.classPrefix + \"bold\",\r\n            h3               : editormd.classPrefix + \"bold\",\r\n            h4               : editormd.classPrefix + \"bold\",\r\n            h5               : editormd.classPrefix + \"bold\",\r\n            h6               : editormd.classPrefix + \"bold\",\r\n            \"list-ul\"        : \"fa-list-ul\",\r\n            \"list-ol\"        : \"fa-list-ol\",\r\n            hr               : \"fa-minus\",\r\n            link             : \"fa-link\",\r\n            \"reference-link\" : \"fa-anchor\",\r\n            image            : \"fa-picture-o\",\r\n            code             : \"fa-code\",\r\n            \"preformatted-text\" : \"fa-file-code-o\",\r\n            \"code-block\"     : \"fa-file-code-o\",\r\n            table            : \"fa-table\",\r\n            datetime         : \"fa-clock-o\",\r\n            emoji            : \"fa-smile-o\",\r\n            \"html-entities\"  : \"fa-copyright\",\r\n            pagebreak        : \"fa-newspaper-o\",\r\n            \"goto-line\"      : \"fa-terminal\", // fa-crosshairs\r\n            watch            : \"fa-eye-slash\",\r\n            unwatch          : \"fa-eye\",\r\n            preview          : \"fa-desktop\",\r\n            search           : \"fa-search\",\r\n            fullscreen       : \"fa-arrows-alt\",\r\n            clear            : \"fa-eraser\",\r\n            help             : \"fa-question-circle\",\r\n            info             : \"fa-info-circle\"\r\n        },        \r\n        toolbarIconTexts     : {},\r\n        \r\n        lang : {\r\n            name        : \"zh-cn\",\r\n            description : \"开源在线Markdown编辑器<br/>Open source online Markdown editor.\",\r\n            tocTitle    : \"目录\",\r\n            toolbar     : {\r\n                undo             : \"撤销（Ctrl+Z）\",\r\n                redo             : \"重做（Ctrl+Y）\",\r\n                bold             : \"粗体\",\r\n                del              : \"删除线\",\r\n                italic           : \"斜体\",\r\n                quote            : \"引用\",\r\n                ucwords          : \"将每个单词首字母转成大写\",\r\n                uppercase        : \"将所选转换成大写\",\r\n                lowercase        : \"将所选转换成小写\",\r\n                h1               : \"标题1\",\r\n                h2               : \"标题2\",\r\n                h3               : \"标题3\",\r\n                h4               : \"标题4\",\r\n                h5               : \"标题5\",\r\n                h6               : \"标题6\",\r\n                \"list-ul\"        : \"无序列表\",\r\n                \"list-ol\"        : \"有序列表\",\r\n                hr               : \"横线\",\r\n                link             : \"链接\",\r\n                \"reference-link\" : \"引用链接\",\r\n                image            : \"添加图片\",\r\n                code             : \"行内代码\",\r\n                \"preformatted-text\" : \"预格式文本 / 代码块（缩进风格）\",\r\n                \"code-block\"     : \"代码块（多语言风格）\",\r\n                table            : \"添加表格\",\r\n                datetime         : \"日期时间\",\r\n                emoji            : \"Emoji表情\",\r\n                \"html-entities\"  : \"HTML实体字符\",\r\n                pagebreak        : \"插入分页符\",\r\n                \"goto-line\"      : \"跳转到行\",\r\n                watch            : \"关闭实时预览\",\r\n                unwatch          : \"开启实时预览\",\r\n                preview          : \"全窗口预览HTML（按 Shift + ESC还原）\",\r\n                fullscreen       : \"全屏（按ESC还原）\",\r\n                clear            : \"清空\",\r\n                search           : \"搜索\",\r\n                help             : \"使用帮助\",\r\n                info             : \"关于\" + editormd.title\r\n            },\r\n            buttons : {\r\n                enter  : \"确定\",\r\n                cancel : \"取消\",\r\n                close  : \"关闭\"\r\n            },\r\n            dialog : {\r\n                link : {\r\n                    title    : \"添加链接\",\r\n                    url      : \"链接地址\",\r\n                    urlTitle : \"链接标题\",\r\n                    urlEmpty : \"错误：请填写链接地址。\"\r\n                },\r\n                referenceLink : {\r\n                    title    : \"添加引用链接\",\r\n                    name     : \"引用名称\",\r\n                    url      : \"链接地址\",\r\n                    urlId    : \"链接ID\",\r\n                    urlTitle : \"链接标题\",\r\n                    nameEmpty: \"错误：引用链接的名称不能为空。\",\r\n                    idEmpty  : \"错误：请填写引用链接的ID。\",\r\n                    urlEmpty : \"错误：请填写引用链接的URL地址。\"\r\n                },\r\n                image : {\r\n                    title    : \"添加图片\",\r\n                    url      : \"图片地址\",\r\n                    link     : \"图片链接\",\r\n                    alt      : \"图片描述\",\r\n                    uploadButton     : \"本地上传\",\r\n                    imageURLEmpty    : \"错误：图片地址不能为空。\",\r\n                    uploadFileEmpty  : \"错误：上传的图片不能为空。\",\r\n                    formatNotAllowed : \"错误：只允许上传图片文件，允许上传的图片文件格式有：\"\r\n                },\r\n                preformattedText : {\r\n                    title             : \"添加预格式文本或代码块\", \r\n                    emptyAlert        : \"错误：请填写预格式文本或代码的内容。\"\r\n                },\r\n                codeBlock : {\r\n                    title             : \"添加代码块\",                    \r\n                    selectLabel       : \"代码语言：\",\r\n                    selectDefaultText : \"请选择代码语言\",\r\n                    otherLanguage     : \"其他语言\",\r\n                    unselectedLanguageAlert : \"错误：请选择代码所属的语言类型。\",\r\n                    codeEmptyAlert    : \"错误：请填写代码内容。\"\r\n                },\r\n                htmlEntities : {\r\n                    title : \"HTML 实体字符\"\r\n                },\r\n                help : {\r\n                    title : \"使用帮助\"\r\n                }\r\n            }\r\n        }\r\n    };\r\n    \r\n    editormd.classNames  = {\r\n        tex : editormd.classPrefix + \"tex\"\r\n    };\r\n\r\n    editormd.dialogZindex = 99999;\r\n    \r\n    editormd.$katex       = null;\r\n    editormd.$marked      = null;\r\n    editormd.$CodeMirror  = null;\r\n    editormd.$prettyPrint = null;\r\n    \r\n    var timer, flowchartTimer;\r\n\r\n    editormd.prototype    = editormd.fn = {\r\n        state : {\r\n            watching   : false,\r\n            loaded     : false,\r\n            preview    : false,\r\n            fullscreen : false\r\n        },\r\n        \r\n        /**\r\n         * 构造函数/实例初始化\r\n         * Constructor / instance initialization\r\n         * \r\n         * @param   {String}   id            编辑器的ID\r\n         * @param   {Object}   [options={}]  配置选项 Key/Value\r\n         * @returns {editormd}               返回editormd的实例对象\r\n         */\r\n        \r\n        init : function (id, options) {\r\n            \r\n            options              = options || {};\r\n            \r\n            if (typeof id === \"object\")\r\n            {\r\n                options = id;\r\n            }\r\n            \r\n            var _this            = this;\r\n            var classPrefix      = this.classPrefix  = editormd.classPrefix; \r\n            var settings         = this.settings     = $.extend(true, editormd.defaults, options);\r\n            \r\n            id                   = (typeof id === \"object\") ? settings.id : id;\r\n            \r\n            var editor           = this.editor       = $(\"#\" + id);\r\n            \r\n            this.id              = id;\r\n            this.lang            = settings.lang;\r\n            \r\n            var classNames       = this.classNames   = {\r\n                textarea : {\r\n                    html     : classPrefix + \"html-textarea\",\r\n                    markdown : classPrefix + \"markdown-textarea\"\r\n                }\r\n            };\r\n            \r\n            settings.pluginPath = (settings.pluginPath === \"\") ? settings.path + \"../plugins/\" : settings.pluginPath; \r\n            \r\n            this.state.watching = (settings.watch) ? true : false;\r\n            \r\n            if ( !editor.hasClass(\"editormd\") ) {\r\n                editor.addClass(\"editormd\");\r\n            }\r\n            \r\n            editor.css({\r\n                width  : (typeof settings.width  === \"number\") ? settings.width  + \"px\" : settings.width,\r\n                height : (typeof settings.height === \"number\") ? settings.height + \"px\" : settings.height\r\n            });\r\n            \r\n            if (settings.autoHeight)\r\n            {\r\n                editor.css(\"height\", \"auto\");\r\n            }\r\n                        \r\n            var markdownTextarea = this.markdownTextarea = editor.children(\"textarea\");\r\n            \r\n            if (markdownTextarea.length < 1)\r\n            {\r\n                editor.append(\"<textarea></textarea>\");\r\n                markdownTextarea = this.markdownTextarea = editor.children(\"textarea\");\r\n            }\r\n            \r\n            markdownTextarea.addClass(classNames.textarea.markdown).attr(\"placeholder\", settings.placeholder);\r\n            \r\n            if (typeof markdownTextarea.attr(\"name\") === \"undefined\" || markdownTextarea.attr(\"name\") === \"\")\r\n            {\r\n                markdownTextarea.attr(\"name\", (settings.name !== \"\") ? settings.name : id + \"-markdown-doc\");\r\n            }\r\n            \r\n            var appendElements = [\r\n                (!settings.readOnly) ? \"<a href=\\\"javascript:;\\\" class=\\\"fa fa-close \" + classPrefix + \"preview-close-btn\\\"></a>\" : \"\",\r\n                ( (settings.saveHTMLToTextarea) ? \"<textarea class=\\\"\" + classNames.textarea.html + \"\\\" name=\\\"\" + id + \"-html-code\\\"></textarea>\" : \"\" ),\r\n                \"<div class=\\\"\" + classPrefix + \"preview\\\"><div class=\\\"markdown-body \" + classPrefix + \"preview-container\\\"></div></div>\",\r\n                \"<div class=\\\"\" + classPrefix + \"container-mask\\\" style=\\\"display:block;\\\"></div>\",\r\n                \"<div class=\\\"\" + classPrefix + \"mask\\\"></div>\"\r\n            ].join(\"\\n\");\r\n            \r\n            editor.append(appendElements).addClass(classPrefix + \"vertical\");\r\n            \r\n            if (settings.theme !== \"\") \r\n            {\r\n                editor.addClass(classPrefix + \"theme-\" + settings.theme);\r\n            }\r\n            \r\n            this.mask          = editor.children(\".\" + classPrefix + \"mask\");    \r\n            this.containerMask = editor.children(\".\" + classPrefix  + \"container-mask\");\r\n            \r\n            if (settings.markdown !== \"\")\r\n            {\r\n                markdownTextarea.val(settings.markdown);\r\n            }\r\n            \r\n            if (settings.appendMarkdown !== \"\")\r\n            {\r\n                markdownTextarea.val(markdownTextarea.val() + settings.appendMarkdown);\r\n            }\r\n            \r\n            this.htmlTextarea     = editor.children(\".\" + classNames.textarea.html);            \r\n            this.preview          = editor.children(\".\" + classPrefix + \"preview\");\r\n            this.previewContainer = this.preview.children(\".\" + classPrefix + \"preview-container\");\r\n            \r\n            if (settings.previewTheme !== \"\") \r\n            {\r\n                this.preview.addClass(classPrefix + \"preview-theme-\" + settings.previewTheme);\r\n            }\r\n            \r\n            if (typeof define === \"function\" && define.amd)\r\n            {\r\n                if (typeof katex !== \"undefined\") \r\n                {\r\n                    editormd.$katex = katex;\r\n                }\r\n                \r\n                if (settings.searchReplace && !settings.readOnly) \r\n                {\r\n                    editormd.loadCSS(settings.path + \"codemirror/addon/dialog/dialog\");\r\n                    editormd.loadCSS(settings.path + \"codemirror/addon/search/matchesonscrollbar\");\r\n                }\r\n            }\r\n            \r\n            if ((typeof define === \"function\" && define.amd) || !settings.autoLoadModules)\r\n            {\r\n                if (typeof CodeMirror !== \"undefined\") {\r\n                    editormd.$CodeMirror = CodeMirror;\r\n                }\r\n                \r\n                if (typeof marked     !== \"undefined\") {\r\n                    editormd.$marked     = marked;\r\n                }\r\n                \r\n                this.setCodeMirror().setToolbar().loadedDisplay();\r\n            } \r\n            else \r\n            {\r\n                this.loadQueues();\r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 所需组件加载队列\r\n         * Required components loading queue\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        loadQueues : function() {\r\n            var _this        = this;\r\n            var settings     = this.settings;\r\n            var loadPath     = settings.path;\r\n                                \r\n            var loadFlowChartOrSequenceDiagram = function() {\r\n                \r\n                if (editormd.isIE8) \r\n                {\r\n                    _this.loadedDisplay();\r\n                    \r\n                    return ;\r\n                }\r\n\r\n                if (settings.flowChart || settings.sequenceDiagram) \r\n                {\r\n                    editormd.loadScript(loadPath + \"raphael.min\", function() {\r\n\r\n                        editormd.loadScript(loadPath + \"underscore.min\", function() {  \r\n\r\n                            if (!settings.flowChart && settings.sequenceDiagram) \r\n                            {\r\n                                editormd.loadScript(loadPath + \"sequence-diagram.min\", function() {\r\n                                    _this.loadedDisplay();\r\n                                });\r\n                            }\r\n                            else if (settings.flowChart && !settings.sequenceDiagram) \r\n                            {      \r\n                                editormd.loadScript(loadPath + \"flowchart.min\", function() {  \r\n                                    editormd.loadScript(loadPath + \"jquery.flowchart.min\", function() {\r\n                                        _this.loadedDisplay();\r\n                                    });\r\n                                });\r\n                            }\r\n                            else if (settings.flowChart && settings.sequenceDiagram) \r\n                            {  \r\n                                editormd.loadScript(loadPath + \"flowchart.min\", function() {  \r\n                                    editormd.loadScript(loadPath + \"jquery.flowchart.min\", function() {\r\n                                        editormd.loadScript(loadPath + \"sequence-diagram.min\", function() {\r\n                                            _this.loadedDisplay();\r\n                                        });\r\n                                    });\r\n                                });\r\n                            }\r\n                        });\r\n\r\n                    });\r\n                } \r\n                else\r\n                {\r\n                    _this.loadedDisplay();\r\n                }\r\n            }; \r\n\r\n            editormd.loadCSS(loadPath + \"codemirror/codemirror.min\");\r\n            \r\n            if (settings.searchReplace && !settings.readOnly)\r\n            {\r\n                editormd.loadCSS(loadPath + \"codemirror/addon/dialog/dialog\");\r\n                editormd.loadCSS(loadPath + \"codemirror/addon/search/matchesonscrollbar\");\r\n            }\r\n            \r\n            if (settings.codeFold)\r\n            {\r\n                editormd.loadCSS(loadPath + \"codemirror/addon/fold/foldgutter\");            \r\n            }\r\n            \r\n            editormd.loadScript(loadPath + \"codemirror/codemirror.min\", function() {\r\n                editormd.$CodeMirror = CodeMirror;\r\n                \r\n                editormd.loadScript(loadPath + \"codemirror/modes.min\", function() {\r\n                    \r\n                    editormd.loadScript(loadPath + \"codemirror/addons.min\", function() {\r\n                        \r\n                        _this.setCodeMirror();\r\n                        \r\n                        if (settings.mode !== \"gfm\" && settings.mode !== \"markdown\") \r\n                        {\r\n                            _this.loadedDisplay();\r\n                            \r\n                            return false;\r\n                        }\r\n                        \r\n                        _this.setToolbar();\r\n\r\n                        editormd.loadScript(loadPath + \"marked.min\", function() {\r\n\r\n                            editormd.$marked = marked;\r\n                                \r\n                            if (settings.previewCodeHighlight) \r\n                            {\r\n                                editormd.loadScript(loadPath + \"prettify.min\", function() {\r\n                                    loadFlowChartOrSequenceDiagram();\r\n                                });\r\n                            } \r\n                            else\r\n                            {                  \r\n                                loadFlowChartOrSequenceDiagram();\r\n                            }\r\n                        });\r\n                        \r\n                    });\r\n                    \r\n                });\r\n                \r\n            });\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 设置 Editor.md 的整体主题，主要是工具栏\r\n         * Setting Editor.md theme\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        setTheme : function(theme) {\r\n            var editor      = this.editor;\r\n            var oldTheme    = this.settings.theme;\r\n            var themePrefix = this.classPrefix + \"theme-\";\r\n            \r\n            editor.removeClass(themePrefix + oldTheme).addClass(themePrefix + theme);\r\n            \r\n            this.settings.theme = theme;\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 设置 CodeMirror（编辑区）的主题\r\n         * Setting CodeMirror (Editor area) theme\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        setEditorTheme : function(theme) {  \r\n            var settings   = this.settings;  \r\n            settings.editorTheme = theme;  \r\n            \r\n            if (theme !== \"default\")\r\n            {\r\n                editormd.loadCSS(settings.path + \"codemirror/theme/\" + settings.editorTheme);\r\n            }\r\n            \r\n            this.cm.setOption(\"theme\", theme);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * setEditorTheme() 的别名\r\n         * setEditorTheme() alias\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        setCodeMirrorTheme : function (theme) {            \r\n            this.setEditorTheme(theme);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 设置 Editor.md 的主题\r\n         * Setting Editor.md theme\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        setPreviewTheme : function(theme) {  \r\n            var preview     = this.preview;\r\n            var oldTheme    = this.settings.previewTheme;\r\n            var themePrefix = this.classPrefix + \"preview-theme-\";\r\n            \r\n            preview.removeClass(themePrefix + oldTheme).addClass(themePrefix + theme);\r\n            \r\n            this.settings.previewTheme = theme;\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 配置和初始化CodeMirror组件\r\n         * CodeMirror initialization\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        setCodeMirror : function() { \r\n            var settings         = this.settings;\r\n            var editor           = this.editor;\r\n            \r\n            if (settings.editorTheme !== \"default\")\r\n            {\r\n                editormd.loadCSS(settings.path + \"codemirror/theme/\" + settings.editorTheme);\r\n            }\r\n            \r\n            var codeMirrorConfig = {\r\n                mode                      : settings.mode,\r\n                theme                     : settings.editorTheme,\r\n                tabSize                   : settings.tabSize,\r\n                dragDrop                  : false,\r\n                autofocus                 : settings.autoFocus,\r\n                autoCloseTags             : settings.autoCloseTags,\r\n                readOnly                  : (settings.readOnly) ? \"nocursor\" : false,\r\n                indentUnit                : settings.indentUnit,\r\n                lineNumbers               : settings.lineNumbers,\r\n                lineWrapping              : settings.lineWrapping,\r\n                extraKeys                 : {\r\n                                                \"Ctrl-Q\": function(cm) { \r\n                                                    cm.foldCode(cm.getCursor()); \r\n                                                }\r\n                                            },\r\n                foldGutter                : settings.codeFold,\r\n                gutters                   : [\"CodeMirror-linenumbers\", \"CodeMirror-foldgutter\"],\r\n                matchBrackets             : settings.matchBrackets,\r\n                indentWithTabs            : settings.indentWithTabs,\r\n                styleActiveLine           : settings.styleActiveLine,\r\n                styleSelectedText         : settings.styleSelectedText,\r\n                autoCloseBrackets         : settings.autoCloseBrackets,\r\n                showTrailingSpace         : settings.showTrailingSpace,\r\n                highlightSelectionMatches : ( (!settings.matchWordHighlight) ? false : { showToken: (settings.matchWordHighlight === \"onselected\") ? false : /\\w/ } )\r\n            };\r\n            \r\n            this.codeEditor = this.cm        = editormd.$CodeMirror.fromTextArea(this.markdownTextarea[0], codeMirrorConfig);\r\n            this.codeMirror = this.cmElement = editor.children(\".CodeMirror\");\r\n            \r\n            if (settings.value !== \"\")\r\n            {\r\n                this.cm.setValue(settings.value);\r\n            }\r\n\r\n            this.codeMirror.css({\r\n                fontSize : settings.fontSize,\r\n                width    : (!settings.watch) ? \"100%\" : \"50%\"\r\n            });\r\n            \r\n            if (settings.autoHeight)\r\n            {\r\n                this.codeMirror.css(\"height\", \"auto\");\r\n                this.cm.setOption(\"viewportMargin\", Infinity);\r\n            }\r\n            \r\n            if (!settings.lineNumbers)\r\n            {\r\n                this.codeMirror.find(\".CodeMirror-gutters\").css(\"border-right\", \"none\");\r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 获取CodeMirror的配置选项\r\n         * Get CodeMirror setting options\r\n         * \r\n         * @returns {Mixed}                  return CodeMirror setting option value\r\n         */\r\n        \r\n        getCodeMirrorOption : function(key) {            \r\n            return this.cm.getOption(key);\r\n        },\r\n        \r\n        /**\r\n         * 配置和重配置CodeMirror的选项\r\n         * CodeMirror setting options / resettings\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        setCodeMirrorOption : function(key, value) {\r\n            \r\n            this.cm.setOption(key, value);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 添加 CodeMirror 键盘快捷键\r\n         * Add CodeMirror keyboard shortcuts key map\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        addKeyMap : function(map, bottom) {\r\n            this.cm.addKeyMap(map, bottom);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 移除 CodeMirror 键盘快捷键\r\n         * Remove CodeMirror keyboard shortcuts key map\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        removeKeyMap : function(map) {\r\n            this.cm.removeKeyMap(map);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 跳转到指定的行\r\n         * Goto CodeMirror line\r\n         * \r\n         * @param   {String|Intiger}   line      line number or \"first\"|\"last\"\r\n         * @returns {editormd}                   返回editormd的实例对象\r\n         */\r\n        \r\n        gotoLine : function (line) {\r\n            \r\n            var settings = this.settings;\r\n            \r\n            if (!settings.gotoLine)\r\n            {\r\n                return this;\r\n            }\r\n            \r\n            var cm       = this.cm;\r\n            var editor   = this.editor;\r\n            var count    = cm.lineCount();\r\n            var preview  = this.preview;\r\n            \r\n            if (typeof line === \"string\")\r\n            {\r\n                if(line === \"last\")\r\n                {\r\n                    line = count;\r\n                }\r\n            \r\n                if (line === \"first\")\r\n                {\r\n                    line = 1;\r\n                }\r\n            }\r\n            \r\n            if (typeof line !== \"number\") \r\n            {  \r\n                alert(\"Error: The line number must be an integer.\");\r\n                return this;\r\n            }\r\n            \r\n            line  = parseInt(line) - 1;\r\n            \r\n            if (line > count)\r\n            {\r\n                alert(\"Error: The line number range 1-\" + count);\r\n                \r\n                return this;\r\n            }\r\n            \r\n            cm.setCursor( {line : line, ch : 0} );\r\n            \r\n            var scrollInfo   = cm.getScrollInfo();\r\n            var clientHeight = scrollInfo.clientHeight; \r\n            var coords       = cm.charCoords({line : line, ch : 0}, \"local\");\r\n            \r\n            cm.scrollTo(null, (coords.top + coords.bottom - clientHeight) / 2);\r\n            \r\n            if (settings.watch)\r\n            {            \r\n                var cmScroll  = this.codeMirror.find(\".CodeMirror-scroll\")[0];\r\n                var height    = $(cmScroll).height(); \r\n                var scrollTop = cmScroll.scrollTop;         \r\n                var percent   = (scrollTop / cmScroll.scrollHeight);\r\n\r\n                if (scrollTop === 0)\r\n                {\r\n                    preview.scrollTop(0);\r\n                } \r\n                else if (scrollTop + height >= cmScroll.scrollHeight - 16)\r\n                { \r\n                    preview.scrollTop(preview[0].scrollHeight);                    \r\n                } \r\n                else\r\n                {                    \r\n                    preview.scrollTop(preview[0].scrollHeight * percent);\r\n                }\r\n            }\r\n\r\n            cm.focus();\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 扩展当前实例对象，可同时设置多个或者只设置一个\r\n         * Extend editormd instance object, can mutil setting.\r\n         * \r\n         * @returns {editormd}                  this(editormd instance object.)\r\n         */\r\n        \r\n        extend : function() {\r\n            if (typeof arguments[1] !== \"undefined\")\r\n            {\r\n                if (typeof arguments[1] === \"function\")\r\n                {\r\n                    arguments[1] = $.proxy(arguments[1], this);\r\n                }\r\n\r\n                this[arguments[0]] = arguments[1];\r\n            }\r\n            \r\n            if (typeof arguments[0] === \"object\" && typeof arguments[0].length === \"undefined\")\r\n            {\r\n                $.extend(true, this, arguments[0]);\r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 设置或扩展当前实例对象，单个设置\r\n         * Extend editormd instance object, one by one\r\n         * \r\n         * @param   {String|Object}   key       option key\r\n         * @param   {String|Object}   value     option value\r\n         * @returns {editormd}                  this(editormd instance object.)\r\n         */\r\n        \r\n        set : function (key, value) {\r\n            \r\n            if (typeof value !== \"undefined\" && typeof value === \"function\")\r\n            {\r\n                value = $.proxy(value, this);\r\n            }\r\n            \r\n            this[key] = value;\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 重新配置\r\n         * Resetting editor options\r\n         * \r\n         * @param   {String|Object}   key       option key\r\n         * @param   {String|Object}   value     option value\r\n         * @returns {editormd}                  this(editormd instance object.)\r\n         */\r\n        \r\n        config : function(key, value) {\r\n            var settings = this.settings;\r\n            \r\n            if (typeof key === \"object\")\r\n            {\r\n                settings = $.extend(true, settings, key);\r\n            }\r\n            \r\n            if (typeof key === \"string\")\r\n            {\r\n                settings[key] = value;\r\n            }\r\n            \r\n            this.settings = settings;\r\n            this.recreate();\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 注册事件处理方法\r\n         * Bind editor event handle\r\n         * \r\n         * @param   {String}     eventType      event type\r\n         * @param   {Function}   callback       回调函数\r\n         * @returns {editormd}                  this(editormd instance object.)\r\n         */\r\n        \r\n        on : function(eventType, callback) {\r\n            var settings = this.settings;\r\n            \r\n            if (typeof settings[\"on\" + eventType] !== \"undefined\") \r\n            {                \r\n                settings[\"on\" + eventType] = $.proxy(callback, this);      \r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 解除事件处理方法\r\n         * Unbind editor event handle\r\n         * \r\n         * @param   {String}   eventType          event type\r\n         * @returns {editormd}                    this(editormd instance object.)\r\n         */\r\n        \r\n        off : function(eventType) {\r\n            var settings = this.settings;\r\n            \r\n            if (typeof settings[\"on\" + eventType] !== \"undefined\") \r\n            {\r\n                settings[\"on\" + eventType] = function(){};\r\n            }\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 显示工具栏\r\n         * Display toolbar\r\n         * \r\n         * @param   {Function} [callback=function(){}] 回调函数\r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        showToolbar : function(callback) {\r\n            var settings = this.settings;\r\n            \r\n            if(settings.readOnly) {\r\n                return this;\r\n            }\r\n            \r\n            if (settings.toolbar && (this.toolbar.length < 1 || this.toolbar.find(\".\" + this.classPrefix + \"menu\").html() === \"\") )\r\n            {\r\n                this.setToolbar();\r\n            }\r\n            \r\n            settings.toolbar = true; \r\n            \r\n            this.toolbar.show();\r\n            this.resize();\r\n            \r\n            $.proxy(callback || function(){}, this)();\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 隐藏工具栏\r\n         * Hide toolbar\r\n         * \r\n         * @param   {Function} [callback=function(){}] 回调函数\r\n         * @returns {editormd}                         this(editormd instance object.)\r\n         */\r\n        \r\n        hideToolbar : function(callback) { \r\n            var settings = this.settings;\r\n            \r\n            settings.toolbar = false;  \r\n            this.toolbar.hide();\r\n            this.resize();\r\n            \r\n            $.proxy(callback || function(){}, this)();\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 页面滚动时工具栏的固定定位\r\n         * Set toolbar in window scroll auto fixed position\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        setToolbarAutoFixed : function(fixed) {\r\n            \r\n            var state    = this.state;\r\n            var editor   = this.editor;\r\n            var toolbar  = this.toolbar;\r\n            var settings = this.settings;\r\n            \r\n            if (typeof fixed !== \"undefined\")\r\n            {\r\n                settings.toolbarAutoFixed = fixed;\r\n            }\r\n            \r\n            var autoFixedHandle = function(){\r\n                var $window = $(window);\r\n                var top     = $window.scrollTop();\r\n                \r\n                if (!settings.toolbarAutoFixed)\r\n                {\r\n                    return false;\r\n                }\r\n\r\n                if (top - editor.offset().top > 10 && top < editor.height())\r\n                {\r\n                    toolbar.css({\r\n                        position : \"fixed\",\r\n                        width    : editor.width() + \"px\",\r\n                        left     : ($window.width() - editor.width()) / 2 + \"px\"\r\n                    });\r\n                }\r\n                else\r\n                {\r\n                    toolbar.css({\r\n                        position : \"absolute\",\r\n                        width    : \"100%\",\r\n                        left     : 0\r\n                    });\r\n                }\r\n            };\r\n            \r\n            if (!state.fullscreen && !state.preview && settings.toolbar && settings.toolbarAutoFixed)\r\n            {\r\n                $(window).bind(\"scroll\", autoFixedHandle);\r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 配置和初始化工具栏\r\n         * Set toolbar and Initialization\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        setToolbar : function() {\r\n            var settings    = this.settings;  \r\n            \r\n            if(settings.readOnly) {\r\n                return this;\r\n            }\r\n            \r\n            var editor      = this.editor;\r\n            var preview     = this.preview;\r\n            var classPrefix = this.classPrefix;\r\n            \r\n            var toolbar     = this.toolbar = editor.children(\".\" + classPrefix + \"toolbar\");\r\n            \r\n            if (settings.toolbar && toolbar.length < 1)\r\n            {            \r\n                var toolbarHTML = \"<div class=\\\"\" + classPrefix + \"toolbar\\\"><div class=\\\"\" + classPrefix + \"toolbar-container\\\"><ul class=\\\"\" + classPrefix + \"menu\\\"></ul></div></div>\";\r\n                \r\n                editor.append(toolbarHTML);\r\n                toolbar = this.toolbar = editor.children(\".\" + classPrefix + \"toolbar\");\r\n            }\r\n            \r\n            if (!settings.toolbar) \r\n            {\r\n                toolbar.hide();\r\n                \r\n                return this;\r\n            }\r\n            \r\n            toolbar.show();\r\n            \r\n            var icons       = (typeof settings.toolbarIcons === \"function\") ? settings.toolbarIcons() \r\n                            : ((typeof settings.toolbarIcons === \"string\")  ? editormd.toolbarModes[settings.toolbarIcons] : settings.toolbarIcons);\r\n            \r\n            var toolbarMenu = toolbar.find(\".\" + this.classPrefix + \"menu\"), menu = \"\";\r\n            var pullRight   = false;\r\n            \r\n            for (var i = 0, len = icons.length; i < len; i++)\r\n            {\r\n                var name = icons[i];\r\n\r\n                if (name === \"||\") \r\n                { \r\n                    pullRight = true;\r\n                } \r\n                else if (name === \"|\")\r\n                {\r\n                    menu += \"<li class=\\\"divider\\\" unselectable=\\\"on\\\">|</li>\";\r\n                }\r\n                else\r\n                {\r\n                    var isHeader = (/h(\\d)/.test(name));\r\n                    var index    = name;\r\n                    \r\n                    if (name === \"watch\" && !settings.watch) {\r\n                        index = \"unwatch\";\r\n                    }\r\n                    \r\n                    var title     = settings.lang.toolbar[index];\r\n                    var iconTexts = settings.toolbarIconTexts[index];\r\n                    var iconClass = settings.toolbarIconsClass[index];\r\n                    \r\n                    title     = (typeof title     === \"undefined\") ? \"\" : title;\r\n                    iconTexts = (typeof iconTexts === \"undefined\") ? \"\" : iconTexts;\r\n                    iconClass = (typeof iconClass === \"undefined\") ? \"\" : iconClass;\r\n\r\n                    var menuItem = pullRight ? \"<li class=\\\"pull-right\\\">\" : \"<li>\";\r\n                    \r\n                    if (typeof settings.toolbarCustomIcons[name] !== \"undefined\" && typeof settings.toolbarCustomIcons[name] !== \"function\")\r\n                    {\r\n                        menuItem += settings.toolbarCustomIcons[name];\r\n                    }\r\n                    else \r\n                    {\r\n                        menuItem += \"<a href=\\\"javascript:;\\\" title=\\\"\" + title + \"\\\" unselectable=\\\"on\\\">\";\r\n                        menuItem += \"<i class=\\\"fa \" + iconClass + \"\\\" name=\\\"\"+name+\"\\\" unselectable=\\\"on\\\">\"+((isHeader) ? name.toUpperCase() : ( (iconClass === \"\") ? iconTexts : \"\") ) + \"</i>\";\r\n                        menuItem += \"</a>\";\r\n                    }\r\n\r\n                    menuItem += \"</li>\";\r\n\r\n                    menu = pullRight ? menuItem + menu : menu + menuItem;\r\n                }\r\n            }\r\n\r\n            toolbarMenu.html(menu);\r\n            \r\n            toolbarMenu.find(\"[title=\\\"Lowercase\\\"]\").attr(\"title\", settings.lang.toolbar.lowercase);\r\n            toolbarMenu.find(\"[title=\\\"ucwords\\\"]\").attr(\"title\", settings.lang.toolbar.ucwords);\r\n            \r\n            this.setToolbarHandler();\r\n            this.setToolbarAutoFixed();\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 工具栏图标事件处理对象序列\r\n         * Get toolbar icons event handlers\r\n         * \r\n         * @param   {Object}   cm    CodeMirror的实例对象\r\n         * @param   {String}   name  要获取的事件处理器名称\r\n         * @returns {Object}         返回处理对象序列\r\n         */\r\n            \r\n        dialogLockScreen : function() {\r\n            $.proxy(editormd.dialogLockScreen, this)();\r\n            \r\n            return this;\r\n        },\r\n\r\n        dialogShowMask : function(dialog) {\r\n            $.proxy(editormd.dialogShowMask, this)(dialog);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        getToolbarHandles : function(name) {  \r\n            var toolbarHandlers = this.toolbarHandlers = editormd.toolbarHandlers;\r\n            \r\n            return (name && typeof toolbarIconHandlers[name] !== \"undefined\") ? toolbarHandlers[name] : toolbarHandlers;\r\n        },\r\n        \r\n        /**\r\n         * 工具栏图标事件处理器\r\n         * Bind toolbar icons event handle\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        setToolbarHandler : function() {\r\n            var _this               = this;\r\n            var settings            = this.settings;\r\n            \r\n            if (!settings.toolbar || settings.readOnly) {\r\n                return this;\r\n            }\r\n            \r\n            var toolbar             = this.toolbar;\r\n            var cm                  = this.cm;\r\n            var classPrefix         = this.classPrefix;           \r\n            var toolbarIcons        = this.toolbarIcons = toolbar.find(\".\" + classPrefix + \"menu > li > a\");  \r\n            var toolbarIconHandlers = this.getToolbarHandles();  \r\n                \r\n            toolbarIcons.bind(editormd.mouseOrTouch(\"click\", \"touchend\"), function(event) {\r\n\r\n                var icon                = $(this).children(\".fa\");\r\n                var name                = icon.attr(\"name\");\r\n                var cursor              = cm.getCursor();\r\n                var selection           = cm.getSelection();\r\n\r\n                if (name === \"\") {\r\n                    return ;\r\n                }\r\n                \r\n                _this.activeIcon = icon;\r\n\r\n                if (typeof toolbarIconHandlers[name] !== \"undefined\") \r\n                {\r\n                    $.proxy(toolbarIconHandlers[name], _this)(cm);\r\n                }\r\n                else \r\n                {\r\n                    if (typeof settings.toolbarHandlers[name] !== \"undefined\") \r\n                    {\r\n                        $.proxy(settings.toolbarHandlers[name], _this)(cm, icon, cursor, selection);\r\n                    }\r\n                }\r\n                \r\n                if (name !== \"link\" && name !== \"reference-link\" && name !== \"image\" && name !== \"code-block\" && \r\n                    name !== \"preformatted-text\" && name !== \"watch\" && name !== \"preview\" && name !== \"search\" && name !== \"fullscreen\" && name !== \"info\") \r\n                {\r\n                    cm.focus();\r\n                }\r\n\r\n                return false;\r\n\r\n            });\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 动态创建对话框\r\n         * Creating custom dialogs\r\n         * \r\n         * @param   {Object} options  配置项键值对 Key/Value\r\n         * @returns {dialog}          返回创建的dialog的jQuery实例对象\r\n         */\r\n        \r\n        createDialog : function(options) {            \r\n            return $.proxy(editormd.createDialog, this)(options);\r\n        },\r\n        \r\n        /**\r\n         * 创建关于Editor.md的对话框\r\n         * Create about Editor.md dialog\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        createInfoDialog : function() {\r\n            var _this        = this;\r\n\t\t\tvar editor       = this.editor;\r\n            var classPrefix  = this.classPrefix;  \r\n            \r\n            var infoDialogHTML = [\r\n                \"<div class=\\\"\" + classPrefix + \"dialog \" + classPrefix + \"dialog-info\\\" style=\\\"\\\">\",\r\n                \"<div class=\\\"\" + classPrefix + \"dialog-container\\\">\",\r\n                \"<h1><i class=\\\"editormd-logo editormd-logo-lg editormd-logo-color\\\"></i> \" + editormd.title + \"<small>v\" + editormd.version + \"</small></h1>\",\r\n                \"<p>\" + this.lang.description + \"</p>\",\r\n                \"<p style=\\\"margin: 10px 0 20px 0;\\\"><a href=\\\"\" + editormd.homePage + \"\\\" target=\\\"_blank\\\">\" + editormd.homePage + \" <i class=\\\"fa fa-external-link\\\"></i></a></p>\",\r\n                \"<p style=\\\"font-size: 0.85em;\\\">Copyright &copy; 2015 <a href=\\\"https://github.com/pandao\\\" target=\\\"_blank\\\" class=\\\"hover-link\\\">Pandao</a>, The <a href=\\\"https://github.com/pandao/editor.md/blob/master/LICENSE\\\" target=\\\"_blank\\\" class=\\\"hover-link\\\">MIT</a> License.</p>\",\r\n                \"</div>\",\r\n                \"<a href=\\\"javascript:;\\\" class=\\\"fa fa-close \" + classPrefix + \"dialog-close\\\"></a>\",\r\n                \"</div>\"\r\n            ].join(\"\\n\");\r\n\r\n            editor.append(infoDialogHTML);\r\n            \r\n            var infoDialog  = this.infoDialog = editor.children(\".\" + classPrefix + \"dialog-info\");\r\n\r\n            infoDialog.find(\".\" + classPrefix + \"dialog-close\").bind(editormd.mouseOrTouch(\"click\", \"touchend\"), function() {\r\n                _this.hideInfoDialog();\r\n            });\r\n            \r\n            infoDialog.css(\"border\", (editormd.isIE8) ? \"1px solid #ddd\" : \"\").css(\"z-index\", editormd.dialogZindex).show();\r\n            \r\n            this.infoDialogPosition();\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 关于Editor.md对话居中定位\r\n         * Editor.md dialog position handle\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        infoDialogPosition : function() {\r\n            var infoDialog = this.infoDialog;\r\n            \r\n\t\t\tvar _infoDialogPosition = function() {\r\n\t\t\t\tinfoDialog.css({\r\n\t\t\t\t\ttop  : ($(window).height() - infoDialog.height()) / 2 + \"px\",\r\n\t\t\t\t\tleft : ($(window).width()  - infoDialog.width()) / 2  + \"px\"\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t_infoDialogPosition();\r\n\r\n\t\t\t$(window).resize(_infoDialogPosition);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 显示关于Editor.md\r\n         * Display about Editor.md dialog\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        showInfoDialog : function() {\r\n\r\n            $(\"html,body\").css(\"overflow-x\", \"hidden\");\r\n            \r\n            var _this       = this;\r\n\t\t\tvar editor      = this.editor;\r\n            var settings    = this.settings;         \r\n\t\t\tvar infoDialog  = this.infoDialog = editor.children(\".\" + this.classPrefix + \"dialog-info\");\r\n            \r\n            if (infoDialog.length < 1)\r\n            {\r\n                this.createInfoDialog();\r\n            }\r\n            \r\n            this.lockScreen(true);\r\n            \r\n            this.mask.css({\r\n\t\t\t\t\t\topacity         : settings.dialogMaskOpacity,\r\n\t\t\t\t\t\tbackgroundColor : settings.dialogMaskBgColor\r\n\t\t\t\t\t}).show();\r\n\r\n\t\t\tinfoDialog.css(\"z-index\", editormd.dialogZindex).show();\r\n\r\n\t\t\tthis.infoDialogPosition();\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 隐藏关于Editor.md\r\n         * Hide about Editor.md dialog\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        hideInfoDialog : function() {            \r\n            $(\"html,body\").css(\"overflow-x\", \"\");\r\n            this.infoDialog.hide();\r\n            this.mask.hide();\r\n            this.lockScreen(false);\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 锁屏\r\n         * lock screen\r\n         * \r\n         * @param   {Boolean}    lock    Boolean 布尔值，是否锁屏\r\n         * @returns {editormd}           返回editormd的实例对象\r\n         */\r\n        \r\n        lockScreen : function(lock) {\r\n            editormd.lockScreen(lock);\r\n            this.resize();\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 编辑器界面重建，用于动态语言包或模块加载等\r\n         * Recreate editor\r\n         * \r\n         * @returns {editormd}  返回editormd的实例对象\r\n         */\r\n        \r\n        recreate : function() {\r\n            var _this            = this;\r\n            var editor           = this.editor;\r\n            var settings         = this.settings;\r\n            \r\n            this.codeMirror.remove();\r\n            \r\n            this.setCodeMirror();\r\n\r\n            if (!settings.readOnly) \r\n            {\r\n                if (editor.find(\".editormd-dialog\").length > 0) {\r\n                    editor.find(\".editormd-dialog\").remove();\r\n                }\r\n                \r\n                if (settings.toolbar) \r\n                {  \r\n                    this.getToolbarHandles();                  \r\n                    this.setToolbar();\r\n                }\r\n            }\r\n            \r\n            this.loadedDisplay(true);\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 高亮预览HTML的pre代码部分\r\n         * highlight of preview codes\r\n         * \r\n         * @returns {editormd}             返回editormd的实例对象\r\n         */\r\n        \r\n        previewCodeHighlight : function() {    \r\n            var settings         = this.settings;\r\n            var previewContainer = this.previewContainer;\r\n            \r\n            if (settings.previewCodeHighlight) \r\n            {\r\n                previewContainer.find(\"pre\").addClass(\"prettyprint linenums\");\r\n                \r\n                if (typeof prettyPrint !== \"undefined\")\r\n                {                    \r\n                    prettyPrint();\r\n                }\r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 解析TeX(KaTeX)科学公式\r\n         * TeX(KaTeX) Renderer\r\n         * \r\n         * @returns {editormd}             返回editormd的实例对象\r\n         */\r\n        \r\n        katexRender : function() {\r\n            \r\n            if (timer === null)\r\n            {\r\n                return this;\r\n            }\r\n            \r\n            this.previewContainer.find(\".\" + editormd.classNames.tex).each(function(){\r\n                var tex  = $(this);\r\n                editormd.$katex.render(tex.text(), tex[0]);\r\n                \r\n                tex.find(\".katex\").css(\"font-size\", \"1.6em\");\r\n            });   \r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 解析和渲染流程图及时序图\r\n         * FlowChart and SequenceDiagram Renderer\r\n         * \r\n         * @returns {editormd}             返回editormd的实例对象\r\n         */\r\n        \r\n        flowChartAndSequenceDiagramRender : function() {\r\n            var $this            = this;\r\n            var settings         = this.settings;\r\n            var previewContainer = this.previewContainer;\r\n            \r\n            if (editormd.isIE8) {\r\n                return this;\r\n            }\r\n\r\n            if (settings.flowChart) {\r\n                if (flowchartTimer === null) {\r\n                    return this;\r\n                }\r\n                \r\n                previewContainer.find(\".flowchart\").flowChart(); \r\n            }\r\n\r\n            if (settings.sequenceDiagram) {\r\n                previewContainer.find(\".sequence-diagram\").sequenceDiagram({theme: \"simple\"});\r\n            }\r\n                    \r\n            var preview    = $this.preview;\r\n            var codeMirror = $this.codeMirror;\r\n            var codeView   = codeMirror.find(\".CodeMirror-scroll\");\r\n\r\n            var height    = codeView.height();\r\n            var scrollTop = codeView.scrollTop();                    \r\n            var percent   = (scrollTop / codeView[0].scrollHeight);\r\n            var tocHeight = 0;\r\n\r\n            preview.find(\".markdown-toc-list\").each(function(){\r\n                tocHeight += $(this).height();\r\n            });\r\n\r\n            var tocMenuHeight = preview.find(\".editormd-toc-menu\").height(); \r\n            tocMenuHeight = (!tocMenuHeight) ? 0 : tocMenuHeight;\r\n\r\n            if (scrollTop === 0) \r\n            {\r\n                preview.scrollTop(0);\r\n            } \r\n            else if (scrollTop + height >= codeView[0].scrollHeight - 16)\r\n            { \r\n                preview.scrollTop(preview[0].scrollHeight);                        \r\n            } \r\n            else\r\n            {                  \r\n                preview.scrollTop((preview[0].scrollHeight + tocHeight + tocMenuHeight) * percent);\r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 注册键盘快捷键处理\r\n         * Register CodeMirror keyMaps (keyboard shortcuts).\r\n         * \r\n         * @param   {Object}    keyMap      KeyMap key/value {\"(Ctrl/Shift/Alt)-Key\" : function(){}}\r\n         * @returns {editormd}              return this\r\n         */\r\n        \r\n        registerKeyMaps : function(keyMap) {\r\n            \r\n            var _this           = this;\r\n            var cm              = this.cm;\r\n            var settings        = this.settings;\r\n            var toolbarHandlers = editormd.toolbarHandlers;\r\n            var disabledKeyMaps = settings.disabledKeyMaps;\r\n            \r\n            keyMap              = keyMap || null;\r\n            \r\n            if (keyMap)\r\n            {\r\n                for (var i in keyMap)\r\n                {\r\n                    if ($.inArray(i, disabledKeyMaps) < 0)\r\n                    {\r\n                        var map = {};\r\n                        map[i]  = keyMap[i];\r\n\r\n                        cm.addKeyMap(keyMap);\r\n                    }\r\n                }\r\n            }\r\n            else\r\n            {\r\n                for (var k in editormd.keyMaps)\r\n                {\r\n                    var _keyMap = editormd.keyMaps[k];\r\n                    var handle = (typeof _keyMap === \"string\") ? $.proxy(toolbarHandlers[_keyMap], _this) : $.proxy(_keyMap, _this);\r\n                    \r\n                    if ($.inArray(k, [\"F9\", \"F10\", \"F11\"]) < 0 && $.inArray(k, disabledKeyMaps) < 0)\r\n                    {\r\n                        var _map = {};\r\n                        _map[k] = handle;\r\n\r\n                        cm.addKeyMap(_map);\r\n                    }\r\n                }\r\n                \r\n                $(window).keydown(function(event) {\r\n                    \r\n                    var keymaps = {\r\n                        \"120\" : \"F9\",\r\n                        \"121\" : \"F10\",\r\n                        \"122\" : \"F11\"\r\n                    };\r\n                    \r\n                    if ( $.inArray(keymaps[event.keyCode], disabledKeyMaps) < 0 )\r\n                    {\r\n                        switch (event.keyCode)\r\n                        {\r\n                            case 120:\r\n                                    $.proxy(toolbarHandlers[\"watch\"], _this)();\r\n                                    return false;\r\n                                break;\r\n                                \r\n                            case 121:\r\n                                    $.proxy(toolbarHandlers[\"preview\"], _this)();\r\n                                    return false;\r\n                                break;\r\n                                \r\n                            case 122:\r\n                                    $.proxy(toolbarHandlers[\"fullscreen\"], _this)();                        \r\n                                    return false;\r\n                                break;\r\n                                \r\n                            default:\r\n                                break;\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 绑定同步滚动\r\n         * \r\n         * @returns {editormd} return this\r\n         */\r\n        \r\n        bindScrollEvent : function() {\r\n            \r\n            var _this            = this;\r\n            var preview          = this.preview;\r\n            var settings         = this.settings;\r\n            var codeMirror       = this.codeMirror;\r\n            var mouseOrTouch     = editormd.mouseOrTouch;\r\n            \r\n            if (!settings.syncScrolling) {\r\n                return this;\r\n            }\r\n                \r\n            var cmBindScroll = function() {    \r\n                codeMirror.find(\".CodeMirror-scroll\").bind(mouseOrTouch(\"scroll\", \"touchmove\"), function(event) {\r\n                    var height    = $(this).height();\r\n                    var scrollTop = $(this).scrollTop();                    \r\n                    var percent   = (scrollTop / $(this)[0].scrollHeight);\r\n                    \r\n                    var tocHeight = 0;\r\n                    \r\n                    preview.find(\".markdown-toc-list\").each(function(){\r\n                        tocHeight += $(this).height();\r\n                    });\r\n                    \r\n                    var tocMenuHeight = preview.find(\".editormd-toc-menu\").height();\r\n                    tocMenuHeight = (!tocMenuHeight) ? 0 : tocMenuHeight;\r\n\r\n                    if (scrollTop === 0) \r\n                    {\r\n                        preview.scrollTop(0);\r\n                    } \r\n                    else if (scrollTop + height >= $(this)[0].scrollHeight - 16)\r\n                    { \r\n                        preview.scrollTop(preview[0].scrollHeight);                        \r\n                    } \r\n                    else\r\n                    {\r\n                        preview.scrollTop((preview[0].scrollHeight  + tocHeight + tocMenuHeight) * percent);\r\n                    }\r\n                    \r\n                    $.proxy(settings.onscroll, _this)(event);\r\n                });\r\n            };\r\n\r\n            var cmUnbindScroll = function() {\r\n                codeMirror.find(\".CodeMirror-scroll\").unbind(mouseOrTouch(\"scroll\", \"touchmove\"));\r\n            };\r\n\r\n            var previewBindScroll = function() {\r\n                \r\n                preview.bind(mouseOrTouch(\"scroll\", \"touchmove\"), function(event) {\r\n                    var height    = $(this).height();\r\n                    var scrollTop = $(this).scrollTop();         \r\n                    var percent   = (scrollTop / $(this)[0].scrollHeight);\r\n                    var codeView  = codeMirror.find(\".CodeMirror-scroll\");\r\n\r\n                    if(scrollTop === 0) \r\n                    {\r\n                        codeView.scrollTop(0);\r\n                    }\r\n                    else if (scrollTop + height >= $(this)[0].scrollHeight)\r\n                    {\r\n                        codeView.scrollTop(codeView[0].scrollHeight);                        \r\n                    }\r\n                    else \r\n                    {\r\n                        codeView.scrollTop(codeView[0].scrollHeight * percent);\r\n                    }\r\n                    \r\n                    $.proxy(settings.onpreviewscroll, _this)(event);\r\n                });\r\n\r\n            };\r\n\r\n            var previewUnbindScroll = function() {\r\n                preview.unbind(mouseOrTouch(\"scroll\", \"touchmove\"));\r\n            }; \r\n\r\n\t\t\tcodeMirror.bind({\r\n\t\t\t\tmouseover  : cmBindScroll,\r\n\t\t\t\tmouseout   : cmUnbindScroll,\r\n\t\t\t\ttouchstart : cmBindScroll,\r\n\t\t\t\ttouchend   : cmUnbindScroll\r\n\t\t\t});\r\n            \r\n            if (settings.syncScrolling === \"single\") {\r\n                return this;\r\n            }\r\n            \r\n\t\t\tpreview.bind({\r\n\t\t\t\tmouseover  : previewBindScroll,\r\n\t\t\t\tmouseout   : previewUnbindScroll,\r\n\t\t\t\ttouchstart : previewBindScroll,\r\n\t\t\t\ttouchend   : previewUnbindScroll\r\n\t\t\t});\r\n\r\n            return this;\r\n        },\r\n        \r\n        bindChangeEvent : function() {\r\n            \r\n            var _this            = this;\r\n            var cm               = this.cm;\r\n            var settings         = this.settings;\r\n            \r\n            if (!settings.syncScrolling) {\r\n                return this;\r\n            }\r\n            \r\n            cm.on(\"change\", function(_cm, changeObj) {\r\n                \r\n                if (settings.watch)\r\n                {\r\n                    _this.previewContainer.css(\"padding\", settings.autoHeight ? \"20px 20px 50px 40px\" : \"20px\");\r\n                }\r\n                \r\n                timer = setTimeout(function() {\r\n                    clearTimeout(timer);\r\n                    _this.save();\r\n                    timer = null;\r\n                }, settings.delay);\r\n            });\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 加载队列完成之后的显示处理\r\n         * Display handle of the module queues loaded after.\r\n         * \r\n         * @param   {Boolean}   recreate   是否为重建编辑器\r\n         * @returns {editormd}             返回editormd的实例对象\r\n         */\r\n        \r\n        loadedDisplay : function(recreate) {\r\n            \r\n            recreate             = recreate || false;\r\n            \r\n            var _this            = this;\r\n            var editor           = this.editor;\r\n            var preview          = this.preview;\r\n            var settings         = this.settings;\r\n            \r\n            this.containerMask.hide();\r\n            \r\n            this.save();\r\n            \r\n            if (settings.watch) {\r\n                preview.show();\r\n            }\r\n            \r\n            editor.data(\"oldWidth\", editor.width()).data(\"oldHeight\", editor.height()); // 为了兼容Zepto\r\n            \r\n            this.resize();\r\n            this.registerKeyMaps();\r\n            \r\n            $(window).resize(function(){\r\n                _this.resize();\r\n            });\r\n            \r\n            this.bindScrollEvent().bindChangeEvent();\r\n            \r\n            if (!recreate)\r\n            {\r\n                $.proxy(settings.onload, this)();\r\n            }\r\n            \r\n            this.state.loaded = true;\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 设置编辑器的宽度\r\n         * Set editor width\r\n         * \r\n         * @param   {Number|String} width  编辑器宽度值\r\n         * @returns {editormd}             返回editormd的实例对象\r\n         */\r\n        \r\n        width : function(width) {\r\n                \r\n            this.editor.css(\"width\", (typeof width === \"number\") ? width  + \"px\" : width);            \r\n            this.resize();\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 设置编辑器的高度\r\n         * Set editor height\r\n         * \r\n         * @param   {Number|String} height  编辑器高度值\r\n         * @returns {editormd}              返回editormd的实例对象\r\n         */\r\n        \r\n        height : function(height) {\r\n                \r\n            this.editor.css(\"height\", (typeof height === \"number\")  ? height  + \"px\" : height);            \r\n            this.resize();\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 调整编辑器的尺寸和布局\r\n         * Resize editor layout\r\n         * \r\n         * @param   {Number|String} [width=null]  编辑器宽度值\r\n         * @param   {Number|String} [height=null] 编辑器高度值\r\n         * @returns {editormd}                    返回editormd的实例对象\r\n         */\r\n        \r\n        resize : function(width, height) {\r\n            \r\n            width  = width  || null;\r\n            height = height || null;\r\n            \r\n            var state      = this.state;\r\n            var editor     = this.editor;\r\n            var preview    = this.preview;\r\n            var toolbar    = this.toolbar;\r\n            var settings   = this.settings;\r\n            var codeMirror = this.codeMirror;\r\n            \r\n            if (width)\r\n            {\r\n                editor.css(\"width\", (typeof width  === \"number\") ? width  + \"px\" : width);\r\n            }\r\n            \r\n            if (settings.autoHeight && !state.fullscreen && !state.preview)\r\n            {\r\n                editor.css(\"height\", \"auto\");\r\n                codeMirror.css(\"height\", \"auto\");\r\n            } \r\n            else \r\n            {\r\n                if (height) \r\n                {\r\n                    editor.css(\"height\", (typeof height === \"number\") ? height + \"px\" : height);\r\n                }\r\n                \r\n                if (state.fullscreen)\r\n                {\r\n                    editor.height($(window).height());\r\n                }\r\n\r\n                if (settings.toolbar && !settings.readOnly) \r\n                {\r\n                    codeMirror.css(\"margin-top\", toolbar.height() + 1).height(editor.height() - toolbar.height());\r\n                } \r\n                else\r\n                {\r\n                    codeMirror.css(\"margin-top\", 0).height(editor.height());\r\n                }\r\n            }\r\n            \r\n            if(settings.watch) \r\n            {\r\n                codeMirror.width(editor.width() / 2);\r\n                preview.width((!state.preview) ? editor.width() / 2 : editor.width());\r\n                \r\n                this.previewContainer.css(\"padding\", settings.autoHeight ? \"20px 20px 50px 40px\" : \"20px\");\r\n                \r\n                if (settings.toolbar && !settings.readOnly) \r\n                {\r\n                    preview.css(\"top\", toolbar.height() + 1);\r\n                } \r\n                else \r\n                {\r\n                    preview.css(\"top\", 0);\r\n                }\r\n                \r\n                if (settings.autoHeight && !state.fullscreen && !state.preview)\r\n                {\r\n                    preview.height(\"\");\r\n                }\r\n                else\r\n                {                \r\n                    var previewHeight = (settings.toolbar && !settings.readOnly) ? editor.height() - toolbar.height() : editor.height();\r\n                    \r\n                    preview.height(previewHeight);\r\n                }\r\n            } \r\n            else \r\n            {\r\n                codeMirror.width(editor.width());\r\n                preview.hide();\r\n            }\r\n            \r\n            if (state.loaded) \r\n            {\r\n                $.proxy(settings.onresize, this)();\r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 解析和保存Markdown代码\r\n         * Parse & Saving Markdown source code\r\n         * \r\n         * @returns {editormd}     返回editormd的实例对象\r\n         */\r\n        \r\n        save : function() {\r\n            \r\n            if (timer === null)\r\n            {\r\n                return this;\r\n            }\r\n            \r\n            var _this            = this;\r\n            var state            = this.state;\r\n            var settings         = this.settings;\r\n            var cm               = this.cm;            \r\n            var cmValue          = cm.getValue();\r\n            var previewContainer = this.previewContainer;\r\n\r\n            if (settings.mode !== \"gfm\" && settings.mode !== \"markdown\") \r\n            {\r\n                this.markdownTextarea.val(cmValue);\r\n                \r\n                return this;\r\n            }\r\n            \r\n            var marked          = editormd.$marked;\r\n            var markdownToC     = this.markdownToC = [];            \r\n            var rendererOptions = this.markedRendererOptions = {  \r\n                toc                  : settings.toc,\r\n                tocm                 : settings.tocm,\r\n                tocStartLevel        : settings.tocStartLevel,\r\n                pageBreak            : settings.pageBreak,\r\n                taskList             : settings.taskList,\r\n                emoji                : settings.emoji,\r\n                tex                  : settings.tex,\r\n                atLink               : settings.atLink,           // for @link\r\n                emailLink            : settings.emailLink,        // for mail address auto link\r\n                flowChart            : settings.flowChart,\r\n                sequenceDiagram      : settings.sequenceDiagram,\r\n                previewCodeHighlight : settings.previewCodeHighlight,\r\n            };\r\n            \r\n            var markedOptions = this.markedOptions = {\r\n                renderer    : editormd.markedRenderer(markdownToC, rendererOptions),\r\n                gfm         : true,\r\n                tables      : true,\r\n                breaks      : true,\r\n                pedantic    : false,\r\n                sanitize    : (settings.htmlDecode) ? false : true,  // 关闭忽略HTML标签，即开启识别HTML标签，默认为false\r\n                smartLists  : true,\r\n                smartypants : true\r\n            };\r\n            \r\n            marked.setOptions(markedOptions);\r\n                    \r\n            var newMarkdownDoc = editormd.$marked(cmValue, markedOptions);\r\n            \r\n            //console.info(\"cmValue\", cmValue, newMarkdownDoc);\r\n            \r\n            newMarkdownDoc = editormd.filterHTMLTags(newMarkdownDoc, settings.htmlDecode);\r\n            \r\n            //console.error(\"cmValue\", cmValue, newMarkdownDoc);\r\n            \r\n            this.markdownTextarea.text(cmValue);\r\n            \r\n            cm.save();\r\n            \r\n            if (settings.saveHTMLToTextarea) \r\n            {\r\n                this.htmlTextarea.text(newMarkdownDoc);\r\n            }\r\n            \r\n            if(settings.watch || (!settings.watch && state.preview))\r\n            {\r\n                previewContainer.html(newMarkdownDoc);\r\n\r\n                this.previewCodeHighlight();\r\n                \r\n                if (settings.toc) \r\n                {\r\n                    var tocContainer = (settings.tocContainer === \"\") ? previewContainer : $(settings.tocContainer);\r\n                    var tocMenu      = tocContainer.find(\".\" + this.classPrefix + \"toc-menu\");\r\n                    \r\n                    tocContainer.attr(\"previewContainer\", (settings.tocContainer === \"\") ? \"true\" : \"false\");\r\n                    \r\n                    if (settings.tocContainer !== \"\" && tocMenu.length > 0)\r\n                    {\r\n                        tocMenu.remove();\r\n                    }\r\n                    \r\n                    editormd.markdownToCRenderer(markdownToC, tocContainer, settings.tocDropdown, settings.tocStartLevel);\r\n            \r\n                    if (settings.tocDropdown || tocContainer.find(\".\" + this.classPrefix + \"toc-menu\").length > 0)\r\n                    {\r\n                        editormd.tocDropdownMenu(tocContainer, (settings.tocTitle !== \"\") ? settings.tocTitle : this.lang.tocTitle);\r\n                    }\r\n            \r\n                    if (settings.tocContainer !== \"\")\r\n                    {\r\n                        previewContainer.find(\".markdown-toc\").css(\"border\", \"none\");\r\n                    }\r\n                }\r\n                \r\n                if (settings.tex)\r\n                {\r\n                    if (!editormd.kaTeXLoaded && settings.autoLoadModules) \r\n                    {\r\n                        editormd.loadKaTeX(function() {\r\n                            editormd.$katex = katex;\r\n                            editormd.kaTeXLoaded = true;\r\n                            _this.katexRender();\r\n                        });\r\n                    } \r\n                    else \r\n                    {\r\n                        editormd.$katex = katex;\r\n                        this.katexRender();\r\n                    }\r\n                }                \r\n                \r\n                if (settings.flowChart || settings.sequenceDiagram)\r\n                {\r\n                    flowchartTimer = setTimeout(function(){\r\n                        clearTimeout(flowchartTimer);\r\n                        _this.flowChartAndSequenceDiagramRender();\r\n                        flowchartTimer = null;\r\n                    }, 10);\r\n                }\r\n\r\n                if (state.loaded) \r\n                {\r\n                    $.proxy(settings.onchange, this)();\r\n                }\r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 聚焦光标位置\r\n         * Focusing the cursor position\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        focus : function() {\r\n            this.cm.focus();\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 设置光标的位置\r\n         * Set cursor position\r\n         * \r\n         * @param   {Object}    cursor 要设置的光标位置键值对象，例：{line:1, ch:0}\r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        setCursor : function(cursor) {\r\n            this.cm.setCursor(cursor);\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 获取当前光标的位置\r\n         * Get the current position of the cursor\r\n         * \r\n         * @returns {Cursor}         返回一个光标Cursor对象\r\n         */\r\n        \r\n        getCursor : function() {\r\n            return this.cm.getCursor();\r\n        },\r\n        \r\n        /**\r\n         * 设置光标选中的范围\r\n         * Set cursor selected ranges\r\n         * \r\n         * @param   {Object}    from   开始位置的光标键值对象，例：{line:1, ch:0}\r\n         * @param   {Object}    to     结束位置的光标键值对象，例：{line:1, ch:0}\r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        setSelection : function(from, to) {\r\n        \r\n            this.cm.setSelection(from, to);\r\n        \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 获取光标选中的文本\r\n         * Get the texts from cursor selected\r\n         * \r\n         * @returns {String}         返回选中文本的字符串形式\r\n         */\r\n        \r\n        getSelection : function() {\r\n            return this.cm.getSelection();\r\n        },\r\n        \r\n        /**\r\n         * 设置光标选中的文本范围\r\n         * Set the cursor selection ranges\r\n         * \r\n         * @param   {Array}    ranges  cursor selection ranges array\r\n         * @returns {Array}            return this\r\n         */\r\n        \r\n        setSelections : function(ranges) {\r\n            this.cm.setSelections(ranges);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 获取光标选中的文本范围\r\n         * Get the cursor selection ranges\r\n         * \r\n         * @returns {Array}         return selection ranges array\r\n         */\r\n        \r\n        getSelections : function() {\r\n            return this.cm.getSelections();\r\n        },\r\n        \r\n        /**\r\n         * 替换当前光标选中的文本或在当前光标处插入新字符\r\n         * Replace the text at the current cursor selected or insert a new character at the current cursor position\r\n         * \r\n         * @param   {String}    value  要插入的字符值\r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        replaceSelection : function(value) {\r\n            this.cm.replaceSelection(value);\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 在当前光标处插入新字符\r\n         * Insert a new character at the current cursor position\r\n         *\r\n         * 同replaceSelection()方法\r\n         * With the replaceSelection() method\r\n         * \r\n         * @param   {String}    value  要插入的字符值\r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        insertValue : function(value) {\r\n            this.replaceSelection(value);\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 追加markdown\r\n         * append Markdown to editor\r\n         * \r\n         * @param   {String}    md     要追加的markdown源文档\r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        appendMarkdown : function(md) {\r\n            var settings = this.settings;\r\n            var cm       = this.cm;\r\n            \r\n            cm.setValue(cm.getValue() + md);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 设置和传入编辑器的markdown源文档\r\n         * Set Markdown source document\r\n         * \r\n         * @param   {String}    md     要传入的markdown源文档\r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        setMarkdown : function(md) {\r\n            this.cm.setValue(md || this.settings.markdown);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 获取编辑器的markdown源文档\r\n         * Set Editor.md markdown/CodeMirror value\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        getMarkdown : function() {\r\n            return this.cm.getValue();\r\n        },\r\n        \r\n        /**\r\n         * 获取编辑器的源文档\r\n         * Get CodeMirror value\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        getValue : function() {\r\n            return this.cm.getValue();\r\n        },\r\n        \r\n        /**\r\n         * 设置编辑器的源文档\r\n         * Set CodeMirror value\r\n         * \r\n         * @param   {String}     value   set code/value/string/text\r\n         * @returns {editormd}           返回editormd的实例对象\r\n         */\r\n        \r\n        setValue : function(value) {\r\n            this.cm.setValue(value);\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 清空编辑器\r\n         * Empty CodeMirror editor container\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        clear : function() {\r\n            this.cm.setValue(\"\");\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 获取解析后存放在Textarea的HTML源码\r\n         * Get parsed html code from Textarea\r\n         * \r\n         * @returns {String}               返回HTML源码\r\n         */\r\n        \r\n        getHTML : function() {\r\n            if (!this.settings.saveHTMLToTextarea)\r\n            {\r\n                alert(\"Error: settings.saveHTMLToTextarea == false\");\r\n\r\n                return false;\r\n            }\r\n            \r\n            return this.htmlTextarea.val();\r\n        },\r\n        \r\n        /**\r\n         * getHTML()的别名\r\n         * getHTML (alias)\r\n         * \r\n         * @returns {String}           Return html code 返回HTML源码\r\n         */\r\n        \r\n        getTextareaSavedHTML : function() {\r\n            return this.getHTML();\r\n        },\r\n        \r\n        /**\r\n         * 获取预览窗口的HTML源码\r\n         * Get html from preview container\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        getPreviewedHTML : function() {\r\n            if (!this.settings.watch)\r\n            {\r\n                alert(\"Error: settings.watch == false\");\r\n\r\n                return false;\r\n            }\r\n            \r\n            return this.previewContainer.html();\r\n        },\r\n        \r\n        /**\r\n         * 开启实时预览\r\n         * Enable real-time watching\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        watch : function(callback) {     \r\n            var settings        = this.settings;\r\n            \r\n            if ($.inArray(settings.mode, [\"gfm\", \"markdown\"]) < 0)\r\n            {\r\n                return this;\r\n            }\r\n            \r\n            this.state.watching = settings.watch = true;\r\n            this.preview.show();\r\n            \r\n            if (this.toolbar)\r\n            {\r\n                var watchIcon   = settings.toolbarIconsClass.watch;\r\n                var unWatchIcon = settings.toolbarIconsClass.unwatch;\r\n                \r\n                var icon        = this.toolbar.find(\".fa[name=watch]\");\r\n                icon.parent().attr(\"title\", settings.lang.toolbar.watch);\r\n                icon.removeClass(unWatchIcon).addClass(watchIcon);\r\n            }\r\n            \r\n            this.codeMirror.css(\"border-right\", \"1px solid #ddd\").width(this.editor.width() / 2); \r\n            \r\n            timer = 0;\r\n            \r\n            this.save().resize();\r\n            \r\n            if (!settings.onwatch)\r\n            {\r\n                settings.onwatch = callback || function() {};\r\n            }\r\n            \r\n            $.proxy(settings.onwatch, this)();\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 关闭实时预览\r\n         * Disable real-time watching\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        unwatch : function(callback) {\r\n            var settings        = this.settings;\r\n            this.state.watching = settings.watch = false;\r\n            this.preview.hide();\r\n            \r\n            if (this.toolbar) \r\n            {\r\n                var watchIcon   = settings.toolbarIconsClass.watch;\r\n                var unWatchIcon = settings.toolbarIconsClass.unwatch;\r\n                \r\n                var icon    = this.toolbar.find(\".fa[name=watch]\");\r\n                icon.parent().attr(\"title\", settings.lang.toolbar.unwatch);\r\n                icon.removeClass(watchIcon).addClass(unWatchIcon);\r\n            }\r\n            \r\n            this.codeMirror.css(\"border-right\", \"none\").width(this.editor.width());\r\n            \r\n            this.resize();\r\n            \r\n            if (!settings.onunwatch)\r\n            {\r\n                settings.onunwatch = callback || function() {};\r\n            }\r\n            \r\n            $.proxy(settings.onunwatch, this)();\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 显示编辑器\r\n         * Show editor\r\n         * \r\n         * @param   {Function} [callback=function()] 回调函数\r\n         * @returns {editormd}                       返回editormd的实例对象\r\n         */\r\n        \r\n        show : function(callback) {\r\n            callback  = callback || function() {};\r\n            \r\n            var _this = this;\r\n            this.editor.show(0, function() {\r\n                $.proxy(callback, _this)();\r\n            });\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 隐藏编辑器\r\n         * Hide editor\r\n         * \r\n         * @param   {Function} [callback=function()] 回调函数\r\n         * @returns {editormd}                       返回editormd的实例对象\r\n         */\r\n        \r\n        hide : function(callback) {\r\n            callback  = callback || function() {};\r\n            \r\n            var _this = this;\r\n            this.editor.hide(0, function() {\r\n                $.proxy(callback, _this)();\r\n            });\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 隐藏编辑器部分，只预览HTML\r\n         * Enter preview html state\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        previewing : function() {\r\n            \r\n            var _this            = this;\r\n            var editor           = this.editor;\r\n            var preview          = this.preview;\r\n            var toolbar          = this.toolbar;\r\n            var settings         = this.settings;\r\n            var codeMirror       = this.codeMirror;\r\n            var previewContainer = this.previewContainer;\r\n            \r\n            if ($.inArray(settings.mode, [\"gfm\", \"markdown\"]) < 0) {\r\n                return this;\r\n            }\r\n            \r\n            if (settings.toolbar && toolbar) {\r\n                toolbar.toggle();\r\n                toolbar.find(\".fa[name=preview]\").toggleClass(\"active\");\r\n            }\r\n            \r\n            codeMirror.toggle();\r\n            \r\n            var escHandle = function(event) {\r\n                if (event.shiftKey && event.keyCode === 27) {\r\n                    _this.previewed();\r\n                }\r\n            };\r\n\r\n            if (codeMirror.css(\"display\") === \"none\") // 为了兼容Zepto，而不使用codeMirror.is(\":hidden\")\r\n            {\r\n                this.state.preview = true;\r\n\r\n                if (this.state.fullscreen) {\r\n                    preview.css(\"background\", \"#fff\");\r\n                }\r\n                \r\n                editor.find(\".\" + this.classPrefix + \"preview-close-btn\").show().bind(editormd.mouseOrTouch(\"click\", \"touchend\"), function(){\r\n                    _this.previewed();\r\n                });\r\n            \r\n                if (!settings.watch)\r\n                {\r\n                    this.save();\r\n                } \r\n                else \r\n                {\r\n                    previewContainer.css(\"padding\", \"\");\r\n                }\r\n                \r\n                previewContainer.addClass(this.classPrefix + \"preview-active\");\r\n\r\n                preview.show().css({\r\n                    position  : \"\",\r\n                    top       : 0,\r\n                    width     : editor.width(),\r\n                    height    : (settings.autoHeight && !this.state.fullscreen) ? \"auto\" : editor.height()\r\n                });\r\n                \r\n                if (this.state.loaded)\r\n                {\r\n                    $.proxy(settings.onpreviewing, this)();\r\n                }\r\n\r\n                $(window).bind(\"keyup\", escHandle);\r\n            } \r\n            else \r\n            {\r\n                $(window).unbind(\"keyup\", escHandle);\r\n                this.previewed();\r\n            }\r\n        },\r\n        \r\n        /**\r\n         * 显示编辑器部分，退出只预览HTML\r\n         * Exit preview html state\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        previewed : function() {\r\n            \r\n            var editor           = this.editor;\r\n            var preview          = this.preview;\r\n            var toolbar          = this.toolbar;\r\n            var settings         = this.settings;\r\n            var previewContainer = this.previewContainer;\r\n            var previewCloseBtn  = editor.find(\".\" + this.classPrefix + \"preview-close-btn\");\r\n\r\n            this.state.preview   = false;\r\n            \r\n            this.codeMirror.show();\r\n            \r\n            if (settings.toolbar) {\r\n                toolbar.show();\r\n            }\r\n            \r\n            preview[(settings.watch) ? \"show\" : \"hide\"]();\r\n            \r\n            previewCloseBtn.hide().unbind(editormd.mouseOrTouch(\"click\", \"touchend\"));\r\n                \r\n            previewContainer.removeClass(this.classPrefix + \"preview-active\");\r\n                \r\n            if (settings.watch)\r\n            {\r\n                previewContainer.css(\"padding\", \"20px\");\r\n            }\r\n            \r\n            preview.css({ \r\n                background : null,\r\n                position   : \"absolute\",\r\n                width      : editor.width() / 2,\r\n                height     : (settings.autoHeight && !this.state.fullscreen) ? \"auto\" : editor.height() - toolbar.height(),\r\n                top        : (settings.toolbar)    ? toolbar.height() : 0\r\n            });\r\n\r\n            if (this.state.loaded)\r\n            {\r\n                $.proxy(settings.onpreviewed, this)();\r\n            }\r\n            \r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 编辑器全屏显示\r\n         * Fullscreen show\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        fullscreen : function() {\r\n            \r\n            var _this            = this;\r\n            var state            = this.state;\r\n            var editor           = this.editor;\r\n            var preview          = this.preview;\r\n            var toolbar          = this.toolbar;\r\n            var settings         = this.settings;\r\n            var fullscreenClass  = this.classPrefix + \"fullscreen\";\r\n            \r\n            if (toolbar) {\r\n                toolbar.find(\".fa[name=fullscreen]\").parent().toggleClass(\"active\"); \r\n            }\r\n            \r\n            var escHandle = function(event) {\r\n                if (!event.shiftKey && event.keyCode === 27) \r\n                {\r\n                    if (state.fullscreen)\r\n                    {\r\n                        _this.fullscreenExit();\r\n                    }\r\n                }\r\n            };\r\n\r\n            if (!editor.hasClass(fullscreenClass)) \r\n            {\r\n                state.fullscreen = true;\r\n\r\n                $(\"html,body\").css(\"overflow\", \"hidden\");\r\n                \r\n                editor.css({\r\n                    width    : $(window).width(),\r\n                    height   : $(window).height()\r\n                }).addClass(fullscreenClass);\r\n\r\n                this.resize();\r\n    \r\n                $.proxy(settings.onfullscreen, this)();\r\n\r\n                $(window).bind(\"keyup\", escHandle);\r\n            }\r\n            else\r\n            {           \r\n                $(window).unbind(\"keyup\", escHandle); \r\n                this.fullscreenExit();\r\n            }\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 编辑器退出全屏显示\r\n         * Exit fullscreen state\r\n         * \r\n         * @returns {editormd}         返回editormd的实例对象\r\n         */\r\n        \r\n        fullscreenExit : function() {\r\n            \r\n            var editor            = this.editor;\r\n            var settings          = this.settings;\r\n            var toolbar           = this.toolbar;\r\n            var fullscreenClass   = this.classPrefix + \"fullscreen\";  \r\n            \r\n            this.state.fullscreen = false;\r\n            \r\n            if (toolbar) {\r\n                toolbar.find(\".fa[name=fullscreen]\").parent().removeClass(\"active\"); \r\n            }\r\n\r\n            $(\"html,body\").css(\"overflow\", \"\");\r\n\r\n            editor.css({\r\n                width    : editor.data(\"oldWidth\"),\r\n                height   : editor.data(\"oldHeight\")\r\n            }).removeClass(fullscreenClass);\r\n\r\n            this.resize();\r\n            \r\n            $.proxy(settings.onfullscreenExit, this)();\r\n\r\n            return this;\r\n        },\r\n        \r\n        /**\r\n         * 加载并执行插件\r\n         * Load and execute the plugin\r\n         * \r\n         * @param   {String}     name    plugin name / function name\r\n         * @param   {String}     path    plugin load path\r\n         * @returns {editormd}           返回editormd的实例对象\r\n         */\r\n        \r\n        executePlugin : function(name, path) {\r\n            \r\n            var _this    = this;\r\n            var cm       = this.cm;\r\n            var settings = this.settings;\r\n            \r\n            path = settings.pluginPath + path;\r\n            \r\n            if (typeof define === \"function\") \r\n            {            \r\n                if (typeof this[name] === \"undefined\")\r\n                {\r\n                    alert(\"Error: \" + name + \" plugin is not found, you are not load this plugin.\");\r\n                    \r\n                    return this;\r\n                }\r\n                \r\n                this[name](cm);\r\n                \r\n                return this;\r\n            }\r\n            \r\n            if ($.inArray(path, editormd.loadFiles.plugin) < 0)\r\n            {\r\n                editormd.loadPlugin(path, function() {\r\n                    editormd.loadPlugins[name] = _this[name];\r\n                    _this[name](cm);\r\n                });\r\n            }\r\n            else\r\n            {\r\n                $.proxy(editormd.loadPlugins[name], this)(cm);\r\n            }\r\n            \r\n            return this;\r\n        },\r\n                \r\n        /**\r\n         * 搜索替换\r\n         * Search & replace\r\n         * \r\n         * @param   {String}     command    CodeMirror serach commands, \"find, fintNext, fintPrev, clearSearch, replace, replaceAll\"\r\n         * @returns {editormd}              return this\r\n         */\r\n        \r\n        search : function(command) {\r\n            var settings = this.settings;\r\n            \r\n            if (!settings.searchReplace)\r\n            {\r\n                alert(\"Error: settings.searchReplace == false\");\r\n                return this;\r\n            }\r\n            \r\n            if (!settings.readOnly)\r\n            {\r\n                this.cm.execCommand(command || \"find\");\r\n            }\r\n            \r\n            return this;\r\n        },\r\n        \r\n        searchReplace : function() {            \r\n            this.search(\"replace\");\r\n            \r\n            return this;\r\n        },\r\n        \r\n        searchReplaceAll : function() {          \r\n            this.search(\"replaceAll\");\r\n            \r\n            return this;\r\n        }\r\n    };\r\n    \r\n    editormd.fn.init.prototype = editormd.fn; \r\n   \r\n    /**\r\n     * 锁屏\r\n     * lock screen when dialog opening\r\n     * \r\n     * @returns {void}\r\n     */\r\n\r\n    editormd.dialogLockScreen = function() {\r\n        var settings = this.settings || {dialogLockScreen : true};\r\n        \r\n        if (settings.dialogLockScreen) \r\n        {            \r\n            $(\"html,body\").css(\"overflow\", \"hidden\");\r\n            this.resize();\r\n        }\r\n    };\r\n   \r\n    /**\r\n     * 显示透明背景层\r\n     * Display mask layer when dialog opening\r\n     * \r\n     * @param   {Object}     dialog    dialog jQuery object\r\n     * @returns {void}\r\n     */\r\n    \r\n    editormd.dialogShowMask = function(dialog) {\r\n        var editor   = this.editor;\r\n        var settings = this.settings || {dialogShowMask : true};\r\n        \r\n        dialog.css({\r\n            top  : ($(window).height() - dialog.height()) / 2 + \"px\",\r\n            left : ($(window).width()  - dialog.width())  / 2 + \"px\"\r\n        });\r\n\r\n        if (settings.dialogShowMask) {\r\n            editor.children(\".\" + this.classPrefix + \"mask\").css(\"z-index\", parseInt(dialog.css(\"z-index\")) - 1).show();\r\n        }\r\n    };\r\n\r\n    editormd.toolbarHandlers = {\r\n        undo : function() {\r\n            this.cm.undo();\r\n        },\r\n        \r\n        redo : function() {\r\n            this.cm.redo();\r\n        },\r\n        \r\n        bold : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            cm.replaceSelection(\"**\" + selection + \"**\");\r\n\r\n            if(selection === \"\") {\r\n                cm.setCursor(cursor.line, cursor.ch + 2);\r\n            }\r\n        },\r\n        \r\n        del : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            cm.replaceSelection(\"~~\" + selection + \"~~\");\r\n\r\n            if(selection === \"\") {\r\n                cm.setCursor(cursor.line, cursor.ch + 2);\r\n            }\r\n        },\r\n\r\n        italic : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            cm.replaceSelection(\"*\" + selection + \"*\");\r\n\r\n            if(selection === \"\") {\r\n                cm.setCursor(cursor.line, cursor.ch + 1);\r\n            }\r\n        },\r\n\r\n        quote : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            if (cursor.ch !== 0)\r\n            {\r\n                cm.setCursor(cursor.line, 0);\r\n                cm.replaceSelection(\"> \" + selection);\r\n                cm.setCursor(cursor.line, cursor.ch + 2);\r\n            }\r\n            else\r\n            {\r\n                cm.replaceSelection(\"> \" + selection);\r\n            }\r\n\r\n            //cm.replaceSelection(\"> \" + selection);\r\n            //cm.setCursor(cursor.line, (selection === \"\") ? cursor.ch + 2 : cursor.ch + selection.length + 2);\r\n        },\r\n        \r\n        ucfirst : function() {\r\n            var cm         = this.cm;\r\n            var selection  = cm.getSelection();\r\n            var selections = cm.listSelections();\r\n\r\n            cm.replaceSelection(editormd.firstUpperCase(selection));\r\n            cm.setSelections(selections);\r\n        },\r\n        \r\n        ucwords : function() {\r\n            var cm         = this.cm;\r\n            var selection  = cm.getSelection();\r\n            var selections = cm.listSelections();\r\n\r\n            cm.replaceSelection(editormd.wordsFirstUpperCase(selection));\r\n            cm.setSelections(selections);\r\n        },\r\n        \r\n        uppercase : function() {\r\n            var cm         = this.cm;\r\n            var selection  = cm.getSelection();\r\n            var selections = cm.listSelections();\r\n\r\n            cm.replaceSelection(selection.toUpperCase());\r\n            cm.setSelections(selections);\r\n        },\r\n        \r\n        lowercase : function() {\r\n            var cm         = this.cm;\r\n            var cursor     = cm.getCursor();\r\n            var selection  = cm.getSelection();\r\n            var selections = cm.listSelections();\r\n            \r\n            cm.replaceSelection(selection.toLowerCase());\r\n            cm.setSelections(selections);\r\n        },\r\n\r\n        h1 : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            if (cursor.ch !== 0)\r\n            {\r\n                cm.setCursor(cursor.line, 0);\r\n                cm.replaceSelection(\"# \" + selection);\r\n                cm.setCursor(cursor.line, cursor.ch + 2);\r\n            }\r\n            else\r\n            {\r\n                cm.replaceSelection(\"# \" + selection);\r\n            }\r\n        },\r\n\r\n        h2 : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            if (cursor.ch !== 0)\r\n            {\r\n                cm.setCursor(cursor.line, 0);\r\n                cm.replaceSelection(\"## \" + selection);\r\n                cm.setCursor(cursor.line, cursor.ch + 3);\r\n            }\r\n            else\r\n            {\r\n                cm.replaceSelection(\"## \" + selection);\r\n            }\r\n        },\r\n\r\n        h3 : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            if (cursor.ch !== 0)\r\n            {\r\n                cm.setCursor(cursor.line, 0);\r\n                cm.replaceSelection(\"### \" + selection);\r\n                cm.setCursor(cursor.line, cursor.ch + 4);\r\n            }\r\n            else\r\n            {\r\n                cm.replaceSelection(\"### \" + selection);\r\n            }\r\n        },\r\n\r\n        h4 : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            if (cursor.ch !== 0)\r\n            {\r\n                cm.setCursor(cursor.line, 0);\r\n                cm.replaceSelection(\"#### \" + selection);\r\n                cm.setCursor(cursor.line, cursor.ch + 5);\r\n            }\r\n            else\r\n            {\r\n                cm.replaceSelection(\"#### \" + selection);\r\n            }\r\n        },\r\n\r\n        h5 : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            if (cursor.ch !== 0)\r\n            {\r\n                cm.setCursor(cursor.line, 0);\r\n                cm.replaceSelection(\"##### \" + selection);\r\n                cm.setCursor(cursor.line, cursor.ch + 6);\r\n            }\r\n            else\r\n            {\r\n                cm.replaceSelection(\"##### \" + selection);\r\n            }\r\n        },\r\n\r\n        h6 : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            if (cursor.ch !== 0)\r\n            {\r\n                cm.setCursor(cursor.line, 0);\r\n                cm.replaceSelection(\"###### \" + selection);\r\n                cm.setCursor(cursor.line, cursor.ch + 7);\r\n            }\r\n            else\r\n            {\r\n                cm.replaceSelection(\"###### \" + selection);\r\n            }\r\n        },\r\n\r\n        \"list-ul\" : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            if (selection === \"\") \r\n            {\r\n                cm.replaceSelection(\"- \" + selection);\r\n            } \r\n            else \r\n            {\r\n                var selectionText = selection.split(\"\\n\");\r\n\r\n                for (var i = 0, len = selectionText.length; i < len; i++) \r\n                {\r\n                    selectionText[i] = (selectionText[i] === \"\") ? \"\" : \"- \" + selectionText[i];\r\n                }\r\n\r\n                cm.replaceSelection(selectionText.join(\"\\n\"));\r\n            }\r\n        },\r\n\r\n        \"list-ol\" : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            if(selection === \"\") \r\n            {\r\n                cm.replaceSelection(\"1. \" + selection);\r\n            }\r\n            else\r\n            {\r\n                var selectionText = selection.split(\"\\n\");\r\n\r\n                for (var i = 0, len = selectionText.length; i < len; i++) \r\n                {\r\n                    selectionText[i] = (selectionText[i] === \"\") ? \"\" : (i+1) + \". \" + selectionText[i];\r\n                }\r\n\r\n                cm.replaceSelection(selectionText.join(\"\\n\"));\r\n            }\r\n        },\r\n\r\n        hr : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            cm.replaceSelection(((cursor.ch !== 0) ? \"\\n\\n\" : \"\\n\") + \"------------\\n\\n\");\r\n        },\r\n\r\n        tex : function() {\r\n            if (!this.settings.tex)\r\n            {\r\n                alert(\"settings.tex === false\");\r\n                return this;\r\n            }\r\n            \r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            cm.replaceSelection(\"$$\" + selection + \"$$\");\r\n\r\n            if(selection === \"\") {\r\n                cm.setCursor(cursor.line, cursor.ch + 2);\r\n            }\r\n        },\r\n\r\n        link : function() {\r\n            this.executePlugin(\"linkDialog\", \"link-dialog/link-dialog\");\r\n        },\r\n\r\n        \"reference-link\" : function() {\r\n            this.executePlugin(\"referenceLinkDialog\", \"reference-link-dialog/reference-link-dialog\");\r\n        },\r\n\r\n        pagebreak : function() {\r\n            if (!this.settings.pageBreak)\r\n            {\r\n                alert(\"settings.pageBreak === false\");\r\n                return this;\r\n            }\r\n            \r\n            var cm        = this.cm;\r\n            var selection = cm.getSelection();\r\n\r\n            cm.replaceSelection(\"\\r\\n[========]\\r\\n\");\r\n        },\r\n\r\n        image : function() {\r\n            this.executePlugin(\"imageDialog\", \"image-dialog/image-dialog\");\r\n        },\r\n        \r\n        code : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n\r\n            cm.replaceSelection(\"`\" + selection + \"`\");\r\n\r\n            if (selection === \"\") {\r\n                cm.setCursor(cursor.line, cursor.ch + 1);\r\n            }\r\n        },\r\n\r\n        \"code-block\" : function() {\r\n            this.executePlugin(\"codeBlockDialog\", \"code-block-dialog/code-block-dialog\");            \r\n        },\r\n\r\n        \"preformatted-text\" : function() {\r\n            this.executePlugin(\"preformattedTextDialog\", \"preformatted-text-dialog/preformatted-text-dialog\");\r\n        },\r\n        \r\n        table : function() {\r\n            this.executePlugin(\"tableDialog\", \"table-dialog/table-dialog\");         \r\n        },\r\n        \r\n        datetime : function() {\r\n            var cm        = this.cm;\r\n            var selection = cm.getSelection();\r\n            var date      = new Date();\r\n            var langName  = this.settings.lang.name;\r\n            var datefmt   = editormd.dateFormat() + \" \" + editormd.dateFormat((langName === \"zh-cn\" || langName === \"zh-tw\") ? \"cn-week-day\" : \"week-day\");\r\n\r\n            cm.replaceSelection(datefmt);\r\n        },\r\n        \r\n        emoji : function() {\r\n            this.executePlugin(\"emojiDialog\", \"emoji-dialog/emoji-dialog\");\r\n        },\r\n                \r\n        \"html-entities\" : function() {\r\n            this.executePlugin(\"htmlEntitiesDialog\", \"html-entities-dialog/html-entities-dialog\");\r\n        },\r\n                \r\n        \"goto-line\" : function() {\r\n            this.executePlugin(\"gotoLineDialog\", \"goto-line-dialog/goto-line-dialog\");\r\n        },\r\n\r\n        watch : function() {    \r\n            this[this.settings.watch ? \"unwatch\" : \"watch\"]();\r\n        },\r\n\r\n        preview : function() {\r\n            this.previewing();\r\n        },\r\n\r\n        fullscreen : function() {\r\n            this.fullscreen();\r\n        },\r\n\r\n        clear : function() {\r\n            this.clear();\r\n        },\r\n        \r\n        search : function() {\r\n            this.search();\r\n        },\r\n\r\n        help : function() {\r\n            this.executePlugin(\"helpDialog\", \"help-dialog/help-dialog\");\r\n        },\r\n\r\n        info : function() {\r\n            this.showInfoDialog();\r\n        }\r\n    };\r\n    \r\n    editormd.keyMaps = {\r\n        \"Ctrl-1\"       : \"h1\",\r\n        \"Ctrl-2\"       : \"h2\",\r\n        \"Ctrl-3\"       : \"h3\",\r\n        \"Ctrl-4\"       : \"h4\",\r\n        \"Ctrl-5\"       : \"h5\",\r\n        \"Ctrl-6\"       : \"h6\",\r\n        \"Ctrl-B\"       : \"bold\",  // if this is string ==  editormd.toolbarHandlers.xxxx\r\n        \"Ctrl-D\"       : \"datetime\",\r\n        \r\n        \"Ctrl-E\"       : function() { // emoji\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n            \r\n            if (!this.settings.emoji)\r\n            {\r\n                alert(\"Error: settings.emoji == false\");\r\n                return ;\r\n            }\r\n\r\n            cm.replaceSelection(\":\" + selection + \":\");\r\n\r\n            if (selection === \"\") {\r\n                cm.setCursor(cursor.line, cursor.ch + 1);\r\n            }\r\n        },\r\n        \"Ctrl-Alt-G\"   : \"goto-line\",\r\n        \"Ctrl-H\"       : \"hr\",\r\n        \"Ctrl-I\"       : \"italic\",\r\n        \"Ctrl-K\"       : \"code\",\r\n        \r\n        \"Ctrl-L\"        : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n            \r\n            var title = (selection === \"\") ? \"\" : \" \\\"\"+selection+\"\\\"\";\r\n\r\n            cm.replaceSelection(\"[\" + selection + \"](\"+title+\")\");\r\n\r\n            if (selection === \"\") {\r\n                cm.setCursor(cursor.line, cursor.ch + 1);\r\n            }\r\n        },\r\n        \"Ctrl-U\"         : \"list-ul\",\r\n        \r\n        \"Shift-Ctrl-A\"   : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n            \r\n            if (!this.settings.atLink)\r\n            {\r\n                alert(\"Error: settings.atLink == false\");\r\n                return ;\r\n            }\r\n\r\n            cm.replaceSelection(\"@\" + selection);\r\n\r\n            if (selection === \"\") {\r\n                cm.setCursor(cursor.line, cursor.ch + 1);\r\n            }\r\n        },\r\n        \r\n        \"Shift-Ctrl-C\"     : \"code\",\r\n        \"Shift-Ctrl-Q\"     : \"quote\",\r\n        \"Shift-Ctrl-S\"     : \"del\",\r\n        \"Shift-Ctrl-K\"     : \"tex\",  // KaTeX\r\n        \r\n        \"Shift-Alt-C\"      : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n            \r\n            cm.replaceSelection([\"```\", selection, \"```\"].join(\"\\n\"));\r\n\r\n            if (selection === \"\") {\r\n                cm.setCursor(cursor.line, cursor.ch + 3);\r\n            } \r\n        },\r\n        \r\n        \"Shift-Ctrl-Alt-C\" : \"code-block\",\r\n        \"Shift-Ctrl-H\"     : \"html-entities\",\r\n        \"Shift-Alt-H\"      : \"help\",\r\n        \"Shift-Ctrl-E\"     : \"emoji\",\r\n        \"Shift-Ctrl-U\"     : \"uppercase\",\r\n        \"Shift-Alt-U\"      : \"ucwords\",\r\n        \"Shift-Ctrl-Alt-U\" : \"ucfirst\",\r\n        \"Shift-Alt-L\"      : \"lowercase\",\r\n        \r\n        \"Shift-Ctrl-I\"     : function() {\r\n            var cm        = this.cm;\r\n            var cursor    = cm.getCursor();\r\n            var selection = cm.getSelection();\r\n            \r\n            var title = (selection === \"\") ? \"\" : \" \\\"\"+selection+\"\\\"\";\r\n\r\n            cm.replaceSelection(\"![\" + selection + \"](\"+title+\")\");\r\n\r\n            if (selection === \"\") {\r\n                cm.setCursor(cursor.line, cursor.ch + 4);\r\n            }\r\n        },\r\n        \r\n        \"Shift-Ctrl-Alt-I\" : \"image\",\r\n        \"Shift-Ctrl-L\"     : \"link\",\r\n        \"Shift-Ctrl-O\"     : \"list-ol\",\r\n        \"Shift-Ctrl-P\"     : \"preformatted-text\",\r\n        \"Shift-Ctrl-T\"     : \"table\",\r\n        \"Shift-Alt-P\"      : \"pagebreak\",\r\n        \"F9\"               : \"watch\",\r\n        \"F10\"              : \"preview\",\r\n        \"F11\"              : \"fullscreen\",\r\n    };\r\n    \r\n    /**\r\n     * 清除字符串两边的空格\r\n     * Clear the space of strings both sides.\r\n     * \r\n     * @param   {String}    str            string\r\n     * @returns {String}                   trimed string    \r\n     */\r\n    \r\n    var trim = function(str) {\r\n        return (!String.prototype.trim) ? str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, \"\") : str.trim();\r\n    };\r\n    \r\n    editormd.trim = trim;\r\n    \r\n    /**\r\n     * 所有单词首字母大写\r\n     * Words first to uppercase\r\n     * \r\n     * @param   {String}    str            string\r\n     * @returns {String}                   string\r\n     */\r\n    \r\n    var ucwords = function (str) {\r\n        return str.toLowerCase().replace(/\\b(\\w)|\\s(\\w)/g, function($1) {  \r\n            return $1.toUpperCase();\r\n        });\r\n    };\r\n    \r\n    editormd.ucwords = editormd.wordsFirstUpperCase = ucwords;\r\n    \r\n    /**\r\n     * 字符串首字母大写\r\n     * Only string first char to uppercase\r\n     * \r\n     * @param   {String}    str            string\r\n     * @returns {String}                   string\r\n     */\r\n    \r\n    var firstUpperCase = function(str) {        \r\n        return str.toLowerCase().replace(/\\b(\\w)/, function($1){\r\n            return $1.toUpperCase();\r\n        });\r\n    };\r\n    \r\n    var ucfirst = firstUpperCase;\r\n    \r\n    editormd.firstUpperCase = editormd.ucfirst = firstUpperCase;\r\n    \r\n    editormd.urls = {\r\n        atLinkBase : \"https://github.com/\"\r\n    };\r\n    \r\n    editormd.regexs = {\r\n        atLink        : /@(\\w+)/g,\r\n        email         : /(\\w+)@(\\w+)\\.(\\w+)\\.?(\\w+)?/g,\r\n        emailLink     : /(mailto:)?([\\w\\.\\_]+)@(\\w+)\\.(\\w+)\\.?(\\w+)?/g,\r\n        emoji         : /:([\\w\\+-]+):/g,\r\n        emojiDatetime : /(\\d{2}:\\d{2}:\\d{2})/g,\r\n        twemoji       : /:(tw-([\\w]+)-?(\\w+)?):/g,\r\n        fontAwesome   : /:(fa-([\\w]+)(-(\\w+)){0,}):/g,\r\n        editormdLogo  : /:(editormd-logo-?(\\w+)?):/g,\r\n        pageBreak     : /^\\[[=]{8,}\\]$/\r\n    };\r\n\r\n    // Emoji graphics files url path\r\n    editormd.emoji     = {\r\n        path  : \"http://www.emoji-cheat-sheet.com/graphics/emojis/\",\r\n        ext   : \".png\"\r\n    };\r\n\r\n    // Twitter Emoji (Twemoji)  graphics files url path    \r\n    editormd.twemoji = {\r\n        path : \"http://twemoji.maxcdn.com/36x36/\",\r\n        ext  : \".png\"\r\n    };\r\n\r\n    /**\r\n     * 自定义marked的解析器\r\n     * Custom Marked renderer rules\r\n     * \r\n     * @param   {Array}    markdownToC     传入用于接收TOC的数组\r\n     * @returns {Renderer} markedRenderer  返回marked的Renderer自定义对象\r\n     */\r\n\r\n    editormd.markedRenderer = function(markdownToC, options) {\r\n        var defaults = {\r\n            toc                  : true,           // Table of contents\r\n            tocm                 : false,\r\n            tocStartLevel        : 1,              // Said from H1 to create ToC  \r\n            pageBreak            : true,\r\n            atLink               : true,           // for @link\r\n            emailLink            : true,           // for mail address auto link\r\n            taskList             : false,          // Enable Github Flavored Markdown task lists\r\n            emoji                : false,          // :emoji: , Support Twemoji, fontAwesome, Editor.md logo emojis.\r\n            tex                  : false,          // TeX(LaTeX), based on KaTeX\r\n            flowChart            : false,          // flowChart.js only support IE9+\r\n            sequenceDiagram      : false,          // sequenceDiagram.js only support IE9+\r\n        };\r\n        \r\n        var settings        = $.extend(defaults, options || {});    \r\n        var marked          = editormd.$marked;\r\n        var markedRenderer  = new marked.Renderer();\r\n        markdownToC         = markdownToC || [];        \r\n            \r\n        var regexs          = editormd.regexs;\r\n        var atLinkReg       = regexs.atLink;\r\n        var emojiReg        = regexs.emoji;\r\n        var emailReg        = regexs.email;\r\n        var emailLinkReg    = regexs.emailLink;\r\n        var twemojiReg      = regexs.twemoji;\r\n        var faIconReg       = regexs.fontAwesome;\r\n        var editormdLogoReg = regexs.editormdLogo;\r\n        var pageBreakReg    = regexs.pageBreak;\r\n\r\n        markedRenderer.emoji = function(text) {\r\n            \r\n            text = text.replace(editormd.regexs.emojiDatetime, function($1) {           \r\n                return $1.replace(/:/g, \"&#58;\");\r\n            });\r\n            \r\n            var matchs = text.match(emojiReg);\r\n\r\n            if (!matchs || !settings.emoji) {\r\n                return text;\r\n            }\r\n\r\n            for (var i = 0, len = matchs.length; i < len; i++)\r\n            {            \r\n                if (matchs[i] === \":+1:\") {\r\n                    matchs[i] = \":\\\\+1:\";\r\n                }\r\n\r\n                text = text.replace(new RegExp(matchs[i]), function($1, $2){\r\n                    var faMatchs = $1.match(faIconReg);\r\n                    var name     = $1.replace(/:/g, \"\");\r\n\r\n                    if (faMatchs)\r\n                    {                        \r\n                        for (var fa = 0, len1 = faMatchs.length; fa < len1; fa++)\r\n                        {\r\n                            var faName = faMatchs[fa].replace(/:/g, \"\");\r\n                            \r\n                            return \"<i class=\\\"fa \" + faName + \" fa-emoji\\\" title=\\\"\" + faName.replace(\"fa-\", \"\") + \"\\\"></i>\";\r\n                        }\r\n                    }\r\n                    else\r\n                    {\r\n                        var emdlogoMathcs = $1.match(editormdLogoReg);\r\n                        var twemojiMatchs = $1.match(twemojiReg);\r\n\r\n                        if (emdlogoMathcs)                                        \r\n                        {                            \r\n                            for (var x = 0, len2 = emdlogoMathcs.length; x < len2; x++)\r\n                            {\r\n                                var logoName = emdlogoMathcs[x].replace(/:/g, \"\");\r\n                                return \"<i class=\\\"\" + logoName + \"\\\" title=\\\"Editor.md logo (\" + logoName + \")\\\"></i>\";\r\n                            }\r\n                        }\r\n                        else if (twemojiMatchs) \r\n                        {\r\n                            for (var t = 0, len3 = twemojiMatchs.length; t < len3; t++)\r\n                            {\r\n                                var twe = twemojiMatchs[t].replace(/:/g, \"\").replace(\"tw-\", \"\");\r\n                                return \"<img src=\\\"\" + editormd.twemoji.path + twe + editormd.twemoji.ext + \"\\\" title=\\\"twemoji-\" + twe + \"\\\" alt=\\\"twemoji-\" + twe + \"\\\" class=\\\"emoji twemoji\\\" />\";\r\n                            }\r\n                        }\r\n                        else\r\n                        {\r\n                            var src = (name === \"+1\") ? \"plus1\" : name;\r\n                            src     = (src === \"black_large_square\") ? \"black_square\" : src;\r\n                            src     = (src === \"moon\") ? \"waxing_gibbous_moon\" : src;\r\n\r\n                            return \"<img src=\\\"\" + editormd.emoji.path + src + editormd.emoji.ext + \"\\\" class=\\\"emoji\\\" title=\\\"&#58;\" + name + \"&#58;\\\" alt=\\\"&#58;\" + name + \"&#58;\\\" />\";\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            return text;\r\n        };\r\n\r\n        markedRenderer.atLink = function(text) {\r\n\r\n            if (atLinkReg.test(text))\r\n            { \r\n                if (settings.atLink) \r\n                {\r\n                    text = text.replace(emailReg, function($1, $2, $3, $4) {\r\n                        return $1.replace(/@/g, \"_#_&#64;_#_\");\r\n                    });\r\n\r\n                    text = text.replace(atLinkReg, function($1, $2) {\r\n                        return \"<a href=\\\"\" + editormd.urls.atLinkBase + \"\" + $2 + \"\\\" title=\\\"&#64;\" + $2 + \"\\\" class=\\\"at-link\\\">\" + $1 + \"</a>\";\r\n                    }).replace(/_#_&#64;_#_/g, \"@\");\r\n                }\r\n                \r\n                if (settings.emailLink)\r\n                {\r\n                    text = text.replace(emailLinkReg, function($1, $2, $3, $4, $5) {\r\n                        return (!$2 && $.inArray($5, \"jpg|jpeg|png|gif|webp|ico|icon|pdf\".split(\"|\")) < 0) ? \"<a href=\\\"mailto:\" + $1 + \"\\\">\"+$1+\"</a>\" : $1;\r\n                    });\r\n                }\r\n\r\n                return text;\r\n            }\r\n\r\n            return text;\r\n        };\r\n                \r\n        markedRenderer.link = function (href, title, text) {\r\n\r\n            if (this.options.sanitize) {\r\n                try {\r\n                    var prot = decodeURIComponent(unescape(href)).replace(/[^\\w:]/g,\"\").toLowerCase();\r\n                } catch(e) {\r\n                    return \"\";\r\n                }\r\n\r\n                if (prot.indexOf(\"javascript:\") === 0) {\r\n                    return \"\";\r\n                }\r\n            }\r\n\r\n            var out = \"<a href=\\\"\" + href + \"\\\"\";\r\n            \r\n            if (atLinkReg.test(title) || atLinkReg.test(text))\r\n            {\r\n                if (title)\r\n                {\r\n                    out += \" title=\\\"\" + title.replace(/@/g, \"&#64;\");\r\n                }\r\n                \r\n                return out + \"\\\">\" + text.replace(/@/g, \"&#64;\") + \"</a>\";\r\n            }\r\n\r\n            if (title) {\r\n                out += \" title=\\\"\" + title + \"\\\"\";\r\n            }\r\n\r\n            out += \">\" + text + \"</a>\";\r\n\r\n            return out;\r\n        };\r\n        \r\n        markedRenderer.heading = function(text, level, raw) {\r\n                    \r\n            var linkText       = text;\r\n            var hasLinkReg     = /\\s*\\<a\\s*href\\=\\\"(.*)\\\"\\s*([^\\>]*)\\>(.*)\\<\\/a\\>\\s*/;\r\n            var getLinkTextReg = /\\s*\\<a\\s*([^\\>]+)\\>([^\\>]*)\\<\\/a\\>\\s*/g;\r\n\r\n            if (hasLinkReg.test(text)) \r\n            {\r\n                var tempText = [];\r\n                text         = text.split(/\\<a\\s*([^\\>]+)\\>([^\\>]*)\\<\\/a\\>/);\r\n\r\n                for (var i = 0, len = text.length; i < len; i++)\r\n                {\r\n                    tempText.push(text[i].replace(/\\s*href\\=\\\"(.*)\\\"\\s*/g, \"\"));\r\n                }\r\n\r\n                text = tempText.join(\" \");\r\n            }\r\n            \r\n            text = trim(text);\r\n            \r\n            var escapedText    = text.toLowerCase().replace(/[^\\w]+/g, \"-\");\r\n            var toc = {\r\n                text  : text,\r\n                level : level,\r\n                slug  : escapedText\r\n            };\r\n            \r\n            var isChinese = /^[\\u4e00-\\u9fa5]+$/.test(text);\r\n            var id        = (isChinese) ? escape(text).replace(/\\%/g, \"\") : text.toLowerCase().replace(/[^\\w]+/g, \"-\");\r\n\r\n            markdownToC.push(toc);\r\n            \r\n            var headingHTML = \"<h\" + level + \" id=\\\"h\"+ level + \"-\" + this.options.headerPrefix + id +\"\\\">\";\r\n            \r\n            headingHTML    += \"<a name=\\\"\" + text + \"\\\" class=\\\"reference-link\\\"></a>\";\r\n            headingHTML    += \"<span class=\\\"header-link octicon octicon-link\\\"></span>\";\r\n            headingHTML    += (hasLinkReg) ? this.atLink(this.emoji(linkText)) : this.atLink(this.emoji(text));\r\n            headingHTML    += \"</h\" + level + \">\";\r\n\r\n            return headingHTML;\r\n        };\r\n        \r\n        markedRenderer.pageBreak = function(text) {\r\n            if (pageBreakReg.test(text) && settings.pageBreak)\r\n            {\r\n                text = \"<hr style=\\\"page-break-after:always;\\\" class=\\\"page-break editormd-page-break\\\" />\";\r\n            }\r\n            \r\n            return text;\r\n        };\r\n\r\n        markedRenderer.paragraph = function(text) {\r\n            var isTeXInline     = /\\$\\$(.*)\\$\\$/g.test(text);\r\n            var isTeXLine       = /^\\$\\$(.*)\\$\\$$/.test(text);\r\n            var isTeXAddClass   = (isTeXLine)     ? \" class=\\\"\" + editormd.classNames.tex + \"\\\"\" : \"\";\r\n            var isToC           = (settings.tocm) ? /^(\\[TOC\\]|\\[TOCM\\])$/.test(text) : /^\\[TOC\\]$/.test(text);\r\n            var isToCMenu       = /^\\[TOCM\\]$/.test(text);\r\n            \r\n            if (!isTeXLine && isTeXInline) \r\n            {\r\n                text = text.replace(/(\\$\\$([^\\$]*)\\$\\$)+/g, function($1, $2) {\r\n                    return \"<span class=\\\"\" + editormd.classNames.tex + \"\\\">\" + $2.replace(/\\$/g, \"\") + \"</span>\";\r\n                });\r\n            } \r\n            else \r\n            {\r\n                text = (isTeXLine) ? text.replace(/\\$/g, \"\") : text;\r\n            }\r\n            \r\n            var tocHTML = \"<div class=\\\"markdown-toc editormd-markdown-toc\\\">\" + text + \"</div>\";\r\n            \r\n            return (isToC) ? ( (isToCMenu) ? \"<div class=\\\"editormd-toc-menu\\\">\" + tocHTML + \"</div><br/>\" : tocHTML )\r\n                           : ( (pageBreakReg.test(text)) ? this.pageBreak(text) : \"<p\" + isTeXAddClass + \">\" + this.atLink(this.emoji(text)) + \"</p>\\n\" );\r\n        };\r\n\r\n        markedRenderer.code = function (code, lang, escaped) { \r\n\r\n            if (lang === \"seq\" || lang === \"sequence\")\r\n            {\r\n                return \"<div class=\\\"sequence-diagram\\\">\" + code + \"</div>\";\r\n            } \r\n            else if ( lang === \"flow\")\r\n            {\r\n                return \"<div class=\\\"flowchart\\\">\" + code + \"</div>\";\r\n            } \r\n            else if ( lang === \"math\" || lang === \"latex\" || lang === \"katex\")\r\n            {\r\n                return \"<p class=\\\"\" + editormd.classNames.tex + \"\\\">\" + code + \"</p>\";\r\n            } \r\n            else \r\n            {\r\n\r\n                return marked.Renderer.prototype.code.apply(this, arguments);\r\n            }\r\n        };\r\n\r\n        markedRenderer.tablecell = function(content, flags) {\r\n            var type = (flags.header) ? \"th\" : \"td\";\r\n            var tag  = (flags.align)  ? \"<\" + type +\" style=\\\"text-align:\" + flags.align + \"\\\">\" : \"<\" + type + \">\";\r\n            \r\n            return tag + this.atLink(this.emoji(content)) + \"</\" + type + \">\\n\";\r\n        };\r\n\r\n        markedRenderer.listitem = function(text) {\r\n            if (settings.taskList && /^\\s*\\[[x\\s]\\]\\s*/.test(text)) \r\n            {\r\n                text = text.replace(/^\\s*\\[\\s\\]\\s*/, \"<input type=\\\"checkbox\\\" class=\\\"task-list-item-checkbox\\\" /> \")\r\n                           .replace(/^\\s*\\[x\\]\\s*/,  \"<input type=\\\"checkbox\\\" class=\\\"task-list-item-checkbox\\\" checked disabled /> \");\r\n\r\n                return \"<li style=\\\"list-style: none;\\\">\" + this.atLink(this.emoji(text)) + \"</li>\";\r\n            }\r\n            else \r\n            {\r\n                return \"<li>\" + this.atLink(this.emoji(text)) + \"</li>\";\r\n            }\r\n        };\r\n        \r\n        return markedRenderer;\r\n    };\r\n    \r\n    /**\r\n     *\r\n     * 生成TOC(Table of Contents)\r\n     * Creating ToC (Table of Contents)\r\n     * \r\n     * @param   {Array}    toc             从marked获取的TOC数组列表\r\n     * @param   {Element}  container       插入TOC的容器元素\r\n     * @param   {Integer}  startLevel      Hx 起始层级\r\n     * @returns {Object}   tocContainer    返回ToC列表容器层的jQuery对象元素\r\n     */\r\n    \r\n    editormd.markdownToCRenderer = function(toc, container, tocDropdown, startLevel) {\r\n        \r\n        var html        = \"\";    \r\n        var lastLevel   = 0;\r\n        var classPrefix = this.classPrefix;\r\n        \r\n        startLevel      = startLevel  || 1;\r\n        \r\n        for (var i = 0, len = toc.length; i < len; i++) \r\n        {\r\n            var text  = toc[i].text;\r\n            var level = toc[i].level;\r\n            \r\n            if (level < startLevel) {\r\n                continue;\r\n            }\r\n            \r\n            if (level > lastLevel) \r\n            {\r\n                html += \"\";\r\n            }\r\n            else if (level < lastLevel) \r\n            {\r\n                html += (new Array(lastLevel - level + 2)).join(\"</ul></li>\");\r\n            } \r\n            else \r\n            {\r\n                html += \"</ul></li>\";\r\n            }\r\n\r\n            html += \"<li><a class=\\\"toc-level-\" + level + \"\\\" href=\\\"#\" + text + \"\\\" level=\\\"\" + level + \"\\\">\" + text + \"</a><ul>\";\r\n            lastLevel = level;\r\n        }\r\n        \r\n        var tocContainer = container.find(\".markdown-toc\");\r\n        \r\n        if ((tocContainer.length < 1 && container.attr(\"previewContainer\") === \"false\"))\r\n        {\r\n            var tocHTML = \"<div class=\\\"markdown-toc \" + classPrefix + \"markdown-toc\\\"></div>\";\r\n            \r\n            tocHTML = (tocDropdown) ? \"<div class=\\\"\" + classPrefix + \"toc-menu\\\">\" + tocHTML + \"</div>\" : tocHTML;\r\n            \r\n            container.html(tocHTML);\r\n            \r\n            tocContainer = container.find(\".markdown-toc\");\r\n        }\r\n        \r\n        if (tocDropdown)\r\n        {\r\n            tocContainer.wrap(\"<div class=\\\"\" + classPrefix + \"toc-menu\\\"></div><br/>\");\r\n        }\r\n        \r\n        tocContainer.html(\"<ul class=\\\"markdown-toc-list\\\"></ul>\").children(\".markdown-toc-list\").html(html.replace(/\\r?\\n?\\<ul\\>\\<\\/ul\\>/g, \"\"));\r\n        \r\n        return tocContainer;\r\n    };\r\n    \r\n    /**\r\n     *\r\n     * 生成TOC下拉菜单\r\n     * Creating ToC dropdown menu\r\n     * \r\n     * @param   {Object}   container       插入TOC的容器jQuery对象元素\r\n     * @param   {String}   tocTitle        ToC title\r\n     * @returns {Object}                   return toc-menu object\r\n     */\r\n    \r\n    editormd.tocDropdownMenu = function(container, tocTitle) {\r\n        \r\n        tocTitle      = tocTitle || \"Table of Contents\";\r\n        \r\n        var zindex    = 400;\r\n        var tocMenus  = container.find(\".\" + this.classPrefix + \"toc-menu\");\r\n\r\n        tocMenus.each(function() {\r\n            var $this  = $(this);\r\n            var toc    = $this.children(\".markdown-toc\");\r\n            var icon   = \"<i class=\\\"fa fa-angle-down\\\"></i>\";\r\n            var btn    = \"<a href=\\\"javascript:;\\\" class=\\\"toc-menu-btn\\\">\" + icon + tocTitle + \"</a>\";\r\n            var menu   = toc.children(\"ul\");            \r\n            var list   = menu.find(\"li\");\r\n            \r\n            toc.append(btn);\r\n            \r\n            list.first().before(\"<li><h1>\" + tocTitle + \" \" + icon + \"</h1></li>\");\r\n            \r\n            $this.mouseover(function(){\r\n                menu.show();\r\n\r\n                list.each(function(){\r\n                    var li = $(this);\r\n                    var ul = li.children(\"ul\");\r\n\r\n                    if (ul.html() === \"\")\r\n                    {\r\n                        ul.remove();\r\n                    }\r\n\r\n                    if (ul.length > 0 && ul.html() !== \"\")\r\n                    {\r\n                        var firstA = li.children(\"a\").first();\r\n\r\n                        if (firstA.children(\".fa\").length < 1)\r\n                        {\r\n                            firstA.append( $(icon).css({ float:\"right\", paddingTop:\"4px\" }) );\r\n                        }\r\n                    }\r\n\r\n                    li.mouseover(function(){\r\n                        ul.css(\"z-index\", zindex).show();\r\n                        zindex += 1;\r\n                    }).mouseleave(function(){\r\n                        ul.hide();\r\n                    });\r\n                });\r\n            }).mouseleave(function(){\r\n                menu.hide();\r\n            }); \r\n        });       \r\n        \r\n        return tocMenus;\r\n    };\r\n    \r\n    /**\r\n     * 简单地过滤指定的HTML标签\r\n     * Filter custom html tags\r\n     * \r\n     * @param   {String}   html          要过滤HTML\r\n     * @param   {String}   filters       要过滤的标签\r\n     * @returns {String}   html          返回过滤的HTML\r\n     */\r\n    \r\n    editormd.filterHTMLTags = function(html, filters) {\r\n        \r\n        if (typeof html !== \"string\") {\r\n            html = new String(html);\r\n        }\r\n            \r\n        if (typeof filters !== \"string\") {\r\n            return html;\r\n        }\r\n\r\n        var expression = filters.split(\"|\");\r\n        var filterTags = expression[0].split(\",\");\r\n        var attrs      = expression[1];\r\n\r\n        for (var i = 0, len = filterTags.length; i < len; i++)\r\n        {\r\n            var tag = filterTags[i];\r\n\r\n            html = html.replace(new RegExp(\"\\<\\s*\" + tag + \"\\s*([^\\>]*)\\>([^\\>]*)\\<\\s*\\/\" + tag + \"\\s*\\>\", \"igm\"), \"\");\r\n        }\r\n        \r\n        //return html;\r\n\r\n        if (typeof attrs !== \"undefined\")\r\n        {\r\n            var htmlTagRegex = /\\<(\\w+)\\s*([^\\>]*)\\>([^\\>]*)\\<\\/(\\w+)\\>/ig;\r\n\r\n            if (attrs === \"*\")\r\n            {\r\n                html = html.replace(htmlTagRegex, function($1, $2, $3, $4, $5) {\r\n                    return \"<\" + $2 + \">\" + $4 + \"</\" + $5 + \">\";\r\n                });         \r\n            }\r\n            else if (attrs === \"on*\")\r\n            {\r\n                html = html.replace(htmlTagRegex, function($1, $2, $3, $4, $5) {\r\n                    var el = $(\"<\" + $2 + \">\" + $4 + \"</\" + $5 + \">\");\r\n                    var _attrs = $($1)[0].attributes;\r\n                    var $attrs = {};\r\n                    \r\n                    $.each(_attrs, function(i, e) {\r\n                        if (e.nodeName !== '\"') $attrs[e.nodeName] = e.nodeValue;\r\n                    });\r\n                    \r\n                    $.each($attrs, function(i) {                        \r\n                        if (i.indexOf(\"on\") === 0) {\r\n                            delete $attrs[i];\r\n                        }\r\n                    });\r\n                    \r\n                    el.attr($attrs);\r\n                    \r\n                    var text = (typeof el[1] !== \"undefined\") ? $(el[1]).text() : \"\";\r\n\r\n                    return el[0].outerHTML + text;\r\n                });\r\n            }\r\n            else\r\n            {\r\n                html = html.replace(htmlTagRegex, function($1, $2, $3, $4) {\r\n                    var filterAttrs = attrs.split(\",\");\r\n                    var el = $($1);\r\n                    el.html($4);\r\n\r\n                    $.each(filterAttrs, function(i) {\r\n                        el.attr(filterAttrs[i], null);\r\n                    });\r\n\r\n                    return el[0].outerHTML;\r\n                });\r\n            }\r\n        }\r\n        \r\n        return html;\r\n    };\r\n    \r\n    /**\r\n     * 将Markdown文档解析为HTML用于前台显示\r\n     * Parse Markdown to HTML for Font-end preview.\r\n     * \r\n     * @param   {String}   id            用于显示HTML的对象ID\r\n     * @param   {Object}   [options={}]  配置选项，可选\r\n     * @returns {Object}   div           返回jQuery对象元素\r\n     */\r\n    \r\n    editormd.markdownToHTML = function(id, options) {\r\n        var defaults = {\r\n            gfm                  : true,\r\n            toc                  : true,\r\n            tocm                 : false,\r\n            tocStartLevel        : 1,\r\n            tocTitle             : \"目录\",\r\n            tocDropdown          : false,\r\n            tocContainer         : \"\",\r\n            markdown             : \"\",\r\n            markdownSourceCode   : false,\r\n            htmlDecode           : false,\r\n            autoLoadKaTeX        : true,\r\n            pageBreak            : true,\r\n            atLink               : true,    // for @link\r\n            emailLink            : true,    // for mail address auto link\r\n            tex                  : false,\r\n            taskList             : false,   // Github Flavored Markdown task lists\r\n            emoji                : false,\r\n            flowChart            : false,\r\n            sequenceDiagram      : false,\r\n            previewCodeHighlight : true\r\n        };\r\n        \r\n        editormd.$marked  = marked;\r\n\r\n        var div           = $(\"#\" + id);\r\n        var settings      = div.settings = $.extend(true, defaults, options || {});\r\n        var saveTo        = div.find(\"textarea\");\r\n        \r\n        if (saveTo.length < 1)\r\n        {\r\n            div.append(\"<textarea></textarea>\");\r\n            saveTo        = div.find(\"textarea\");\r\n        }        \r\n        \r\n        var markdownDoc   = (settings.markdown === \"\") ? saveTo.val() : settings.markdown; \r\n        var markdownToC   = [];\r\n\r\n        var rendererOptions = {  \r\n            toc                  : settings.toc,\r\n            tocm                 : settings.tocm,\r\n            tocStartLevel        : settings.tocStartLevel,\r\n            taskList             : settings.taskList,\r\n            emoji                : settings.emoji,\r\n            tex                  : settings.tex,\r\n            pageBreak            : settings.pageBreak,\r\n            atLink               : settings.atLink,           // for @link\r\n            emailLink            : settings.emailLink,        // for mail address auto link\r\n            flowChart            : settings.flowChart,\r\n            sequenceDiagram      : settings.sequenceDiagram,\r\n            previewCodeHighlight : settings.previewCodeHighlight,\r\n        };\r\n\r\n        var markedOptions = {\r\n            renderer    : editormd.markedRenderer(markdownToC, rendererOptions),\r\n            gfm         : settings.gfm,\r\n            tables      : true,\r\n            breaks      : true,\r\n            pedantic    : false,\r\n            sanitize    : (settings.htmlDecode) ? false : true, // 是否忽略HTML标签，即是否开启HTML标签解析，为了安全性，默认不开启\r\n            smartLists  : true,\r\n            smartypants : true\r\n        };\r\n        \r\n\t\tmarkdownDoc = new String(markdownDoc);\r\n        \r\n        var markdownParsed = marked(markdownDoc, markedOptions);\r\n        \r\n        markdownParsed = editormd.filterHTMLTags(markdownParsed, settings.htmlDecode);\r\n        \r\n        if (settings.markdownSourceCode) {\r\n            saveTo.text(markdownDoc);\r\n        } else {\r\n            saveTo.remove();\r\n        }\r\n        \r\n        div.addClass(\"markdown-body \" + this.classPrefix + \"html-preview\").append(markdownParsed);\r\n        \r\n        var tocContainer = (settings.tocContainer !== \"\") ? $(settings.tocContainer) : div;\r\n        \r\n        if (settings.tocContainer !== \"\")\r\n        {\r\n            tocContainer.attr(\"previewContainer\", false);\r\n        }\r\n         \r\n        if (settings.toc) \r\n        {\r\n            div.tocContainer = this.markdownToCRenderer(markdownToC, tocContainer, settings.tocDropdown, settings.tocStartLevel);\r\n            \r\n            if (settings.tocDropdown || div.find(\".\" + this.classPrefix + \"toc-menu\").length > 0)\r\n            {\r\n                this.tocDropdownMenu(div, settings.tocTitle);\r\n            }\r\n            \r\n            if (settings.tocContainer !== \"\")\r\n            {\r\n                div.find(\".editormd-toc-menu, .editormd-markdown-toc\").remove();\r\n            }\r\n        }\r\n            \r\n        if (settings.previewCodeHighlight) \r\n        {\r\n            div.find(\"pre\").addClass(\"prettyprint linenums\");\r\n            prettyPrint();\r\n        }\r\n        \r\n        if (!editormd.isIE8) \r\n        {\r\n            if (settings.flowChart) {\r\n                div.find(\".flowchart\").flowChart(); \r\n            }\r\n\r\n            if (settings.sequenceDiagram) {\r\n                div.find(\".sequence-diagram\").sequenceDiagram({theme: \"simple\"});\r\n            }\r\n        }\r\n\r\n        if (settings.tex)\r\n        {\r\n            var katexHandle = function() {\r\n                div.find(\".\" + editormd.classNames.tex).each(function(){\r\n                    var tex  = $(this);                    \r\n                    katex.render(tex.html().replace(/&lt;/g, \"<\").replace(/&gt;/g, \">\"), tex[0]);                    \r\n                    tex.find(\".katex\").css(\"font-size\", \"1.6em\");\r\n                });\r\n            };\r\n            \r\n            if (settings.autoLoadKaTeX && !editormd.$katex && !editormd.kaTeXLoaded)\r\n            {\r\n                this.loadKaTeX(function() {\r\n                    editormd.$katex      = katex;\r\n                    editormd.kaTeXLoaded = true;\r\n                    katexHandle();\r\n                });\r\n            }\r\n            else\r\n            {\r\n                katexHandle();\r\n            }\r\n        }\r\n        \r\n        div.getMarkdown = function() {            \r\n            return saveTo.val();\r\n        };\r\n        \r\n        return div;\r\n    };\r\n    \r\n    // Editor.md themes, change toolbar themes etc.\r\n    // added @1.5.0\r\n    editormd.themes        = [\"default\", \"dark\"];\r\n    \r\n    // Preview area themes\r\n    // added @1.5.0\r\n    editormd.previewThemes = [\"default\", \"dark\"];\r\n    \r\n    // CodeMirror / editor area themes\r\n    // @1.5.0 rename -> editorThemes, old version -> themes\r\n    editormd.editorThemes = [\r\n        \"default\", \"3024-day\", \"3024-night\",\r\n        \"ambiance\", \"ambiance-mobile\",\r\n        \"base16-dark\", \"base16-light\", \"blackboard\",\r\n        \"cobalt\",\r\n        \"eclipse\", \"elegant\", \"erlang-dark\",\r\n        \"lesser-dark\",\r\n        \"mbo\", \"mdn-like\", \"midnight\", \"monokai\",\r\n        \"neat\", \"neo\", \"night\",\r\n        \"paraiso-dark\", \"paraiso-light\", \"pastel-on-dark\",\r\n        \"rubyblue\",\r\n        \"solarized\",\r\n        \"the-matrix\", \"tomorrow-night-eighties\", \"twilight\",\r\n        \"vibrant-ink\",\r\n        \"xq-dark\", \"xq-light\"\r\n    ];\r\n\r\n    editormd.loadPlugins = {};\r\n    \r\n    editormd.loadFiles = {\r\n        js     : [],\r\n        css    : [],\r\n        plugin : []\r\n    };\r\n    \r\n    /**\r\n     * 动态加载Editor.md插件，但不立即执行\r\n     * Load editor.md plugins\r\n     * \r\n     * @param {String}   fileName              插件文件路径\r\n     * @param {Function} [callback=function()] 加载成功后执行的回调函数\r\n     * @param {String}   [into=\"head\"]         嵌入页面的位置\r\n     */\r\n    \r\n    editormd.loadPlugin = function(fileName, callback, into) {\r\n        callback   = callback || function() {};\r\n        \r\n        this.loadScript(fileName, function() {\r\n            editormd.loadFiles.plugin.push(fileName);\r\n            callback();\r\n        }, into);\r\n    };\r\n    \r\n    /**\r\n     * 动态加载CSS文件的方法\r\n     * Load css file method\r\n     * \r\n     * @param {String}   fileName              CSS文件名\r\n     * @param {Function} [callback=function()] 加载成功后执行的回调函数\r\n     * @param {String}   [into=\"head\"]         嵌入页面的位置\r\n     */\r\n    \r\n    editormd.loadCSS   = function(fileName, callback, into) {\r\n        into       = into     || \"head\";        \r\n        callback   = callback || function() {};\r\n        \r\n        var css    = document.createElement(\"link\");\r\n        css.type   = \"text/css\";\r\n        css.rel    = \"stylesheet\";\r\n        css.onload = css.onreadystatechange = function() {\r\n            editormd.loadFiles.css.push(fileName);\r\n            callback();\r\n        };\r\n\r\n        css.href   = fileName + \".css\";\r\n\r\n        if(into === \"head\") {\r\n            document.getElementsByTagName(\"head\")[0].appendChild(css);\r\n        } else {\r\n            document.body.appendChild(css);\r\n        }\r\n    };\r\n    \r\n    editormd.isIE    = (navigator.appName == \"Microsoft Internet Explorer\");\r\n    editormd.isIE8   = (editormd.isIE && navigator.appVersion.match(/8./i) == \"8.\");\r\n\r\n    /**\r\n     * 动态加载JS文件的方法\r\n     * Load javascript file method\r\n     * \r\n     * @param {String}   fileName              JS文件名\r\n     * @param {Function} [callback=function()] 加载成功后执行的回调函数\r\n     * @param {String}   [into=\"head\"]         嵌入页面的位置\r\n     */\r\n\r\n    editormd.loadScript = function(fileName, callback, into) {\r\n        \r\n        into          = into     || \"head\";\r\n        callback      = callback || function() {};\r\n        \r\n        var script    = null; \r\n        script        = document.createElement(\"script\");\r\n        script.id     = fileName.replace(/[\\./]+/g, \"-\");\r\n        script.type   = \"text/javascript\";        \r\n        script.src    = fileName + \".js\";\r\n        \r\n        if (editormd.isIE8) \r\n        {            \r\n            script.onreadystatechange = function() {\r\n                if(script.readyState) \r\n                {\r\n                    if (script.readyState === \"loaded\" || script.readyState === \"complete\") \r\n                    {\r\n                        script.onreadystatechange = null; \r\n                        editormd.loadFiles.js.push(fileName);\r\n                        callback();\r\n                    }\r\n                } \r\n            };\r\n        }\r\n        else\r\n        {\r\n            script.onload = function() {\r\n                editormd.loadFiles.js.push(fileName);\r\n                callback();\r\n            };\r\n        }\r\n\r\n        if (into === \"head\") {\r\n            document.getElementsByTagName(\"head\")[0].appendChild(script);\r\n        } else {\r\n            document.body.appendChild(script);\r\n        }\r\n    };\r\n    \r\n    // 使用国外的CDN，加载速度有时会很慢，或者自定义URL\r\n    // You can custom KaTeX load url.\r\n    editormd.katexURL  = {\r\n        css : \"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min\",\r\n        js  : \"//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.3.0/katex.min\"\r\n    };\r\n    \r\n    editormd.kaTeXLoaded = false;\r\n    \r\n    /**\r\n     * 加载KaTeX文件\r\n     * load KaTeX files\r\n     * \r\n     * @param {Function} [callback=function()]  加载成功后执行的回调函数\r\n     */\r\n    \r\n    editormd.loadKaTeX = function (callback) {\r\n        editormd.loadCSS(editormd.katexURL.css, function(){\r\n            editormd.loadScript(editormd.katexURL.js, callback || function(){});\r\n        });\r\n    };\r\n        \r\n    /**\r\n     * 锁屏\r\n     * lock screen\r\n     * \r\n     * @param   {Boolean}   lock   Boolean 布尔值，是否锁屏\r\n     * @returns {void}\r\n     */\r\n    \r\n    editormd.lockScreen = function(lock) {\r\n        $(\"html,body\").css(\"overflow\", (lock) ? \"hidden\" : \"\");\r\n    };\r\n        \r\n    /**\r\n     * 动态创建对话框\r\n     * Creating custom dialogs\r\n     * \r\n     * @param   {Object} options 配置项键值对 Key/Value\r\n     * @returns {dialog} 返回创建的dialog的jQuery实例对象\r\n     */\r\n\r\n    editormd.createDialog = function(options) {\r\n        var defaults = {\r\n            name : \"\",\r\n            width : 420,\r\n            height: 240,\r\n            title : \"\",\r\n            drag  : true,\r\n            closed : true,\r\n            content : \"\",\r\n            mask : true,\r\n            maskStyle : {\r\n                backgroundColor : \"#fff\",\r\n                opacity : 0.1\r\n            },\r\n            lockScreen : true,\r\n            footer : true,\r\n            buttons : false\r\n        };\r\n\r\n        options          = $.extend(true, defaults, options);\r\n        \r\n        var $this        = this;\r\n        var editor       = this.editor;\r\n        var classPrefix  = editormd.classPrefix;\r\n        var guid         = (new Date()).getTime();\r\n        var dialogName   = ( (options.name === \"\") ? classPrefix + \"dialog-\" + guid : options.name);\r\n        var mouseOrTouch = editormd.mouseOrTouch;\r\n\r\n        var html         = \"<div class=\\\"\" + classPrefix + \"dialog \" + dialogName + \"\\\">\";\r\n\r\n        if (options.title !== \"\")\r\n        {\r\n            html += \"<div class=\\\"\" + classPrefix + \"dialog-header\\\"\" + ( (options.drag) ? \" style=\\\"cursor: move;\\\"\" : \"\" ) + \">\";\r\n            html += \"<strong class=\\\"\" + classPrefix + \"dialog-title\\\">\" + options.title + \"</strong>\";\r\n            html += \"</div>\";\r\n        }\r\n\r\n        if (options.closed)\r\n        {\r\n            html += \"<a href=\\\"javascript:;\\\" class=\\\"fa fa-close \" + classPrefix + \"dialog-close\\\"></a>\";\r\n        }\r\n\r\n        html += \"<div class=\\\"\" + classPrefix + \"dialog-container\\\">\" + options.content;                    \r\n\r\n        if (options.footer || typeof options.footer === \"string\") \r\n        {\r\n            html += \"<div class=\\\"\" + classPrefix + \"dialog-footer\\\">\" + ( (typeof options.footer === \"boolean\") ? \"\" : options.footer) + \"</div>\";\r\n        }\r\n\r\n        html += \"</div>\";\r\n\r\n        html += \"<div class=\\\"\" + classPrefix + \"dialog-mask \" + classPrefix + \"dialog-mask-bg\\\"></div>\";\r\n        html += \"<div class=\\\"\" + classPrefix + \"dialog-mask \" + classPrefix + \"dialog-mask-con\\\"></div>\";\r\n        html += \"</div>\";\r\n\r\n        editor.append(html);\r\n\r\n        var dialog = editor.find(\".\" + dialogName);\r\n\r\n        dialog.lockScreen = function(lock) {\r\n            if (options.lockScreen)\r\n            {                \r\n                $(\"html,body\").css(\"overflow\", (lock) ? \"hidden\" : \"\");\r\n                $this.resize();\r\n            }\r\n\r\n            return dialog;\r\n        };\r\n\r\n        dialog.showMask = function() {\r\n            if (options.mask)\r\n            {\r\n                editor.find(\".\" + classPrefix + \"mask\").css(options.maskStyle).css(\"z-index\", editormd.dialogZindex - 1).show();\r\n            }\r\n            return dialog;\r\n        };\r\n\r\n        dialog.hideMask = function() {\r\n            if (options.mask)\r\n            {\r\n                editor.find(\".\" + classPrefix + \"mask\").hide();\r\n            }\r\n\r\n            return dialog;\r\n        };\r\n\r\n        dialog.loading = function(show) {                        \r\n            var loading = dialog.find(\".\" + classPrefix + \"dialog-mask\");\r\n            loading[(show) ? \"show\" : \"hide\"]();\r\n\r\n            return dialog;\r\n        };\r\n\r\n        dialog.lockScreen(true).showMask();\r\n\r\n        dialog.show().css({\r\n            zIndex : editormd.dialogZindex,\r\n            border : (editormd.isIE8) ? \"1px solid #ddd\" : \"\",\r\n            width  : (typeof options.width  === \"number\") ? options.width + \"px\"  : options.width,\r\n            height : (typeof options.height === \"number\") ? options.height + \"px\" : options.height\r\n        });\r\n\r\n        var dialogPosition = function(){\r\n            dialog.css({\r\n                top    : ($(window).height() - dialog.height()) / 2 + \"px\",\r\n                left   : ($(window).width() - dialog.width()) / 2 + \"px\"\r\n            });\r\n        };\r\n\r\n        dialogPosition();\r\n\r\n        $(window).resize(dialogPosition);\r\n\r\n        dialog.children(\".\" + classPrefix + \"dialog-close\").bind(mouseOrTouch(\"click\", \"touchend\"), function() {\r\n            dialog.hide().lockScreen(false).hideMask();\r\n        });\r\n\r\n        if (typeof options.buttons === \"object\")\r\n        {\r\n            var footer = dialog.footer = dialog.find(\".\" + classPrefix + \"dialog-footer\");\r\n\r\n            for (var key in options.buttons)\r\n            {\r\n                var btn = options.buttons[key];\r\n                var btnClassName = classPrefix + key + \"-btn\";\r\n\r\n                footer.append(\"<button class=\\\"\" + classPrefix + \"btn \" + btnClassName + \"\\\">\" + btn[0] + \"</button>\");\r\n                btn[1] = $.proxy(btn[1], dialog);\r\n                footer.children(\".\" + btnClassName).bind(mouseOrTouch(\"click\", \"touchend\"), btn[1]);\r\n            }\r\n        }\r\n\r\n        if (options.title !== \"\" && options.drag)\r\n        {                        \r\n            var posX, posY;\r\n            var dialogHeader = dialog.children(\".\" + classPrefix + \"dialog-header\");\r\n\r\n            if (!options.mask) {\r\n                dialogHeader.bind(mouseOrTouch(\"click\", \"touchend\"), function(){\r\n                    editormd.dialogZindex += 2;\r\n                    dialog.css(\"z-index\", editormd.dialogZindex);\r\n                });\r\n            }\r\n\r\n            dialogHeader.mousedown(function(e) {\r\n                e = e || window.event;  //IE\r\n                posX = e.clientX - parseInt(dialog[0].style.left);\r\n                posY = e.clientY - parseInt(dialog[0].style.top);\r\n\r\n                document.onmousemove = moveAction;                   \r\n            });\r\n\r\n            var userCanSelect = function (obj) {\r\n                obj.removeClass(classPrefix + \"user-unselect\").off(\"selectstart\");\r\n            };\r\n\r\n            var userUnselect = function (obj) {\r\n                obj.addClass(classPrefix + \"user-unselect\").on(\"selectstart\", function(event) { // selectstart for IE                        \r\n                    return false;\r\n                });\r\n            };\r\n\r\n            var moveAction = function (e) {\r\n                e = e || window.event;  //IE\r\n\r\n                var left, top, nowLeft = parseInt(dialog[0].style.left), nowTop = parseInt(dialog[0].style.top);\r\n\r\n                if( nowLeft >= 0 ) {\r\n                    if( nowLeft + dialog.width() <= $(window).width()) {\r\n                        left = e.clientX - posX;\r\n                    } else {\t\r\n                        left = $(window).width() - dialog.width();\r\n                        document.onmousemove = null;\r\n                    }\r\n                } else {\r\n                    left = 0;\r\n                    document.onmousemove = null;\r\n                }\r\n\r\n                if( nowTop >= 0 ) {\r\n                    top = e.clientY - posY;\r\n                } else {\r\n                    top = 0;\r\n                    document.onmousemove = null;\r\n                }\r\n\r\n\r\n                document.onselectstart = function() {\r\n                    return false;\r\n                };\r\n\r\n                userUnselect($(\"body\"));\r\n                userUnselect(dialog);\r\n                dialog[0].style.left = left + \"px\";\r\n                dialog[0].style.top  = top + \"px\";\r\n            };\r\n\r\n            document.onmouseup = function() {                            \r\n                userCanSelect($(\"body\"));\r\n                userCanSelect(dialog);\r\n\r\n                document.onselectstart = null;         \r\n                document.onmousemove = null;\r\n            };\r\n\r\n            dialogHeader.touchDraggable = function() {\r\n                var offset = null;\r\n                var start  = function(e) {\r\n                    var orig = e.originalEvent; \r\n                    var pos  = $(this).parent().position();\r\n\r\n                    offset = {\r\n                        x : orig.changedTouches[0].pageX - pos.left,\r\n                        y : orig.changedTouches[0].pageY - pos.top\r\n                    };\r\n                };\r\n\r\n                var move = function(e) {\r\n                    e.preventDefault();\r\n                    var orig = e.originalEvent;\r\n\r\n                    $(this).parent().css({\r\n                        top  : orig.changedTouches[0].pageY - offset.y,\r\n                        left : orig.changedTouches[0].pageX - offset.x\r\n                    });\r\n                };\r\n\r\n                this.bind(\"touchstart\", start).bind(\"touchmove\", move);\r\n            };\r\n\r\n            dialogHeader.touchDraggable();\r\n        }\r\n\r\n        editormd.dialogZindex += 2;\r\n\r\n        return dialog;\r\n    };\r\n    \r\n    /**\r\n     * 鼠标和触摸事件的判断/选择方法\r\n     * MouseEvent or TouchEvent type switch\r\n     * \r\n     * @param   {String} [mouseEventType=\"click\"]    供选择的鼠标事件\r\n     * @param   {String} [touchEventType=\"touchend\"] 供选择的触摸事件\r\n     * @returns {String} EventType                   返回事件类型名称\r\n     */\r\n    \r\n    editormd.mouseOrTouch = function(mouseEventType, touchEventType) {\r\n        mouseEventType = mouseEventType || \"click\";\r\n        touchEventType = touchEventType || \"touchend\";\r\n        \r\n        var eventType  = mouseEventType;\r\n\r\n        try {\r\n            document.createEvent(\"TouchEvent\");\r\n            eventType = touchEventType;\r\n        } catch(e) {}\r\n\r\n        return eventType;\r\n    };\r\n    \r\n    /**\r\n     * 日期时间的格式化方法\r\n     * Datetime format method\r\n     * \r\n     * @param   {String}   [format=\"\"]  日期时间的格式，类似PHP的格式\r\n     * @returns {String}   datefmt      返回格式化后的日期时间字符串\r\n     */\r\n    \r\n    editormd.dateFormat = function(format) {                \r\n        format      = format || \"\";\r\n\r\n        var addZero = function(d) {\r\n            return (d < 10) ? \"0\" + d : d;\r\n        };\r\n\r\n        var date    = new Date(); \r\n        var year    = date.getFullYear();\r\n        var year2   = year.toString().slice(2, 4);\r\n        var month   = addZero(date.getMonth() + 1);\r\n        var day     = addZero(date.getDate());\r\n        var weekDay = date.getDay();\r\n        var hour    = addZero(date.getHours());\r\n        var min     = addZero(date.getMinutes());\r\n        var second  = addZero(date.getSeconds());\r\n        var ms      = addZero(date.getMilliseconds()); \r\n        var datefmt = \"\";\r\n\r\n        var ymd     = year2 + \"-\" + month + \"-\" + day;\r\n        var fymd    = year  + \"-\" + month + \"-\" + day;\r\n        var hms     = hour  + \":\" + min   + \":\" + second;\r\n\r\n        switch (format) \r\n        {\r\n            case \"UNIX Time\" :\r\n                    datefmt = date.getTime();\r\n                break;\r\n\r\n            case \"UTC\" :\r\n                    datefmt = date.toUTCString();\r\n                break;\t\r\n\r\n            case \"yy\" :\r\n                    datefmt = year2;\r\n                break;\t\r\n\r\n            case \"year\" :\r\n            case \"yyyy\" :\r\n                    datefmt = year;\r\n                break;\r\n\r\n            case \"month\" :\r\n            case \"mm\" :\r\n                    datefmt = month;\r\n                break;                        \r\n\r\n            case \"cn-week-day\" :\r\n            case \"cn-wd\" :\r\n                    var cnWeekDays = [\"日\", \"一\", \"二\", \"三\", \"四\", \"五\", \"六\"];\r\n                    datefmt = \"星期\" + cnWeekDays[weekDay];\r\n                break;\r\n\r\n            case \"week-day\" :\r\n            case \"wd\" :\r\n                    var weekDays = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\r\n                    datefmt = weekDays[weekDay];\r\n                break;\r\n\r\n            case \"day\" :\r\n            case \"dd\" :\r\n                    datefmt = day;\r\n                break;\r\n\r\n            case \"hour\" :\r\n            case \"hh\" :\r\n                    datefmt = hour;\r\n                break;\r\n\r\n            case \"min\" :\r\n            case \"ii\" :\r\n                    datefmt = min;\r\n                break;\r\n\r\n            case \"second\" :\r\n            case \"ss\" :\r\n                    datefmt = second;\r\n                break;\r\n\r\n            case \"ms\" :\r\n                    datefmt = ms;\r\n                break;\r\n\r\n            case \"yy-mm-dd\" :\r\n                    datefmt = ymd;\r\n                break;\r\n\r\n            case \"yyyy-mm-dd\" :\r\n                    datefmt = fymd;\r\n                break;\r\n\r\n            case \"yyyy-mm-dd h:i:s ms\" :\r\n            case \"full + ms\" : \r\n                    datefmt = fymd + \" \" + hms + \" \" + ms;\r\n                break;\r\n\r\n            case \"full\" :\r\n            case \"yyyy-mm-dd h:i:s\" :\r\n                default:\r\n                    datefmt = fymd + \" \" + hms;\r\n                break;\r\n        }\r\n\r\n        return datefmt;\r\n    };\r\n\r\n    return editormd;\r\n\r\n}));\r\n"]}