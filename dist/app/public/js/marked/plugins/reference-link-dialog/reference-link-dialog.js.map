{"version":3,"sources":["../../../../../../../app/public/js/marked/plugins/reference-link-dialog/reference-link-dialog.js"],"names":["factory","exports","pluginName","ReLinkId","fn","referenceLinkDialog","_this","cm","lang","editor","settings","cursor","getCursor","selection","getSelection","dialogLang","dialog","referenceLink","classPrefix","dialogName","focus","find","length","dialogHTML","name","urlId","url","urlTitle","createDialog","title","width","height","content","mask","dialogShowMask","drag","dialogDraggable","lockScreen","dialogLockScreen","maskStyle","opacity","dialogMaskOpacity","backgroundColor","dialogMaskBgColor","buttons","enter","val","rid","alert","nameEmpty","idEmpty","urlEmpty","replaceSelection","setCursor","line","ch","setValue","getValue","hide","hideMask","cancel","show","require","module","define","amd","editormd","window"],"mappings":"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","file":"reference-link-dialog.js","sourcesContent":["/*!\r\n * Reference link dialog plugin for Editor.md\r\n *\r\n * @file        reference-link-dialog.js\r\n * @author      pandao\r\n * @version     1.2.1\r\n * @updateTime  2015-06-09\r\n * {@link       https://github.com/pandao/editor.md}\r\n * @license     MIT\r\n */\r\n\r\n(function() {\r\n\r\n    var factory = function (exports) {\r\n\r\n\t\tvar pluginName   = \"reference-link-dialog\";\r\n\t\tvar ReLinkId     = 1;\r\n\r\n\t\texports.fn.referenceLinkDialog = function() {\r\n\r\n            var _this       = this;\r\n            var cm          = this.cm;\r\n            var lang        = this.lang;\r\n\t\t\tvar editor      = this.editor;\r\n            var settings    = this.settings;\r\n            var cursor      = cm.getCursor();\r\n            var selection   = cm.getSelection();\r\n            var dialogLang  = lang.dialog.referenceLink;\r\n            var classPrefix = this.classPrefix;\r\n\t\t\tvar dialogName  = classPrefix + pluginName, dialog;\r\n\r\n\t\t\tcm.focus();\r\n\r\n            if (editor.find(\".\" + dialogName).length < 1)\r\n            {      \r\n                var dialogHTML = \"<div class=\\\"\" + classPrefix + \"form\\\">\" +\r\n                                        \"<label>\" + dialogLang.name + \"</label>\" +\r\n                                        \"<input type=\\\"text\\\" value=\\\"[\" + ReLinkId + \"]\\\" data-name />\" +  \r\n                                        \"<br/>\" +\r\n                                        \"<label>\" + dialogLang.urlId + \"</label>\" +\r\n                                        \"<input type=\\\"text\\\" data-url-id />\" +\r\n                                        \"<br/>\" +\r\n                                        \"<label>\" + dialogLang.url + \"</label>\" +\r\n                                        \"<input type=\\\"text\\\" value=\\\"http://\\\" data-url />\" + \r\n                                        \"<br/>\" +\r\n                                        \"<label>\" + dialogLang.urlTitle + \"</label>\" +\r\n                                        \"<input type=\\\"text\\\" value=\\\"\" + selection + \"\\\" data-title />\" +\r\n                                        \"<br/>\" +\r\n                                    \"</div>\";\r\n\r\n                dialog = this.createDialog({   \r\n                    name       : dialogName,\r\n                    title      : dialogLang.title,\r\n                    width      : 380,\r\n                    height     : 296,\r\n                    content    : dialogHTML,\r\n                    mask       : settings.dialogShowMask,\r\n                    drag       : settings.dialogDraggable,\r\n                    lockScreen : settings.dialogLockScreen,\r\n                    maskStyle  : {\r\n                        opacity         : settings.dialogMaskOpacity,\r\n                        backgroundColor : settings.dialogMaskBgColor\r\n                    },\r\n                    buttons : {\r\n                        enter  : [lang.buttons.enter, function() {\r\n                            var name  = this.find(\"[data-name]\").val();\r\n                            var url   = this.find(\"[data-url]\").val();\r\n                            var rid   = this.find(\"[data-url-id]\").val();\r\n                            var title = this.find(\"[data-title]\").val();\r\n\r\n                            if (name === \"\")\r\n                            {\r\n                                alert(dialogLang.nameEmpty);\r\n                                return false;\r\n                            }\r\n\r\n                            if (rid === \"\")\r\n                            {\r\n                                alert(dialogLang.idEmpty);\r\n                                return false;\r\n                            }\r\n\r\n                            if (url === \"http://\" || url === \"\")\r\n                            {\r\n                                alert(dialogLang.urlEmpty);\r\n                                return false;\r\n                            }\r\n\r\n                            //cm.replaceSelection(\"[\" + title + \"][\" + name + \"]\\n[\" + name + \"]: \" + url + \"\");\r\n                            cm.replaceSelection(\"[\" + name + \"][\" + rid + \"]\");\r\n\r\n                            if (selection === \"\") {\r\n                                cm.setCursor(cursor.line, cursor.ch + 1);\r\n                            }\r\n\r\n\t\t\t\t\t\t\ttitle = (title === \"\") ? \"\" : \" \\\"\" + title + \"\\\"\";\r\n\r\n\t\t\t\t\t\t\tcm.setValue(cm.getValue() + \"\\n[\" + rid + \"]: \" + url + title + \"\");\r\n\r\n                            this.hide().lockScreen(false).hideMask();\r\n\r\n                            return false;\r\n                        }],\r\n                        cancel : [lang.buttons.cancel, function() {                                   \r\n                            this.hide().lockScreen(false).hideMask();\r\n\r\n                            return false;\r\n                        }]\r\n                    }\r\n                });\r\n            }\r\n\r\n\t\t\tdialog = editor.find(\".\" + dialogName);\r\n\t\t\tdialog.find(\"[data-name]\").val(\"[\" + ReLinkId + \"]\");\r\n\t\t\tdialog.find(\"[data-url-id]\").val(\"\");\r\n\t\t\tdialog.find(\"[data-url]\").val(\"http://\");\r\n\t\t\tdialog.find(\"[data-title]\").val(selection);\r\n\r\n\t\t\tthis.dialogShowMask(dialog);\r\n\t\t\tthis.dialogLockScreen();\r\n\t\t\tdialog.show();\r\n\r\n\t\t\tReLinkId++;\r\n\t\t};\r\n\r\n\t};\r\n    \r\n\t// CommonJS/Node.js\r\n\tif (typeof require === \"function\" && typeof exports === \"object\" && typeof module === \"object\")\r\n    { \r\n        module.exports = factory;\r\n    }\r\n\telse if (typeof define === \"function\")  // AMD/CMD/Sea.js\r\n    {\r\n\t\tif (define.amd) { // for Require.js\r\n\r\n\t\t\tdefine([\"editormd\"], function(editormd) {\r\n                factory(editormd);\r\n            });\r\n\r\n\t\t} else { // for Sea.js\r\n\t\t\tdefine(function(require) {\r\n                var editormd = require(\"./../../editormd\");\r\n                factory(editormd);\r\n            });\r\n\t\t}\r\n\t} \r\n\telse\r\n\t{\r\n        factory(window.editormd);\r\n\t}\r\n\r\n})();\r\n"]}