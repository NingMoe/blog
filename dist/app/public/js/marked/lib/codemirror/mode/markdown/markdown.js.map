{"version":3,"sources":["../../../../../../../../../app/public/js/marked/lib/codemirror/mode/markdown/markdown.js"],"names":["mod","exports","module","require","define","amd","CodeMirror","defineMode","cmCfg","modeCfg","htmlFound","modes","hasOwnProperty","htmlMode","getMode","name","findModeByName","found","mime","mimes","mode","highlightFormatting","undefined","maxBlockquoteDepth","underscoresBreakWords","fencedCodeBlocks","taskLists","strikethrough","codeDepth","header","code","quote","list1","list2","list3","hr","image","formatting","linkinline","linkemail","linktext","linkhref","em","strong","hrRE","ulRE","olRE","taskListRE","atxHeaderRE","setextHeaderRE","textRE","switchInline","stream","state","f","inline","switchBlock","block","blankLine","linkTitle","htmlBlock","inlineNormal","blockNormal","trailingSpace","trailingSpaceNewLine","thisLineHasContent","sol","prevLineIsList","list","indentationDiff","indentation","listDepth","Math","floor","match","skipToEnd","eatSpace","length","getType","prevLineHasContent","charAt","eat","peek","footnoteLink","listType","taskList","localMode","RegExp","$1","localState","startState","local","style","token","htmlState","tagStart","context","md_inside","current","indexOf","leavingLocal","returnType","styles","push","i","taskOpen","join","taskClosed","linkHref","linkText","listMod","handleText","text","ch","next","type","matchCh","replace","regex","previousFormatting","t","before","pos","eatWhile","difference","linkInline","string","atts","substring","test","backUp","ignoreUnderscore","prevPos","prevCh","getLinkHrefInside","endChar","returnState","inlineRE","footnoteLinkInside","footnoteUrl","savedInlineRE","copyState","s","forceBlankLine","adjustedIndentation","innerMode","fold","defineMIME"],"mappings":"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","file":"markdown.js","sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"../xml/xml\"), require(\"../meta\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"../xml/xml\", \"../meta\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"markdown\", function(cmCfg, modeCfg) {\n\n  var htmlFound = CodeMirror.modes.hasOwnProperty(\"xml\");\n  var htmlMode = CodeMirror.getMode(cmCfg, htmlFound ? {name: \"xml\", htmlMode: true} : \"text/plain\");\n\n  function getMode(name) {\n    if (CodeMirror.findModeByName) {\n      var found = CodeMirror.findModeByName(name);\n      if (found) name = found.mime || found.mimes[0];\n    }\n    var mode = CodeMirror.getMode(cmCfg, name);\n    return mode.name == \"null\" ? null : mode;\n  }\n\n  // Should characters that affect highlighting be highlighted separate?\n  // Does not include characters that will be output (such as `1.` and `-` for lists)\n  if (modeCfg.highlightFormatting === undefined)\n    modeCfg.highlightFormatting = false;\n\n  // Maximum number of nested blockquotes. Set to 0 for infinite nesting.\n  // Excess `>` will emit `error` token.\n  if (modeCfg.maxBlockquoteDepth === undefined)\n    modeCfg.maxBlockquoteDepth = 0;\n\n  // Should underscores in words open/close em/strong?\n  if (modeCfg.underscoresBreakWords === undefined)\n    modeCfg.underscoresBreakWords = true;\n\n  // Turn on fenced code blocks? (\"```\" to start/end)\n  if (modeCfg.fencedCodeBlocks === undefined) modeCfg.fencedCodeBlocks = false;\n\n  // Turn on task lists? (\"- [ ] \" and \"- [x] \")\n  if (modeCfg.taskLists === undefined) modeCfg.taskLists = false;\n\n  // Turn on strikethrough syntax\n  if (modeCfg.strikethrough === undefined)\n    modeCfg.strikethrough = false;\n\n  var codeDepth = 0;\n\n  var header   = 'header'\n  ,   code     = 'comment'\n  ,   quote    = 'quote'\n  ,   list1    = 'variable-2'\n  ,   list2    = 'variable-3'\n  ,   list3    = 'keyword'\n  ,   hr       = 'hr'\n  ,   image    = 'tag'\n  ,   formatting = 'formatting'\n  ,   linkinline = 'link'\n  ,   linkemail = 'link'\n  ,   linktext = 'link'\n  ,   linkhref = 'string'\n  ,   em       = 'em'\n  ,   strong   = 'strong'\n  ,   strikethrough = 'strikethrough';\n\n  var hrRE = /^([*\\-=_])(?:\\s*\\1){2,}\\s*$/\n  ,   ulRE = /^[*\\-+]\\s+/\n  ,   olRE = /^[0-9]+\\.\\s+/\n  ,   taskListRE = /^\\[(x| )\\](?=\\s)/ // Must follow ulRE or olRE\n  ,   atxHeaderRE = /^#+/\n  ,   setextHeaderRE = /^(?:\\={1,}|-{1,})$/\n  ,   textRE = /^[^#!\\[\\]*_\\\\<>` \"'(~]+/;\n\n  function switchInline(stream, state, f) {\n    state.f = state.inline = f;\n    return f(stream, state);\n  }\n\n  function switchBlock(stream, state, f) {\n    state.f = state.block = f;\n    return f(stream, state);\n  }\n\n\n  // Blocks\n\n  function blankLine(state) {\n    // Reset linkTitle state\n    state.linkTitle = false;\n    // Reset EM state\n    state.em = false;\n    // Reset STRONG state\n    state.strong = false;\n    // Reset strikethrough state\n    state.strikethrough = false;\n    // Reset state.quote\n    state.quote = 0;\n    if (!htmlFound && state.f == htmlBlock) {\n      state.f = inlineNormal;\n      state.block = blockNormal;\n    }\n    // Reset state.trailingSpace\n    state.trailingSpace = 0;\n    state.trailingSpaceNewLine = false;\n    // Mark this line as blank\n    state.thisLineHasContent = false;\n    return null;\n  }\n\n  function blockNormal(stream, state) {\n\n    var sol = stream.sol();\n\n    var prevLineIsList = (state.list !== false);\n    if (state.list !== false && state.indentationDiff >= 0) { // Continued list\n      if (state.indentationDiff < 4) { // Only adjust indentation if *not* a code block\n        state.indentation -= state.indentationDiff;\n      }\n      state.list = null;\n    } else if (state.list !== false && state.indentation > 0) {\n      state.list = null;\n      state.listDepth = Math.floor(state.indentation / 4);\n    } else if (state.list !== false) { // No longer a list\n      state.list = false;\n      state.listDepth = 0;\n    }\n\n    var match = null;\n    if (state.indentationDiff >= 4) {\n      state.indentation -= 4;\n      stream.skipToEnd();\n      return code;\n    } else if (stream.eatSpace()) {\n      return null;\n    } else if (match = stream.match(atxHeaderRE)) {\n      state.header = match[0].length <= 6 ? match[0].length : 6;\n      if (modeCfg.highlightFormatting) state.formatting = \"header\";\n      state.f = state.inline;\n      return getType(state);\n    } else if (state.prevLineHasContent && (match = stream.match(setextHeaderRE))) {\n      state.header = match[0].charAt(0) == '=' ? 1 : 2;\n      if (modeCfg.highlightFormatting) state.formatting = \"header\";\n      state.f = state.inline;\n      return getType(state);\n    } else if (stream.eat('>')) {\n      state.indentation++;\n      state.quote = sol ? 1 : state.quote + 1;\n      if (modeCfg.highlightFormatting) state.formatting = \"quote\";\n      stream.eatSpace();\n      return getType(state);\n    } else if (stream.peek() === '[') {\n      return switchInline(stream, state, footnoteLink);\n    } else if (stream.match(hrRE, true)) {\n      return hr;\n    } else if ((!state.prevLineHasContent || prevLineIsList) && (stream.match(ulRE, false) || stream.match(olRE, false))) {\n      var listType = null;\n      if (stream.match(ulRE, true)) {\n        listType = 'ul';\n      } else {\n        stream.match(olRE, true);\n        listType = 'ol';\n      }\n      state.indentation += 4;\n      state.list = true;\n      state.listDepth++;\n      if (modeCfg.taskLists && stream.match(taskListRE, false)) {\n        state.taskList = true;\n      }\n      state.f = state.inline;\n      if (modeCfg.highlightFormatting) state.formatting = [\"list\", \"list-\" + listType];\n      return getType(state);\n    } else if (modeCfg.fencedCodeBlocks && stream.match(/^```[ \\t]*([\\w+#]*)/, true)) {\n      // try switching mode\n      state.localMode = getMode(RegExp.$1);\n      if (state.localMode) state.localState = state.localMode.startState();\n      state.f = state.block = local;\n      if (modeCfg.highlightFormatting) state.formatting = \"code-block\";\n      state.code = true;\n      return getType(state);\n    }\n\n    return switchInline(stream, state, state.inline);\n  }\n\n  function htmlBlock(stream, state) {\n    var style = htmlMode.token(stream, state.htmlState);\n    if ((htmlFound && state.htmlState.tagStart === null && !state.htmlState.context) ||\n        (state.md_inside && stream.current().indexOf(\">\") > -1)) {\n      state.f = inlineNormal;\n      state.block = blockNormal;\n      state.htmlState = null;\n    }\n    return style;\n  }\n\n  function local(stream, state) {\n    if (stream.sol() && stream.match(\"```\", false)) {\n      state.localMode = state.localState = null;\n      state.f = state.block = leavingLocal;\n      return null;\n    } else if (state.localMode) {\n      return state.localMode.token(stream, state.localState);\n    } else {\n      stream.skipToEnd();\n      return code;\n    }\n  }\n\n  function leavingLocal(stream, state) {\n    stream.match(\"```\");\n    state.block = blockNormal;\n    state.f = inlineNormal;\n    if (modeCfg.highlightFormatting) state.formatting = \"code-block\";\n    state.code = true;\n    var returnType = getType(state);\n    state.code = false;\n    return returnType;\n  }\n\n  // Inline\n  function getType(state) {\n    var styles = [];\n\n    if (state.formatting) {\n      styles.push(formatting);\n\n      if (typeof state.formatting === \"string\") state.formatting = [state.formatting];\n\n      for (var i = 0; i < state.formatting.length; i++) {\n        styles.push(formatting + \"-\" + state.formatting[i]);\n\n        if (state.formatting[i] === \"header\") {\n          styles.push(formatting + \"-\" + state.formatting[i] + \"-\" + state.header);\n        }\n\n        // Add `formatting-quote` and `formatting-quote-#` for blockquotes\n        // Add `error` instead if the maximum blockquote nesting depth is passed\n        if (state.formatting[i] === \"quote\") {\n          if (!modeCfg.maxBlockquoteDepth || modeCfg.maxBlockquoteDepth >= state.quote) {\n            styles.push(formatting + \"-\" + state.formatting[i] + \"-\" + state.quote);\n          } else {\n            styles.push(\"error\");\n          }\n        }\n      }\n    }\n\n    if (state.taskOpen) {\n      styles.push(\"meta\");\n      return styles.length ? styles.join(' ') : null;\n    }\n    if (state.taskClosed) {\n      styles.push(\"property\");\n      return styles.length ? styles.join(' ') : null;\n    }\n\n    if (state.linkHref) {\n      styles.push(linkhref);\n      return styles.length ? styles.join(' ') : null;\n    }\n\n    if (state.strong) { styles.push(strong); }\n    if (state.em) { styles.push(em); }\n    if (state.strikethrough) { styles.push(strikethrough); }\n\n    if (state.linkText) { styles.push(linktext); }\n\n    if (state.code) { styles.push(code); }\n\n    if (state.header) { styles.push(header); styles.push(header + \"-\" + state.header); }\n\n    if (state.quote) {\n      styles.push(quote);\n\n      // Add `quote-#` where the maximum for `#` is modeCfg.maxBlockquoteDepth\n      if (!modeCfg.maxBlockquoteDepth || modeCfg.maxBlockquoteDepth >= state.quote) {\n        styles.push(quote + \"-\" + state.quote);\n      } else {\n        styles.push(quote + \"-\" + modeCfg.maxBlockquoteDepth);\n      }\n    }\n\n    if (state.list !== false) {\n      var listMod = (state.listDepth - 1) % 3;\n      if (!listMod) {\n        styles.push(list1);\n      } else if (listMod === 1) {\n        styles.push(list2);\n      } else {\n        styles.push(list3);\n      }\n    }\n\n    if (state.trailingSpaceNewLine) {\n      styles.push(\"trailing-space-new-line\");\n    } else if (state.trailingSpace) {\n      styles.push(\"trailing-space-\" + (state.trailingSpace % 2 ? \"a\" : \"b\"));\n    }\n\n    return styles.length ? styles.join(' ') : null;\n  }\n\n  function handleText(stream, state) {\n    if (stream.match(textRE, true)) {\n      return getType(state);\n    }\n    return undefined;\n  }\n\n  function inlineNormal(stream, state) {\n    var style = state.text(stream, state);\n    if (typeof style !== 'undefined')\n      return style;\n\n    if (state.list) { // List marker (*, +, -, 1., etc)\n      state.list = null;\n      return getType(state);\n    }\n\n    if (state.taskList) {\n      var taskOpen = stream.match(taskListRE, true)[1] !== \"x\";\n      if (taskOpen) state.taskOpen = true;\n      else state.taskClosed = true;\n      if (modeCfg.highlightFormatting) state.formatting = \"task\";\n      state.taskList = false;\n      return getType(state);\n    }\n\n    state.taskOpen = false;\n    state.taskClosed = false;\n\n    if (state.header && stream.match(/^#+$/, true)) {\n      if (modeCfg.highlightFormatting) state.formatting = \"header\";\n      return getType(state);\n    }\n\n    // Get sol() value now, before character is consumed\n    var sol = stream.sol();\n\n    var ch = stream.next();\n\n    if (ch === '\\\\') {\n      stream.next();\n      if (modeCfg.highlightFormatting) {\n        var type = getType(state);\n        return type ? type + \" formatting-escape\" : \"formatting-escape\";\n      }\n    }\n\n    // Matches link titles present on next line\n    if (state.linkTitle) {\n      state.linkTitle = false;\n      var matchCh = ch;\n      if (ch === '(') {\n        matchCh = ')';\n      }\n      matchCh = (matchCh+'').replace(/([.?*+^$[\\]\\\\(){}|-])/g, \"\\\\$1\");\n      var regex = '^\\\\s*(?:[^' + matchCh + '\\\\\\\\]+|\\\\\\\\\\\\\\\\|\\\\\\\\.)' + matchCh;\n      if (stream.match(new RegExp(regex), true)) {\n        return linkhref;\n      }\n    }\n\n    // If this block is changed, it may need to be updated in GFM mode\n    if (ch === '`') {\n      var previousFormatting = state.formatting;\n      if (modeCfg.highlightFormatting) state.formatting = \"code\";\n      var t = getType(state);\n      var before = stream.pos;\n      stream.eatWhile('`');\n      var difference = 1 + stream.pos - before;\n      if (!state.code) {\n        codeDepth = difference;\n        state.code = true;\n        return getType(state);\n      } else {\n        if (difference === codeDepth) { // Must be exact\n          state.code = false;\n          return t;\n        }\n        state.formatting = previousFormatting;\n        return getType(state);\n      }\n    } else if (state.code) {\n      return getType(state);\n    }\n\n    if (ch === '!' && stream.match(/\\[[^\\]]*\\] ?(?:\\(|\\[)/, false)) {\n      stream.match(/\\[[^\\]]*\\]/);\n      state.inline = state.f = linkHref;\n      return image;\n    }\n\n    if (ch === '[' && stream.match(/.*\\](\\(.*\\)| ?\\[.*\\])/, false)) {\n      state.linkText = true;\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      return getType(state);\n    }\n\n    if (ch === ']' && state.linkText && stream.match(/\\(.*\\)| ?\\[.*\\]/, false)) {\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      var type = getType(state);\n      state.linkText = false;\n      state.inline = state.f = linkHref;\n      return type;\n    }\n\n    if (ch === '<' && stream.match(/^(https?|ftps?):\\/\\/(?:[^\\\\>]|\\\\.)+>/, false)) {\n      state.f = state.inline = linkInline;\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      var type = getType(state);\n      if (type){\n        type += \" \";\n      } else {\n        type = \"\";\n      }\n      return type + linkinline;\n    }\n\n    if (ch === '<' && stream.match(/^[^> \\\\]+@(?:[^\\\\>]|\\\\.)+>/, false)) {\n      state.f = state.inline = linkInline;\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      var type = getType(state);\n      if (type){\n        type += \" \";\n      } else {\n        type = \"\";\n      }\n      return type + linkemail;\n    }\n\n    if (ch === '<' && stream.match(/^\\w/, false)) {\n      if (stream.string.indexOf(\">\") != -1) {\n        var atts = stream.string.substring(1,stream.string.indexOf(\">\"));\n        if (/markdown\\s*=\\s*('|\"){0,1}1('|\"){0,1}/.test(atts)) {\n          state.md_inside = true;\n        }\n      }\n      stream.backUp(1);\n      state.htmlState = CodeMirror.startState(htmlMode);\n      return switchBlock(stream, state, htmlBlock);\n    }\n\n    if (ch === '<' && stream.match(/^\\/\\w*?>/)) {\n      state.md_inside = false;\n      return \"tag\";\n    }\n\n    var ignoreUnderscore = false;\n    if (!modeCfg.underscoresBreakWords) {\n      if (ch === '_' && stream.peek() !== '_' && stream.match(/(\\w)/, false)) {\n        var prevPos = stream.pos - 2;\n        if (prevPos >= 0) {\n          var prevCh = stream.string.charAt(prevPos);\n          if (prevCh !== '_' && prevCh.match(/(\\w)/, false)) {\n            ignoreUnderscore = true;\n          }\n        }\n      }\n    }\n    if (ch === '*' || (ch === '_' && !ignoreUnderscore)) {\n      if (sol && stream.peek() === ' ') {\n        // Do nothing, surrounded by newline and space\n      } else if (state.strong === ch && stream.eat(ch)) { // Remove STRONG\n        if (modeCfg.highlightFormatting) state.formatting = \"strong\";\n        var t = getType(state);\n        state.strong = false;\n        return t;\n      } else if (!state.strong && stream.eat(ch)) { // Add STRONG\n        state.strong = ch;\n        if (modeCfg.highlightFormatting) state.formatting = \"strong\";\n        return getType(state);\n      } else if (state.em === ch) { // Remove EM\n        if (modeCfg.highlightFormatting) state.formatting = \"em\";\n        var t = getType(state);\n        state.em = false;\n        return t;\n      } else if (!state.em) { // Add EM\n        state.em = ch;\n        if (modeCfg.highlightFormatting) state.formatting = \"em\";\n        return getType(state);\n      }\n    } else if (ch === ' ') {\n      if (stream.eat('*') || stream.eat('_')) { // Probably surrounded by spaces\n        if (stream.peek() === ' ') { // Surrounded by spaces, ignore\n          return getType(state);\n        } else { // Not surrounded by spaces, back up pointer\n          stream.backUp(1);\n        }\n      }\n    }\n\n    if (modeCfg.strikethrough) {\n      if (ch === '~' && stream.eatWhile(ch)) {\n        if (state.strikethrough) {// Remove strikethrough\n          if (modeCfg.highlightFormatting) state.formatting = \"strikethrough\";\n          var t = getType(state);\n          state.strikethrough = false;\n          return t;\n        } else if (stream.match(/^[^\\s]/, false)) {// Add strikethrough\n          state.strikethrough = true;\n          if (modeCfg.highlightFormatting) state.formatting = \"strikethrough\";\n          return getType(state);\n        }\n      } else if (ch === ' ') {\n        if (stream.match(/^~~/, true)) { // Probably surrounded by space\n          if (stream.peek() === ' ') { // Surrounded by spaces, ignore\n            return getType(state);\n          } else { // Not surrounded by spaces, back up pointer\n            stream.backUp(2);\n          }\n        }\n      }\n    }\n\n    if (ch === ' ') {\n      if (stream.match(/ +$/, false)) {\n        state.trailingSpace++;\n      } else if (state.trailingSpace) {\n        state.trailingSpaceNewLine = true;\n      }\n    }\n\n    return getType(state);\n  }\n\n  function linkInline(stream, state) {\n    var ch = stream.next();\n\n    if (ch === \">\") {\n      state.f = state.inline = inlineNormal;\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      var type = getType(state);\n      if (type){\n        type += \" \";\n      } else {\n        type = \"\";\n      }\n      return type + linkinline;\n    }\n\n    stream.match(/^[^>]+/, true);\n\n    return linkinline;\n  }\n\n  function linkHref(stream, state) {\n    // Check if space, and return NULL if so (to avoid marking the space)\n    if(stream.eatSpace()){\n      return null;\n    }\n    var ch = stream.next();\n    if (ch === '(' || ch === '[') {\n      state.f = state.inline = getLinkHrefInside(ch === \"(\" ? \")\" : \"]\");\n      if (modeCfg.highlightFormatting) state.formatting = \"link-string\";\n      state.linkHref = true;\n      return getType(state);\n    }\n    return 'error';\n  }\n\n  function getLinkHrefInside(endChar) {\n    return function(stream, state) {\n      var ch = stream.next();\n\n      if (ch === endChar) {\n        state.f = state.inline = inlineNormal;\n        if (modeCfg.highlightFormatting) state.formatting = \"link-string\";\n        var returnState = getType(state);\n        state.linkHref = false;\n        return returnState;\n      }\n\n      if (stream.match(inlineRE(endChar), true)) {\n        stream.backUp(1);\n      }\n\n      state.linkHref = true;\n      return getType(state);\n    };\n  }\n\n  function footnoteLink(stream, state) {\n    if (stream.match(/^[^\\]]*\\]:/, false)) {\n      state.f = footnoteLinkInside;\n      stream.next(); // Consume [\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      state.linkText = true;\n      return getType(state);\n    }\n    return switchInline(stream, state, inlineNormal);\n  }\n\n  function footnoteLinkInside(stream, state) {\n    if (stream.match(/^\\]:/, true)) {\n      state.f = state.inline = footnoteUrl;\n      if (modeCfg.highlightFormatting) state.formatting = \"link\";\n      var returnType = getType(state);\n      state.linkText = false;\n      return returnType;\n    }\n\n    stream.match(/^[^\\]]+/, true);\n\n    return linktext;\n  }\n\n  function footnoteUrl(stream, state) {\n    // Check if space, and return NULL if so (to avoid marking the space)\n    if(stream.eatSpace()){\n      return null;\n    }\n    // Match URL\n    stream.match(/^[^\\s]+/, true);\n    // Check for link title\n    if (stream.peek() === undefined) { // End of line, set flag to check next line\n      state.linkTitle = true;\n    } else { // More content on line, check if link title\n      stream.match(/^(?:\\s+(?:\"(?:[^\"\\\\]|\\\\\\\\|\\\\.)+\"|'(?:[^'\\\\]|\\\\\\\\|\\\\.)+'|\\((?:[^)\\\\]|\\\\\\\\|\\\\.)+\\)))?/, true);\n    }\n    state.f = state.inline = inlineNormal;\n    return linkhref;\n  }\n\n  var savedInlineRE = [];\n  function inlineRE(endChar) {\n    if (!savedInlineRE[endChar]) {\n      // Escape endChar for RegExp (taken from http://stackoverflow.com/a/494122/526741)\n      endChar = (endChar+'').replace(/([.?*+^$[\\]\\\\(){}|-])/g, \"\\\\$1\");\n      // Match any non-endChar, escaped character, as well as the closing\n      // endChar.\n      savedInlineRE[endChar] = new RegExp('^(?:[^\\\\\\\\]|\\\\\\\\.)*?(' + endChar + ')');\n    }\n    return savedInlineRE[endChar];\n  }\n\n  var mode = {\n    startState: function() {\n      return {\n        f: blockNormal,\n\n        prevLineHasContent: false,\n        thisLineHasContent: false,\n\n        block: blockNormal,\n        htmlState: null,\n        indentation: 0,\n\n        inline: inlineNormal,\n        text: handleText,\n\n        formatting: false,\n        linkText: false,\n        linkHref: false,\n        linkTitle: false,\n        em: false,\n        strong: false,\n        header: 0,\n        taskList: false,\n        list: false,\n        listDepth: 0,\n        quote: 0,\n        trailingSpace: 0,\n        trailingSpaceNewLine: false,\n        strikethrough: false\n      };\n    },\n\n    copyState: function(s) {\n      return {\n        f: s.f,\n\n        prevLineHasContent: s.prevLineHasContent,\n        thisLineHasContent: s.thisLineHasContent,\n\n        block: s.block,\n        htmlState: s.htmlState && CodeMirror.copyState(htmlMode, s.htmlState),\n        indentation: s.indentation,\n\n        localMode: s.localMode,\n        localState: s.localMode ? CodeMirror.copyState(s.localMode, s.localState) : null,\n\n        inline: s.inline,\n        text: s.text,\n        formatting: false,\n        linkTitle: s.linkTitle,\n        em: s.em,\n        strong: s.strong,\n        strikethrough: s.strikethrough,\n        header: s.header,\n        taskList: s.taskList,\n        list: s.list,\n        listDepth: s.listDepth,\n        quote: s.quote,\n        trailingSpace: s.trailingSpace,\n        trailingSpaceNewLine: s.trailingSpaceNewLine,\n        md_inside: s.md_inside\n      };\n    },\n\n    token: function(stream, state) {\n\n      // Reset state.formatting\n      state.formatting = false;\n\n      if (stream.sol()) {\n        var forceBlankLine = !!state.header;\n\n        // Reset state.header\n        state.header = 0;\n\n        if (stream.match(/^\\s*$/, true) || forceBlankLine) {\n          state.prevLineHasContent = false;\n          blankLine(state);\n          return forceBlankLine ? this.token(stream, state) : null;\n        } else {\n          state.prevLineHasContent = state.thisLineHasContent;\n          state.thisLineHasContent = true;\n        }\n\n        // Reset state.taskList\n        state.taskList = false;\n\n        // Reset state.code\n        state.code = false;\n\n        // Reset state.trailingSpace\n        state.trailingSpace = 0;\n        state.trailingSpaceNewLine = false;\n\n        state.f = state.block;\n        var indentation = stream.match(/^\\s*/, true)[0].replace(/\\t/g, '    ').length;\n        var difference = Math.floor((indentation - state.indentation) / 4) * 4;\n        if (difference > 4) difference = 4;\n        var adjustedIndentation = state.indentation + difference;\n        state.indentationDiff = adjustedIndentation - state.indentation;\n        state.indentation = adjustedIndentation;\n        if (indentation > 0) return null;\n      }\n      return state.f(stream, state);\n    },\n\n    innerMode: function(state) {\n      if (state.block == htmlBlock) return {state: state.htmlState, mode: htmlMode};\n      if (state.localState) return {state: state.localState, mode: state.localMode};\n      return {state: state, mode: mode};\n    },\n\n    blankLine: blankLine,\n\n    getType: getType,\n\n    fold: \"markdown\"\n  };\n  return mode;\n}, \"xml\");\n\nCodeMirror.defineMIME(\"text/x-markdown\", \"markdown\");\n\n});\n"]}