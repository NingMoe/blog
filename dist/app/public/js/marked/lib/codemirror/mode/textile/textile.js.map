{"version":3,"sources":["../../../../../../../../../app/public/js/marked/lib/codemirror/mode/textile/textile.js"],"names":["mod","exports","module","require","define","amd","CodeMirror","TOKEN_STYLES","addition","attributes","bold","cite","code","definitionList","deletion","div","em","footnote","footCite","header","html","image","italic","link","linkDefinition","list1","list2","list3","notextile","pre","p","quote","span","specialChar","strong","sub","sup","table","tableHeading","startNewLine","stream","state","mode","Modes","newLayout","layoutType","spanningLayout","match","RE","handlePhraseModifier","ch","eat","togglePhraseModifier","tokenStyles","spec","tokenStylesWith","type","phraseModifier","closeRE","openSize","charBefore","pos","string","charAt","charAfter","peek","test","RegExp","source","disabled","textileDisabled","styles","push","concat","activeStyles","length","join","extraStyles","i","arguments","blankLine","key","hasOwnProperty","REs","cache","single","bc","bq","definitionListEnd","drawTable","foot","list","para","tableCellAttributes","tableText","text","align","selector","lang","pad","css","createRe","name","makeRe","choiceRe","pattern","arg","parts","unshift","apply","blockType","newMode","parseInt","next","layoutLength","listDepth","listMod","skipToEnd","tableCell","defineMode","startState","token","sol","defineMIME"],"mappings":"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","file":"textile.js","sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") { // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  } else if (typeof define == \"function\" && define.amd) { // AMD\n    define([\"../../lib/codemirror\"], mod);\n  } else { // Plain browser env\n    mod(CodeMirror);\n  }\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var TOKEN_STYLES = {\n    addition: \"positive\",\n    attributes: \"attribute\",\n    bold: \"strong\",\n    cite: \"keyword\",\n    code: \"atom\",\n    definitionList: \"number\",\n    deletion: \"negative\",\n    div: \"punctuation\",\n    em: \"em\",\n    footnote: \"variable\",\n    footCite: \"qualifier\",\n    header: \"header\",\n    html: \"comment\",\n    image: \"string\",\n    italic: \"em\",\n    link: \"link\",\n    linkDefinition: \"link\",\n    list1: \"variable-2\",\n    list2: \"variable-3\",\n    list3: \"keyword\",\n    notextile: \"string-2\",\n    pre: \"operator\",\n    p: \"property\",\n    quote: \"bracket\",\n    span: \"quote\",\n    specialChar: \"tag\",\n    strong: \"strong\",\n    sub: \"builtin\",\n    sup: \"builtin\",\n    table: \"variable-3\",\n    tableHeading: \"operator\"\n  };\n\n  function startNewLine(stream, state) {\n    state.mode = Modes.newLayout;\n    state.tableHeading = false;\n\n    if (state.layoutType === \"definitionList\" && state.spanningLayout &&\n        stream.match(RE(\"definitionListEnd\"), false))\n      state.spanningLayout = false;\n  }\n\n  function handlePhraseModifier(stream, state, ch) {\n    if (ch === \"_\") {\n      if (stream.eat(\"_\"))\n        return togglePhraseModifier(stream, state, \"italic\", /__/, 2);\n      else\n        return togglePhraseModifier(stream, state, \"em\", /_/, 1);\n    }\n\n    if (ch === \"*\") {\n      if (stream.eat(\"*\")) {\n        return togglePhraseModifier(stream, state, \"bold\", /\\*\\*/, 2);\n      }\n      return togglePhraseModifier(stream, state, \"strong\", /\\*/, 1);\n    }\n\n    if (ch === \"[\") {\n      if (stream.match(/\\d+\\]/)) state.footCite = true;\n      return tokenStyles(state);\n    }\n\n    if (ch === \"(\") {\n      var spec = stream.match(/^(r|tm|c)\\)/);\n      if (spec)\n        return tokenStylesWith(state, TOKEN_STYLES.specialChar);\n    }\n\n    if (ch === \"<\" && stream.match(/(\\w+)[^>]+>[^<]+<\\/\\1>/))\n      return tokenStylesWith(state, TOKEN_STYLES.html);\n\n    if (ch === \"?\" && stream.eat(\"?\"))\n      return togglePhraseModifier(stream, state, \"cite\", /\\?\\?/, 2);\n\n    if (ch === \"=\" && stream.eat(\"=\"))\n      return togglePhraseModifier(stream, state, \"notextile\", /==/, 2);\n\n    if (ch === \"-\" && !stream.eat(\"-\"))\n      return togglePhraseModifier(stream, state, \"deletion\", /-/, 1);\n\n    if (ch === \"+\")\n      return togglePhraseModifier(stream, state, \"addition\", /\\+/, 1);\n\n    if (ch === \"~\")\n      return togglePhraseModifier(stream, state, \"sub\", /~/, 1);\n\n    if (ch === \"^\")\n      return togglePhraseModifier(stream, state, \"sup\", /\\^/, 1);\n\n    if (ch === \"%\")\n      return togglePhraseModifier(stream, state, \"span\", /%/, 1);\n\n    if (ch === \"@\")\n      return togglePhraseModifier(stream, state, \"code\", /@/, 1);\n\n    if (ch === \"!\") {\n      var type = togglePhraseModifier(stream, state, \"image\", /(?:\\([^\\)]+\\))?!/, 1);\n      stream.match(/^:\\S+/); // optional Url portion\n      return type;\n    }\n    return tokenStyles(state);\n  }\n\n  function togglePhraseModifier(stream, state, phraseModifier, closeRE, openSize) {\n    var charBefore = stream.pos > openSize ? stream.string.charAt(stream.pos - openSize - 1) : null;\n    var charAfter = stream.peek();\n    if (state[phraseModifier]) {\n      if ((!charAfter || /\\W/.test(charAfter)) && charBefore && /\\S/.test(charBefore)) {\n        var type = tokenStyles(state);\n        state[phraseModifier] = false;\n        return type;\n      }\n    } else if ((!charBefore || /\\W/.test(charBefore)) && charAfter && /\\S/.test(charAfter) &&\n               stream.match(new RegExp(\"^.*\\\\S\" + closeRE.source + \"(?:\\\\W|$)\"), false)) {\n      state[phraseModifier] = true;\n      state.mode = Modes.attributes;\n    }\n    return tokenStyles(state);\n  };\n\n  function tokenStyles(state) {\n    var disabled = textileDisabled(state);\n    if (disabled) return disabled;\n\n    var styles = [];\n    if (state.layoutType) styles.push(TOKEN_STYLES[state.layoutType]);\n\n    styles = styles.concat(activeStyles(\n      state, \"addition\", \"bold\", \"cite\", \"code\", \"deletion\", \"em\", \"footCite\",\n      \"image\", \"italic\", \"link\", \"span\", \"strong\", \"sub\", \"sup\", \"table\", \"tableHeading\"));\n\n    if (state.layoutType === \"header\")\n      styles.push(TOKEN_STYLES.header + \"-\" + state.header);\n\n    return styles.length ? styles.join(\" \") : null;\n  }\n\n  function textileDisabled(state) {\n    var type = state.layoutType;\n\n    switch(type) {\n    case \"notextile\":\n    case \"code\":\n    case \"pre\":\n      return TOKEN_STYLES[type];\n    default:\n      if (state.notextile)\n        return TOKEN_STYLES.notextile + (type ? (\" \" + TOKEN_STYLES[type]) : \"\");\n      return null;\n    }\n  }\n\n  function tokenStylesWith(state, extraStyles) {\n    var disabled = textileDisabled(state);\n    if (disabled) return disabled;\n\n    var type = tokenStyles(state);\n    if (extraStyles)\n      return type ? (type + \" \" + extraStyles) : extraStyles;\n    else\n      return type;\n  }\n\n  function activeStyles(state) {\n    var styles = [];\n    for (var i = 1; i < arguments.length; ++i) {\n      if (state[arguments[i]])\n        styles.push(TOKEN_STYLES[arguments[i]]);\n    }\n    return styles;\n  }\n\n  function blankLine(state) {\n    var spanningLayout = state.spanningLayout, type = state.layoutType;\n\n    for (var key in state) if (state.hasOwnProperty(key))\n      delete state[key];\n\n    state.mode = Modes.newLayout;\n    if (spanningLayout) {\n      state.layoutType = type;\n      state.spanningLayout = true;\n    }\n  }\n\n  var REs = {\n    cache: {},\n    single: {\n      bc: \"bc\",\n      bq: \"bq\",\n      definitionList: /- [^(?::=)]+:=+/,\n      definitionListEnd: /.*=:\\s*$/,\n      div: \"div\",\n      drawTable: /\\|.*\\|/,\n      foot: /fn\\d+/,\n      header: /h[1-6]/,\n      html: /\\s*<(?:\\/)?(\\w+)(?:[^>]+)?>(?:[^<]+<\\/\\1>)?/,\n      link: /[^\"]+\":\\S/,\n      linkDefinition: /\\[[^\\s\\]]+\\]\\S+/,\n      list: /(?:#+|\\*+)/,\n      notextile: \"notextile\",\n      para: \"p\",\n      pre: \"pre\",\n      table: \"table\",\n      tableCellAttributes: /[\\/\\\\]\\d+/,\n      tableHeading: /\\|_\\./,\n      tableText: /[^\"_\\*\\[\\(\\?\\+~\\^%@|-]+/,\n      text: /[^!\"_=\\*\\[\\(<\\?\\+~\\^%@-]+/\n    },\n    attributes: {\n      align: /(?:<>|<|>|=)/,\n      selector: /\\([^\\(][^\\)]+\\)/,\n      lang: /\\[[^\\[\\]]+\\]/,\n      pad: /(?:\\(+|\\)+){1,2}/,\n      css: /\\{[^\\}]+\\}/\n    },\n    createRe: function(name) {\n      switch (name) {\n      case \"drawTable\":\n        return REs.makeRe(\"^\", REs.single.drawTable, \"$\");\n      case \"html\":\n        return REs.makeRe(\"^\", REs.single.html, \"(?:\", REs.single.html, \")*\", \"$\");\n      case \"linkDefinition\":\n        return REs.makeRe(\"^\", REs.single.linkDefinition, \"$\");\n      case \"listLayout\":\n        return REs.makeRe(\"^\", REs.single.list, RE(\"allAttributes\"), \"*\\\\s+\");\n      case \"tableCellAttributes\":\n        return REs.makeRe(\"^\", REs.choiceRe(REs.single.tableCellAttributes,\n                                            RE(\"allAttributes\")), \"+\\\\.\");\n      case \"type\":\n        return REs.makeRe(\"^\", RE(\"allTypes\"));\n      case \"typeLayout\":\n        return REs.makeRe(\"^\", RE(\"allTypes\"), RE(\"allAttributes\"),\n                          \"*\\\\.\\\\.?\", \"(\\\\s+|$)\");\n      case \"attributes\":\n        return REs.makeRe(\"^\", RE(\"allAttributes\"), \"+\");\n\n      case \"allTypes\":\n        return REs.choiceRe(REs.single.div, REs.single.foot,\n                            REs.single.header, REs.single.bc, REs.single.bq,\n                            REs.single.notextile, REs.single.pre, REs.single.table,\n                            REs.single.para);\n\n      case \"allAttributes\":\n        return REs.choiceRe(REs.attributes.selector, REs.attributes.css,\n                            REs.attributes.lang, REs.attributes.align, REs.attributes.pad);\n\n      default:\n        return REs.makeRe(\"^\", REs.single[name]);\n      }\n    },\n    makeRe: function() {\n      var pattern = \"\";\n      for (var i = 0; i < arguments.length; ++i) {\n        var arg = arguments[i];\n        pattern += (typeof arg === \"string\") ? arg : arg.source;\n      }\n      return new RegExp(pattern);\n    },\n    choiceRe: function() {\n      var parts = [arguments[0]];\n      for (var i = 1; i < arguments.length; ++i) {\n        parts[i * 2 - 1] = \"|\";\n        parts[i * 2] = arguments[i];\n      }\n\n      parts.unshift(\"(?:\");\n      parts.push(\")\");\n      return REs.makeRe.apply(null, parts);\n    }\n  };\n\n  function RE(name) {\n    return (REs.cache[name] || (REs.cache[name] = REs.createRe(name)));\n  }\n\n  var Modes = {\n    newLayout: function(stream, state) {\n      if (stream.match(RE(\"typeLayout\"), false)) {\n        state.spanningLayout = false;\n        return (state.mode = Modes.blockType)(stream, state);\n      }\n      var newMode;\n      if (!textileDisabled(state)) {\n        if (stream.match(RE(\"listLayout\"), false))\n          newMode = Modes.list;\n        else if (stream.match(RE(\"drawTable\"), false))\n          newMode = Modes.table;\n        else if (stream.match(RE(\"linkDefinition\"), false))\n          newMode = Modes.linkDefinition;\n        else if (stream.match(RE(\"definitionList\")))\n          newMode = Modes.definitionList;\n        else if (stream.match(RE(\"html\"), false))\n          newMode = Modes.html;\n      }\n      return (state.mode = (newMode || Modes.text))(stream, state);\n    },\n\n    blockType: function(stream, state) {\n      var match, type;\n      state.layoutType = null;\n\n      if (match = stream.match(RE(\"type\")))\n        type = match[0];\n      else\n        return (state.mode = Modes.text)(stream, state);\n\n      if (match = type.match(RE(\"header\"))) {\n        state.layoutType = \"header\";\n        state.header = parseInt(match[0][1]);\n      } else if (type.match(RE(\"bq\"))) {\n        state.layoutType = \"quote\";\n      } else if (type.match(RE(\"bc\"))) {\n        state.layoutType = \"code\";\n      } else if (type.match(RE(\"foot\"))) {\n        state.layoutType = \"footnote\";\n      } else if (type.match(RE(\"notextile\"))) {\n        state.layoutType = \"notextile\";\n      } else if (type.match(RE(\"pre\"))) {\n        state.layoutType = \"pre\";\n      } else if (type.match(RE(\"div\"))) {\n        state.layoutType = \"div\";\n      } else if (type.match(RE(\"table\"))) {\n        state.layoutType = \"table\";\n      }\n\n      state.mode = Modes.attributes;\n      return tokenStyles(state);\n    },\n\n    text: function(stream, state) {\n      if (stream.match(RE(\"text\"))) return tokenStyles(state);\n\n      var ch = stream.next();\n      if (ch === '\"')\n        return (state.mode = Modes.link)(stream, state);\n      return handlePhraseModifier(stream, state, ch);\n    },\n\n    attributes: function(stream, state) {\n      state.mode = Modes.layoutLength;\n\n      if (stream.match(RE(\"attributes\")))\n        return tokenStylesWith(state, TOKEN_STYLES.attributes);\n      else\n        return tokenStyles(state);\n    },\n\n    layoutLength: function(stream, state) {\n      if (stream.eat(\".\") && stream.eat(\".\"))\n        state.spanningLayout = true;\n\n      state.mode = Modes.text;\n      return tokenStyles(state);\n    },\n\n    list: function(stream, state) {\n      var match = stream.match(RE(\"list\"));\n      state.listDepth = match[0].length;\n      var listMod = (state.listDepth - 1) % 3;\n      if (!listMod)\n        state.layoutType = \"list1\";\n      else if (listMod === 1)\n        state.layoutType = \"list2\";\n      else\n        state.layoutType = \"list3\";\n\n      state.mode = Modes.attributes;\n      return tokenStyles(state);\n    },\n\n    link: function(stream, state) {\n      state.mode = Modes.text;\n      if (stream.match(RE(\"link\"))) {\n        stream.match(/\\S+/);\n        return tokenStylesWith(state, TOKEN_STYLES.link);\n      }\n      return tokenStyles(state);\n    },\n\n    linkDefinition: function(stream, state) {\n      stream.skipToEnd();\n      return tokenStylesWith(state, TOKEN_STYLES.linkDefinition);\n    },\n\n    definitionList: function(stream, state) {\n      stream.match(RE(\"definitionList\"));\n\n      state.layoutType = \"definitionList\";\n\n      if (stream.match(/\\s*$/))\n        state.spanningLayout = true;\n      else\n        state.mode = Modes.attributes;\n\n      return tokenStyles(state);\n    },\n\n    html: function(stream, state) {\n      stream.skipToEnd();\n      return tokenStylesWith(state, TOKEN_STYLES.html);\n    },\n\n    table: function(stream, state) {\n      state.layoutType = \"table\";\n      return (state.mode = Modes.tableCell)(stream, state);\n    },\n\n    tableCell: function(stream, state) {\n      if (stream.match(RE(\"tableHeading\")))\n        state.tableHeading = true;\n      else\n        stream.eat(\"|\");\n\n      state.mode = Modes.tableCellAttributes;\n      return tokenStyles(state);\n    },\n\n    tableCellAttributes: function(stream, state) {\n      state.mode = Modes.tableText;\n\n      if (stream.match(RE(\"tableCellAttributes\")))\n        return tokenStylesWith(state, TOKEN_STYLES.attributes);\n      else\n        return tokenStyles(state);\n    },\n\n    tableText: function(stream, state) {\n      if (stream.match(RE(\"tableText\")))\n        return tokenStyles(state);\n\n      if (stream.peek() === \"|\") { // end of cell\n        state.mode = Modes.tableCell;\n        return tokenStyles(state);\n      }\n      return handlePhraseModifier(stream, state, stream.next());\n    }\n  };\n\n  CodeMirror.defineMode(\"textile\", function() {\n    return {\n      startState: function() {\n        return { mode: Modes.newLayout };\n      },\n      token: function(stream, state) {\n        if (stream.sol()) startNewLine(stream, state);\n        return state.mode(stream, state);\n      },\n      blankLine: blankLine\n    };\n  });\n\n  CodeMirror.defineMIME(\"text/x-textile\", \"textile\");\n});\n"]}