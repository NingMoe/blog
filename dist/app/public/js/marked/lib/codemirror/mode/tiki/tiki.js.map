{"version":3,"sources":["../../../../../../../../../app/public/js/marked/lib/codemirror/mode/tiki/tiki.js"],"names":["mod","exports","module","require","define","amd","CodeMirror","defineMode","config","inBlock","style","terminator","returnTokenizer","stream","state","eol","match","tokenize","inText","next","inLine","chain","parser","sol","ch","eat","eatSpace","tagName","c","inPlugin","indentUnit","pluginName","type","peek","test","inAttributeNoQuote","inAttribute","eatWhile","quote","curState","setStyle","pass","i","arguments","length","cc","push","cont","apply","pushContext","startOfLine","noIndent","context","prev","indent","indented","popContext","element","attributes","endplugin","err","endcloseplugin","name","attvalue","attvaluemaybe","startState","token","indentation","comb","pop","textAfter","electricChars","defineMIME"],"mappings":"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","file":"tiki.js","sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode('tiki', function(config) {\n  function inBlock(style, terminator, returnTokenizer) {\n    return function(stream, state) {\n      while (!stream.eol()) {\n        if (stream.match(terminator)) {\n          state.tokenize = inText;\n          break;\n        }\n        stream.next();\n      }\n\n      if (returnTokenizer) state.tokenize = returnTokenizer;\n\n      return style;\n    };\n  }\n\n  function inLine(style) {\n    return function(stream, state) {\n      while(!stream.eol()) {\n        stream.next();\n      }\n      state.tokenize = inText;\n      return style;\n    };\n  }\n\n  function inText(stream, state) {\n    function chain(parser) {\n      state.tokenize = parser;\n      return parser(stream, state);\n    }\n\n    var sol = stream.sol();\n    var ch = stream.next();\n\n    //non start of line\n    switch (ch) { //switch is generally much faster than if, so it is used here\n    case \"{\": //plugin\n      stream.eat(\"/\");\n      stream.eatSpace();\n      var tagName = \"\";\n      var c;\n      while ((c = stream.eat(/[^\\s\\u00a0=\\\"\\'\\/?(}]/))) tagName += c;\n      state.tokenize = inPlugin;\n      return \"tag\";\n      break;\n    case \"_\": //bold\n      if (stream.eat(\"_\")) {\n        return chain(inBlock(\"strong\", \"__\", inText));\n      }\n      break;\n    case \"'\": //italics\n      if (stream.eat(\"'\")) {\n        // Italic text\n        return chain(inBlock(\"em\", \"''\", inText));\n      }\n      break;\n    case \"(\":// Wiki Link\n      if (stream.eat(\"(\")) {\n        return chain(inBlock(\"variable-2\", \"))\", inText));\n      }\n      break;\n    case \"[\":// Weblink\n      return chain(inBlock(\"variable-3\", \"]\", inText));\n      break;\n    case \"|\": //table\n      if (stream.eat(\"|\")) {\n        return chain(inBlock(\"comment\", \"||\"));\n      }\n      break;\n    case \"-\":\n      if (stream.eat(\"=\")) {//titleBar\n        return chain(inBlock(\"header string\", \"=-\", inText));\n      } else if (stream.eat(\"-\")) {//deleted\n        return chain(inBlock(\"error tw-deleted\", \"--\", inText));\n      }\n      break;\n    case \"=\": //underline\n      if (stream.match(\"==\")) {\n        return chain(inBlock(\"tw-underline\", \"===\", inText));\n      }\n      break;\n    case \":\":\n      if (stream.eat(\":\")) {\n        return chain(inBlock(\"comment\", \"::\"));\n      }\n      break;\n    case \"^\": //box\n      return chain(inBlock(\"tw-box\", \"^\"));\n      break;\n    case \"~\": //np\n      if (stream.match(\"np~\")) {\n        return chain(inBlock(\"meta\", \"~/np~\"));\n      }\n      break;\n    }\n\n    //start of line types\n    if (sol) {\n      switch (ch) {\n      case \"!\": //header at start of line\n        if (stream.match('!!!!!')) {\n          return chain(inLine(\"header string\"));\n        } else if (stream.match('!!!!')) {\n          return chain(inLine(\"header string\"));\n        } else if (stream.match('!!!')) {\n          return chain(inLine(\"header string\"));\n        } else if (stream.match('!!')) {\n          return chain(inLine(\"header string\"));\n        } else {\n          return chain(inLine(\"header string\"));\n        }\n        break;\n      case \"*\": //unordered list line item, or <li /> at start of line\n      case \"#\": //ordered list line item, or <li /> at start of line\n      case \"+\": //ordered list line item, or <li /> at start of line\n        return chain(inLine(\"tw-listitem bracket\"));\n        break;\n      }\n    }\n\n    //stream.eatWhile(/[&{]/); was eating up plugins, turned off to act less like html and more like tiki\n    return null;\n  }\n\n  var indentUnit = config.indentUnit;\n\n  // Return variables for tokenizers\n  var pluginName, type;\n  function inPlugin(stream, state) {\n    var ch = stream.next();\n    var peek = stream.peek();\n\n    if (ch == \"}\") {\n      state.tokenize = inText;\n      //type = ch == \")\" ? \"endPlugin\" : \"selfclosePlugin\"; inPlugin\n      return \"tag\";\n    } else if (ch == \"(\" || ch == \")\") {\n      return \"bracket\";\n    } else if (ch == \"=\") {\n      type = \"equals\";\n\n      if (peek == \">\") {\n        ch = stream.next();\n        peek = stream.peek();\n      }\n\n      //here we detect values directly after equal character with no quotes\n      if (!/[\\'\\\"]/.test(peek)) {\n        state.tokenize = inAttributeNoQuote();\n      }\n      //end detect values\n\n      return \"operator\";\n    } else if (/[\\'\\\"]/.test(ch)) {\n      state.tokenize = inAttribute(ch);\n      return state.tokenize(stream, state);\n    } else {\n      stream.eatWhile(/[^\\s\\u00a0=\\\"\\'\\/?]/);\n      return \"keyword\";\n    }\n  }\n\n  function inAttribute(quote) {\n    return function(stream, state) {\n      while (!stream.eol()) {\n        if (stream.next() == quote) {\n          state.tokenize = inPlugin;\n          break;\n        }\n      }\n      return \"string\";\n    };\n  }\n\n  function inAttributeNoQuote() {\n    return function(stream, state) {\n      while (!stream.eol()) {\n        var ch = stream.next();\n        var peek = stream.peek();\n        if (ch == \" \" || ch == \",\" || /[ )}]/.test(peek)) {\n      state.tokenize = inPlugin;\n      break;\n    }\n  }\n  return \"string\";\n};\n                     }\n\nvar curState, setStyle;\nfunction pass() {\n  for (var i = arguments.length - 1; i >= 0; i--) curState.cc.push(arguments[i]);\n}\n\nfunction cont() {\n  pass.apply(null, arguments);\n  return true;\n}\n\nfunction pushContext(pluginName, startOfLine) {\n  var noIndent = curState.context && curState.context.noIndent;\n  curState.context = {\n    prev: curState.context,\n    pluginName: pluginName,\n    indent: curState.indented,\n    startOfLine: startOfLine,\n    noIndent: noIndent\n  };\n}\n\nfunction popContext() {\n  if (curState.context) curState.context = curState.context.prev;\n}\n\nfunction element(type) {\n  if (type == \"openPlugin\") {curState.pluginName = pluginName; return cont(attributes, endplugin(curState.startOfLine));}\n  else if (type == \"closePlugin\") {\n    var err = false;\n    if (curState.context) {\n      err = curState.context.pluginName != pluginName;\n      popContext();\n    } else {\n      err = true;\n    }\n    if (err) setStyle = \"error\";\n    return cont(endcloseplugin(err));\n  }\n  else if (type == \"string\") {\n    if (!curState.context || curState.context.name != \"!cdata\") pushContext(\"!cdata\");\n    if (curState.tokenize == inText) popContext();\n    return cont();\n  }\n  else return cont();\n}\n\nfunction endplugin(startOfLine) {\n  return function(type) {\n    if (\n      type == \"selfclosePlugin\" ||\n        type == \"endPlugin\"\n    )\n      return cont();\n    if (type == \"endPlugin\") {pushContext(curState.pluginName, startOfLine); return cont();}\n    return cont();\n  };\n}\n\nfunction endcloseplugin(err) {\n  return function(type) {\n    if (err) setStyle = \"error\";\n    if (type == \"endPlugin\") return cont();\n    return pass();\n  };\n}\n\nfunction attributes(type) {\n  if (type == \"keyword\") {setStyle = \"attribute\"; return cont(attributes);}\n  if (type == \"equals\") return cont(attvalue, attributes);\n  return pass();\n}\nfunction attvalue(type) {\n  if (type == \"keyword\") {setStyle = \"string\"; return cont();}\n  if (type == \"string\") return cont(attvaluemaybe);\n  return pass();\n}\nfunction attvaluemaybe(type) {\n  if (type == \"string\") return cont(attvaluemaybe);\n  else return pass();\n}\nreturn {\n  startState: function() {\n    return {tokenize: inText, cc: [], indented: 0, startOfLine: true, pluginName: null, context: null};\n  },\n  token: function(stream, state) {\n    if (stream.sol()) {\n      state.startOfLine = true;\n      state.indented = stream.indentation();\n    }\n    if (stream.eatSpace()) return null;\n\n    setStyle = type = pluginName = null;\n    var style = state.tokenize(stream, state);\n    if ((style || type) && style != \"comment\") {\n      curState = state;\n      while (true) {\n        var comb = state.cc.pop() || element;\n        if (comb(type || style)) break;\n      }\n    }\n    state.startOfLine = false;\n    return setStyle || style;\n  },\n  indent: function(state, textAfter) {\n    var context = state.context;\n    if (context && context.noIndent) return 0;\n    if (context && /^{\\//.test(textAfter))\n        context = context.prev;\n        while (context && !context.startOfLine)\n          context = context.prev;\n        if (context) return context.indent + indentUnit;\n        else return 0;\n       },\n    electricChars: \"/\"\n  };\n});\n\nCodeMirror.defineMIME(\"text/tiki\", \"tiki\");\n\n});\n"]}