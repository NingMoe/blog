{"version":3,"sources":["../../../../../../../../../app/public/js/marked/lib/codemirror/mode/smartymixed/smartymixed.js"],"names":["mod","exports","module","require","define","amd","CodeMirror","defineMode","config","htmlMixedMode","getMode","smartyMode","settings","rightDelimiter","leftDelimiter","hasOwnProperty","reEsc","str","replace","reLeft","reRight","regs","smartyComment","RegExp","literalOpen","literalClose","hasLeftDelimeter","htmlHasLeftDelimeter","helpers","chain","stream","state","parser","tokenize","cleanChain","localState","localMode","maybeBackup","pat","style","cur","current","close","search","m","backUp","length","match","parsers","html","htmlTagName","htmlMixedState","htmlState","context","tagName","inLiteral","smarty","startState","indent","token","inBlock","eat","terminator","eol","next","copyState","local","tok","textAfter","test","Pass","innerMode","mode","defineMIME"],"mappings":"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","file":"smartymixed.js","sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n/**\n* @file smartymixed.js\n* @brief Smarty Mixed Codemirror mode (Smarty + Mixed HTML)\n* @author Ruslan Osmanov <rrosmanov at gmail dot com>\n* @version 3.0\n* @date 05.07.2013\n*/\n\n// Warning: Don't base other modes on this one. This here is a\n// terrible way to write a mixed mode.\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"), require(\"../htmlmixed/htmlmixed\"), require(\"../smarty/smarty\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\", \"../htmlmixed/htmlmixed\", \"../smarty/smarty\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"smartymixed\", function(config) {\n  var htmlMixedMode = CodeMirror.getMode(config, \"htmlmixed\");\n  var smartyMode = CodeMirror.getMode(config, \"smarty\");\n\n  var settings = {\n    rightDelimiter: '}',\n    leftDelimiter: '{'\n  };\n\n  if (config.hasOwnProperty(\"leftDelimiter\")) {\n    settings.leftDelimiter = config.leftDelimiter;\n  }\n  if (config.hasOwnProperty(\"rightDelimiter\")) {\n    settings.rightDelimiter = config.rightDelimiter;\n  }\n\n  function reEsc(str) { return str.replace(/[^\\s\\w]/g, \"\\\\$&\"); }\n\n  var reLeft = reEsc(settings.leftDelimiter), reRight = reEsc(settings.rightDelimiter);\n  var regs = {\n    smartyComment: new RegExp(\"^\" + reRight + \"\\\\*\"),\n    literalOpen: new RegExp(reLeft + \"literal\" + reRight),\n    literalClose: new RegExp(reLeft + \"\\/literal\" + reRight),\n    hasLeftDelimeter: new RegExp(\".*\" + reLeft),\n    htmlHasLeftDelimeter: new RegExp(\"[^<>]*\" + reLeft)\n  };\n\n  var helpers = {\n    chain: function(stream, state, parser) {\n      state.tokenize = parser;\n      return parser(stream, state);\n    },\n\n    cleanChain: function(stream, state, parser) {\n      state.tokenize = null;\n      state.localState = null;\n      state.localMode = null;\n      return (typeof parser == \"string\") ? (parser ? parser : null) : parser(stream, state);\n    },\n\n    maybeBackup: function(stream, pat, style) {\n      var cur = stream.current();\n      var close = cur.search(pat),\n      m;\n      if (close > - 1) stream.backUp(cur.length - close);\n      else if (m = cur.match(/<\\/?$/)) {\n        stream.backUp(cur.length);\n        if (!stream.match(pat, false)) stream.match(cur[0]);\n      }\n      return style;\n    }\n  };\n\n  var parsers = {\n    html: function(stream, state) {\n      var htmlTagName = state.htmlMixedState.htmlState.context && state.htmlMixedState.htmlState.context.tagName\n        ? state.htmlMixedState.htmlState.context.tagName\n        : null;\n\n      if (!state.inLiteral && stream.match(regs.htmlHasLeftDelimeter, false) && htmlTagName === null) {\n        state.tokenize = parsers.smarty;\n        state.localMode = smartyMode;\n        state.localState = smartyMode.startState(htmlMixedMode.indent(state.htmlMixedState, \"\"));\n        return helpers.maybeBackup(stream, settings.leftDelimiter, smartyMode.token(stream, state.localState));\n      } else if (!state.inLiteral && stream.match(settings.leftDelimiter, false)) {\n        state.tokenize = parsers.smarty;\n        state.localMode = smartyMode;\n        state.localState = smartyMode.startState(htmlMixedMode.indent(state.htmlMixedState, \"\"));\n        return helpers.maybeBackup(stream, settings.leftDelimiter, smartyMode.token(stream, state.localState));\n      }\n      return htmlMixedMode.token(stream, state.htmlMixedState);\n    },\n\n    smarty: function(stream, state) {\n      if (stream.match(settings.leftDelimiter, false)) {\n        if (stream.match(regs.smartyComment, false)) {\n          return helpers.chain(stream, state, parsers.inBlock(\"comment\", \"*\" + settings.rightDelimiter));\n        }\n      } else if (stream.match(settings.rightDelimiter, false)) {\n        stream.eat(settings.rightDelimiter);\n        state.tokenize = parsers.html;\n        state.localMode = htmlMixedMode;\n        state.localState = state.htmlMixedState;\n        return \"tag\";\n      }\n\n      return helpers.maybeBackup(stream, settings.rightDelimiter, smartyMode.token(stream, state.localState));\n    },\n\n    inBlock: function(style, terminator) {\n      return function(stream, state) {\n        while (!stream.eol()) {\n          if (stream.match(terminator)) {\n            helpers.cleanChain(stream, state, \"\");\n            break;\n          }\n          stream.next();\n        }\n        return style;\n      };\n    }\n  };\n\n  return {\n    startState: function() {\n      var state = htmlMixedMode.startState();\n      return {\n        token: parsers.html,\n        localMode: null,\n        localState: null,\n        htmlMixedState: state,\n        tokenize: null,\n        inLiteral: false\n      };\n    },\n\n    copyState: function(state) {\n      var local = null, tok = (state.tokenize || state.token);\n      if (state.localState) {\n        local = CodeMirror.copyState((tok != parsers.html ? smartyMode : htmlMixedMode), state.localState);\n      }\n      return {\n        token: state.token,\n        tokenize: state.tokenize,\n        localMode: state.localMode,\n        localState: local,\n        htmlMixedState: CodeMirror.copyState(htmlMixedMode, state.htmlMixedState),\n        inLiteral: state.inLiteral\n      };\n    },\n\n    token: function(stream, state) {\n      if (stream.match(settings.leftDelimiter, false)) {\n        if (!state.inLiteral && stream.match(regs.literalOpen, true)) {\n          state.inLiteral = true;\n          return \"keyword\";\n        } else if (state.inLiteral && stream.match(regs.literalClose, true)) {\n          state.inLiteral = false;\n          return \"keyword\";\n        }\n      }\n      if (state.inLiteral && state.localState != state.htmlMixedState) {\n        state.tokenize = parsers.html;\n        state.localMode = htmlMixedMode;\n        state.localState = state.htmlMixedState;\n      }\n\n      var style = (state.tokenize || state.token)(stream, state);\n      return style;\n    },\n\n    indent: function(state, textAfter) {\n      if (state.localMode == smartyMode\n          || (state.inLiteral && !state.localMode)\n         || regs.hasLeftDelimeter.test(textAfter)) {\n        return CodeMirror.Pass;\n      }\n      return htmlMixedMode.indent(state.htmlMixedState, textAfter);\n    },\n\n    innerMode: function(state) {\n      return {\n        state: state.localState || state.htmlMixedState,\n        mode: state.localMode || htmlMixedMode\n      };\n    }\n  };\n}, \"htmlmixed\", \"smarty\");\n\nCodeMirror.defineMIME(\"text/x-smarty\", \"smartymixed\");\n// vim: et ts=2 sts=2 sw=2\n\n});\n"]}