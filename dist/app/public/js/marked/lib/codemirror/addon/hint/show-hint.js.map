{"version":3,"sources":["../../../../../../../../../app/public/js/marked/lib/codemirror/addon/hint/show-hint.js"],"names":["mod","exports","module","require","define","amd","CodeMirror","HINT_ELEMENT_CLASS","ACTIVE_HINT_ELEMENT_CLASS","showHint","cm","getHints","options","async","newOpts","hint","prop","asyncRunID","retrieveHints","getter","then","id","hints","defineExtension","listSelections","length","somethingSelected","state","completionActive","close","completion","Completion","signal","showHints","buildOptions","widget","onClose","prototype","active","pick","data","i","list","replaceRange","getText","from","to","completeSingle","showWidget","Widget","debounce","finished","closeOn","closeCharacters","startPos","getCursor","startLen","getLine","line","requestAnimationFrame","window","fn","setTimeout","cancelAnimationFrame","clearTimeout","done","off","activity","update","finishUpdate","data_","clearDebounce","pos","ch","test","charAt","on","editor","hintOptions","out","defaultOptions","undefined","text","buildKeyMap","handle","baseMap","Up","moveFocus","Down","PageUp","menuSize","PageDown","Home","setFocus","End","Enter","Tab","Esc","custom","customKeys","ourMap","addBinding","key","val","bound","hasOwnProperty","extra","extraKeys","getHintElement","hintsElement","el","nodeName","toUpperCase","parentNode","document","createElement","className","selectedHint","completions","elt","appendChild","cur","render","createTextNode","displayText","hintId","cursorCoords","alignWithWord","left","top","bottom","below","style","winW","innerWidth","Math","max","body","offsetWidth","documentElement","winH","innerHeight","offsetHeight","container","box","getBoundingClientRect","overlapY","height","curTop","cursor","overlapX","right","width","addKeyMap","keyMap","n","avoidWrap","changeActive","screenAmount","closeOnUnfocus","closingOnBlur","onBlur","onFocus","startScroll","getScrollInfo","onScroll","curScroll","getWrapperElement","newTop","point","pageYOffset","scrollTop","e","t","target","srcElement","completeOnSingleClick","focus","firstChild","removeChild","removeKeyMap","node","childNodes","replace","offsetTop","clientHeight","floor","registerHelper","helpers","getHelpers","words","getHelper","fromList","anyword","token","getTokenAt","found","word","slice","string","push","Pos","start","end","commands","autocomplete","auto","defineOption"],"mappings":"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","file":"show-hint.js","sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: http://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  \"use strict\";\n\n  var HINT_ELEMENT_CLASS        = \"CodeMirror-hint\";\n  var ACTIVE_HINT_ELEMENT_CLASS = \"CodeMirror-hint-active\";\n\n  // This is the old interface, kept around for now to stay\n  // backwards-compatible.\n  CodeMirror.showHint = function(cm, getHints, options) {\n    if (!getHints) return cm.showHint(options);\n    if (options && options.async) getHints.async = true;\n    var newOpts = {hint: getHints};\n    if (options) for (var prop in options) newOpts[prop] = options[prop];\n    return cm.showHint(newOpts);\n  };\n\n  var asyncRunID = 0;\n  function retrieveHints(getter, cm, options, then) {\n    if (getter.async) {\n      var id = ++asyncRunID;\n      getter(cm, function(hints) {\n        if (asyncRunID == id) then(hints);\n      }, options);\n    } else {\n      then(getter(cm, options));\n    }\n  }\n\n  CodeMirror.defineExtension(\"showHint\", function(options) {\n    // We want a single cursor position.\n    if (this.listSelections().length > 1 || this.somethingSelected()) return;\n\n    if (this.state.completionActive) this.state.completionActive.close();\n    var completion = this.state.completionActive = new Completion(this, options);\n    var getHints = completion.options.hint;\n    if (!getHints) return;\n\n    CodeMirror.signal(this, \"startCompletion\", this);\n    return retrieveHints(getHints, this, completion.options, function(hints) { completion.showHints(hints); });\n  });\n\n  function Completion(cm, options) {\n    this.cm = cm;\n    this.options = this.buildOptions(options);\n    this.widget = this.onClose = null;\n  }\n\n  Completion.prototype = {\n    close: function() {\n      if (!this.active()) return;\n      this.cm.state.completionActive = null;\n\n      if (this.widget) this.widget.close();\n      if (this.onClose) this.onClose();\n      CodeMirror.signal(this.cm, \"endCompletion\", this.cm);\n    },\n\n    active: function() {\n      return this.cm.state.completionActive == this;\n    },\n\n    pick: function(data, i) {\n      var completion = data.list[i];\n      if (completion.hint) completion.hint(this.cm, data, completion);\n      else this.cm.replaceRange(getText(completion), completion.from || data.from,\n                                completion.to || data.to, \"complete\");\n      CodeMirror.signal(data, \"pick\", completion);\n      this.close();\n    },\n\n    showHints: function(data) {\n      if (!data || !data.list.length || !this.active()) return this.close();\n\n      if (this.options.completeSingle && data.list.length == 1)\n        this.pick(data, 0);\n      else\n        this.showWidget(data);\n    },\n\n    showWidget: function(data) {\n      this.widget = new Widget(this, data);\n      CodeMirror.signal(data, \"shown\");\n\n      var debounce = 0, completion = this, finished;\n      var closeOn = this.options.closeCharacters;\n      var startPos = this.cm.getCursor(), startLen = this.cm.getLine(startPos.line).length;\n\n      var requestAnimationFrame = window.requestAnimationFrame || function(fn) {\n        return setTimeout(fn, 1000/60);\n      };\n      var cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\n\n      function done() {\n        if (finished) return;\n        finished = true;\n        completion.close();\n        completion.cm.off(\"cursorActivity\", activity);\n        if (data) CodeMirror.signal(data, \"close\");\n      }\n\n      function update() {\n        if (finished) return;\n        CodeMirror.signal(data, \"update\");\n        retrieveHints(completion.options.hint, completion.cm, completion.options, finishUpdate);\n      }\n      function finishUpdate(data_) {\n        data = data_;\n        if (finished) return;\n        if (!data || !data.list.length) return done();\n        if (completion.widget) completion.widget.close();\n        completion.widget = new Widget(completion, data);\n      }\n\n      function clearDebounce() {\n        if (debounce) {\n          cancelAnimationFrame(debounce);\n          debounce = 0;\n        }\n      }\n\n      function activity() {\n        clearDebounce();\n        var pos = completion.cm.getCursor(), line = completion.cm.getLine(pos.line);\n        if (pos.line != startPos.line || line.length - pos.ch != startLen - startPos.ch ||\n            pos.ch < startPos.ch || completion.cm.somethingSelected() ||\n            (pos.ch && closeOn.test(line.charAt(pos.ch - 1)))) {\n          completion.close();\n        } else {\n          debounce = requestAnimationFrame(update);\n          if (completion.widget) completion.widget.close();\n        }\n      }\n      this.cm.on(\"cursorActivity\", activity);\n      this.onClose = done;\n    },\n\n    buildOptions: function(options) {\n      var editor = this.cm.options.hintOptions;\n      var out = {};\n      for (var prop in defaultOptions) out[prop] = defaultOptions[prop];\n      if (editor) for (var prop in editor)\n        if (editor[prop] !== undefined) out[prop] = editor[prop];\n      if (options) for (var prop in options)\n        if (options[prop] !== undefined) out[prop] = options[prop];\n      return out;\n    }\n  };\n\n  function getText(completion) {\n    if (typeof completion == \"string\") return completion;\n    else return completion.text;\n  }\n\n  function buildKeyMap(completion, handle) {\n    var baseMap = {\n      Up: function() {handle.moveFocus(-1);},\n      Down: function() {handle.moveFocus(1);},\n      PageUp: function() {handle.moveFocus(-handle.menuSize() + 1, true);},\n      PageDown: function() {handle.moveFocus(handle.menuSize() - 1, true);},\n      Home: function() {handle.setFocus(0);},\n      End: function() {handle.setFocus(handle.length - 1);},\n      Enter: handle.pick,\n      Tab: handle.pick,\n      Esc: handle.close\n    };\n    var custom = completion.options.customKeys;\n    var ourMap = custom ? {} : baseMap;\n    function addBinding(key, val) {\n      var bound;\n      if (typeof val != \"string\")\n        bound = function(cm) { return val(cm, handle); };\n      // This mechanism is deprecated\n      else if (baseMap.hasOwnProperty(val))\n        bound = baseMap[val];\n      else\n        bound = val;\n      ourMap[key] = bound;\n    }\n    if (custom)\n      for (var key in custom) if (custom.hasOwnProperty(key))\n        addBinding(key, custom[key]);\n    var extra = completion.options.extraKeys;\n    if (extra)\n      for (var key in extra) if (extra.hasOwnProperty(key))\n        addBinding(key, extra[key]);\n    return ourMap;\n  }\n\n  function getHintElement(hintsElement, el) {\n    while (el && el != hintsElement) {\n      if (el.nodeName.toUpperCase() === \"LI\" && el.parentNode == hintsElement) return el;\n      el = el.parentNode;\n    }\n  }\n\n  function Widget(completion, data) {\n    this.completion = completion;\n    this.data = data;\n    var widget = this, cm = completion.cm;\n\n    var hints = this.hints = document.createElement(\"ul\");\n    hints.className = \"CodeMirror-hints\";\n    this.selectedHint = data.selectedHint || 0;\n\n    var completions = data.list;\n    for (var i = 0; i < completions.length; ++i) {\n      var elt = hints.appendChild(document.createElement(\"li\")), cur = completions[i];\n      var className = HINT_ELEMENT_CLASS + (i != this.selectedHint ? \"\" : \" \" + ACTIVE_HINT_ELEMENT_CLASS);\n      if (cur.className != null) className = cur.className + \" \" + className;\n      elt.className = className;\n      if (cur.render) cur.render(elt, data, cur);\n      else elt.appendChild(document.createTextNode(cur.displayText || getText(cur)));\n      elt.hintId = i;\n    }\n\n    var pos = cm.cursorCoords(completion.options.alignWithWord ? data.from : null);\n    var left = pos.left, top = pos.bottom, below = true;\n    hints.style.left = left + \"px\";\n    hints.style.top = top + \"px\";\n    // If we're at the edge of the screen, then we want the menu to appear on the left of the cursor.\n    var winW = window.innerWidth || Math.max(document.body.offsetWidth, document.documentElement.offsetWidth);\n    var winH = window.innerHeight || Math.max(document.body.offsetHeight, document.documentElement.offsetHeight);\n    (completion.options.container || document.body).appendChild(hints);\n    var box = hints.getBoundingClientRect(), overlapY = box.bottom - winH;\n    if (overlapY > 0) {\n      var height = box.bottom - box.top, curTop = pos.top - (pos.bottom - box.top);\n      if (curTop - height > 0) { // Fits above cursor\n        hints.style.top = (top = pos.top - height) + \"px\";\n        below = false;\n      } else if (height > winH) {\n        hints.style.height = (winH - 5) + \"px\";\n        hints.style.top = (top = pos.bottom - box.top) + \"px\";\n        var cursor = cm.getCursor();\n        if (data.from.ch != cursor.ch) {\n          pos = cm.cursorCoords(cursor);\n          hints.style.left = (left = pos.left) + \"px\";\n          box = hints.getBoundingClientRect();\n        }\n      }\n    }\n    var overlapX = box.right - winW;\n    if (overlapX > 0) {\n      if (box.right - box.left > winW) {\n        hints.style.width = (winW - 5) + \"px\";\n        overlapX -= (box.right - box.left) - winW;\n      }\n      hints.style.left = (left = pos.left - overlapX) + \"px\";\n    }\n\n    cm.addKeyMap(this.keyMap = buildKeyMap(completion, {\n      moveFocus: function(n, avoidWrap) { widget.changeActive(widget.selectedHint + n, avoidWrap); },\n      setFocus: function(n) { widget.changeActive(n); },\n      menuSize: function() { return widget.screenAmount(); },\n      length: completions.length,\n      close: function() { completion.close(); },\n      pick: function() { widget.pick(); },\n      data: data\n    }));\n\n    if (completion.options.closeOnUnfocus) {\n      var closingOnBlur;\n      cm.on(\"blur\", this.onBlur = function() { closingOnBlur = setTimeout(function() { completion.close(); }, 100); });\n      cm.on(\"focus\", this.onFocus = function() { clearTimeout(closingOnBlur); });\n    }\n\n    var startScroll = cm.getScrollInfo();\n    cm.on(\"scroll\", this.onScroll = function() {\n      var curScroll = cm.getScrollInfo(), editor = cm.getWrapperElement().getBoundingClientRect();\n      var newTop = top + startScroll.top - curScroll.top;\n      var point = newTop - (window.pageYOffset || (document.documentElement || document.body).scrollTop);\n      if (!below) point += hints.offsetHeight;\n      if (point <= editor.top || point >= editor.bottom) return completion.close();\n      hints.style.top = newTop + \"px\";\n      hints.style.left = (left + startScroll.left - curScroll.left) + \"px\";\n    });\n\n    CodeMirror.on(hints, \"dblclick\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {widget.changeActive(t.hintId); widget.pick();}\n    });\n\n    CodeMirror.on(hints, \"click\", function(e) {\n      var t = getHintElement(hints, e.target || e.srcElement);\n      if (t && t.hintId != null) {\n        widget.changeActive(t.hintId);\n        if (completion.options.completeOnSingleClick) widget.pick();\n      }\n    });\n\n    CodeMirror.on(hints, \"mousedown\", function() {\n      setTimeout(function(){cm.focus();}, 20);\n    });\n\n    CodeMirror.signal(data, \"select\", completions[0], hints.firstChild);\n    return true;\n  }\n\n  Widget.prototype = {\n    close: function() {\n      if (this.completion.widget != this) return;\n      this.completion.widget = null;\n      this.hints.parentNode.removeChild(this.hints);\n      this.completion.cm.removeKeyMap(this.keyMap);\n\n      var cm = this.completion.cm;\n      if (this.completion.options.closeOnUnfocus) {\n        cm.off(\"blur\", this.onBlur);\n        cm.off(\"focus\", this.onFocus);\n      }\n      cm.off(\"scroll\", this.onScroll);\n    },\n\n    pick: function() {\n      this.completion.pick(this.data, this.selectedHint);\n    },\n\n    changeActive: function(i, avoidWrap) {\n      if (i >= this.data.list.length)\n        i = avoidWrap ? this.data.list.length - 1 : 0;\n      else if (i < 0)\n        i = avoidWrap ? 0  : this.data.list.length - 1;\n      if (this.selectedHint == i) return;\n      var node = this.hints.childNodes[this.selectedHint];\n      node.className = node.className.replace(\" \" + ACTIVE_HINT_ELEMENT_CLASS, \"\");\n      node = this.hints.childNodes[this.selectedHint = i];\n      node.className += \" \" + ACTIVE_HINT_ELEMENT_CLASS;\n      if (node.offsetTop < this.hints.scrollTop)\n        this.hints.scrollTop = node.offsetTop - 3;\n      else if (node.offsetTop + node.offsetHeight > this.hints.scrollTop + this.hints.clientHeight)\n        this.hints.scrollTop = node.offsetTop + node.offsetHeight - this.hints.clientHeight + 3;\n      CodeMirror.signal(this.data, \"select\", this.data.list[this.selectedHint], node);\n    },\n\n    screenAmount: function() {\n      return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1;\n    }\n  };\n\n  CodeMirror.registerHelper(\"hint\", \"auto\", function(cm, options) {\n    var helpers = cm.getHelpers(cm.getCursor(), \"hint\"), words;\n    if (helpers.length) {\n      for (var i = 0; i < helpers.length; i++) {\n        var cur = helpers[i](cm, options);\n        if (cur && cur.list.length) return cur;\n      }\n    } else if (words = cm.getHelper(cm.getCursor(), \"hintWords\")) {\n      if (words) return CodeMirror.hint.fromList(cm, {words: words});\n    } else if (CodeMirror.hint.anyword) {\n      return CodeMirror.hint.anyword(cm, options);\n    }\n  });\n\n  CodeMirror.registerHelper(\"hint\", \"fromList\", function(cm, options) {\n    var cur = cm.getCursor(), token = cm.getTokenAt(cur);\n    var found = [];\n    for (var i = 0; i < options.words.length; i++) {\n      var word = options.words[i];\n      if (word.slice(0, token.string.length) == token.string)\n        found.push(word);\n    }\n\n    if (found.length) return {\n      list: found,\n      from: CodeMirror.Pos(cur.line, token.start),\n            to: CodeMirror.Pos(cur.line, token.end)\n    };\n  });\n\n  CodeMirror.commands.autocomplete = CodeMirror.showHint;\n\n  var defaultOptions = {\n    hint: CodeMirror.hint.auto,\n    completeSingle: true,\n    alignWithWord: true,\n    closeCharacters: /[\\s()\\[\\]{};:>,]/,\n    closeOnUnfocus: true,\n    completeOnSingleClick: false,\n    container: null,\n    customKeys: null,\n    extraKeys: null\n  };\n\n  CodeMirror.defineOption(\"hintOptions\", null);\n});\n"]}