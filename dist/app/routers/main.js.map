{"version":3,"sources":["../../../app/routers/main.js"],"names":["express","require","ctr_token","router","Router","get","req","res","next","render","platform","cookies","uid","session","page_type","title","redirect_uri","protocol","originalUrl","redirect","quid","query","coll_id","id","module","exports"],"mappings":"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","file":"main.js","sourcesContent":["const express = require('express');\nconst ctr_token = require('../libs/ctr_token');\nconst router = express.Router();\nrouter.get('/', (req, res, next) => {\n    res.render('../views/index', {\n        platform: req.platform ? req.platform : (req.cookies.get('platform') ? req.cookies.get('platform') : ''),\n        uid: req.session.uid && req.cookies.uid,\n        page_type: 'index',\n        title: '鸿笺书信'\n    });\n});\n\nrouter.get('/editor', (req, res, next) => {\n    let redirect_uri = req.protocol + '://' + req.get('host') + req.originalUrl;\n    if (req.session.uid && req.cookies.uid) {\n        res.render('../views/article_editor', {\n            platform: req.platform ? req.platform : (req.cookies.get('platform') ? req.cookies.get('platform') : ''),\n            uid: req.session.uid && req.cookies.uid,\n            page_type: 'editor',\n        });\n    } else {\n        res.redirect(302, '/login?redirect_uri=' + redirect_uri);\n    }\n});\n\nrouter.get('/upfile', (req, res, next) => {\n    let redirect_uri = req.protocol + '://' + req.get('host') + req.originalUrl;\n    if (req.session.uid && req.cookies.uid) {\n        res.render('../views/upfile', {\n            platform: req.platform ? req.platform : (req.cookies.get('platform') ? req.cookies.get('platform') : ''),\n            uid: req.session.uid && req.cookies.uid,\n            page_type: 'upfile',\n        });\n    } else {\n        res.redirect(302, '/login?redirect_uri=' + redirect_uri);\n    }\n})\n\nrouter.get('/account', (req, res, next) => {\n    res.render('../views/account/account', {\n        platform: req.platform ? req.platform : (req.cookies.get('platform') ? req.cookies.get('platform') : ''),\n        uid: req.session.uid && req.cookies.uid,\n        quid: req.query.uid ? req.query.uid : (req.session.uid || req.cookies.uid),\n        page_type: 'account',\n        title: '我的主页'\n    });\n})\n\nrouter.get('/account/collections/lists', (req, res, next) => {\n    res.render('../views/account/collections/lists', {\n        platform: req.platform ? req.platform : (req.cookies.get('platform') ? req.cookies.get('platform') : ''),\n        page_type: 'collections_list',\n        uid: req.session.uid && req.cookies.uid,\n        title: '专题列表'\n    });\n});\n\nrouter.get('/account/collections/new', (req, res, next) => {\n    let redirect_uri = req.protocol + '://' + req.get('host') + req.originalUrl;\n    if (req.session.uid && req.cookies.uid) {\n        res.render('../views/account/collections/new', {\n            page_type: 'collections_new',\n            platform: req.platform ? req.platform : (req.cookies.get('platform') ? req.cookies.get('platform') : ''),\n            uid: req.session.uid && req.cookies.uid,\n            title: '新增专题'\n        });\n    } else {\n        res.redirect(302, '/login?redirect_uri=' + redirect_uri);\n    }\n});\n\nrouter.get('/account/collections/edit', (req, res, next) => {\n    let redirect_uri = req.protocol + '://' + req.get('host') + req.originalUrl;\n    let coll_id = req.query.id ? req.query.id : '';\n    if (req.session.uid && req.cookies.uid) {\n        res.render('../views/account/collections/new', {\n            page_type: 'collections_edit',\n            platform: req.platform ? req.platform : (req.cookies.get('platform') ? req.cookies.get('platform') : ''),\n            uid: req.session.uid && req.cookies.uid,\n            title: '修改专题',\n            coll_id: coll_id\n        });\n    } else {\n        res.redirect(302, '/login?redirect_uri=' + redirect_uri);\n    }\n});\n\nrouter.get('/account/collections/detailes', (req, res, next) => {\n    res.render('../views/account/collections/detailes', {\n        platform: req.platform ? req.platform : (req.cookies.get('platform') ? req.cookies.get('platform') : ''),\n        page_type: 'collections_detailes',\n        uid: req.session.uid && req.cookies.uid,\n        coll_id: req.query.id,\n        title: '专题详情'\n    });\n});\n\nrouter.get('/account/dcs', (req, res, next) => {\n    res.render('../views/account/document/detailes', {\n        page_type: 'document_detailes',\n        platform: req.platform ? req.platform : (req.cookies.get('platform') ? req.cookies.get('platform') : ''),\n        uid: req.session.uid && req.cookies.uid,\n        coll_id: req.query.id,\n        title: '文集详情'\n    });\n});\n\nrouter.get('/register', (req, res, next) => {\n    res.render('../views/register', {\n        page_type: 'register',\n        title: '注册帐号'\n    });\n});\n\nrouter.get('/login', (req, res, next) => {\n    res.render('../views/login', {\n        page_type: 'login',\n        title: '用户登录'\n    });\n});\n\nrouter.get('/mail', (req, res, next) => {\n    res.render('../views/mail/mail', {\n        page_type: 'mail',\n        title: '邮件'\n    });\n});\n\nrouter.get('/mail/new', (req, res, next) => {\n    res.render('../views/mail/index', {\n        page_type: 'mail',\n        title: '邮件'\n    });\n});\n\nrouter.get('/mail/draft', (req, res, next) => {\n    res.render('../views/mail/draft', {\n        page_type: 'mail',\n        title: '邮件'\n    });\n});\n\nrouter.get('/mail/setting', (req, res, next) => {\n    res.render('../views/mail/setting', {\n        page_type: 'mail',\n        title: '邮件'\n    });\n});\n\nmodule.exports = router;"]}